{"version":3,"sources":["webpack:///./node_modules/ajv/lib/dotjs/format.js","webpack:///./node_modules/ajv/lib/dotjs/not.js","webpack:///./node_modules/ajv/lib/dotjs/const.js","webpack:///./node_modules/@openeo/js-processgraphs/src/keywords.js","webpack:///./node_modules/intersects/line-polygon.js","webpack:///./node_modules/@openeo/js-processgraphs/src/utils.js","webpack:///./node_modules/intersects/box-box.js","webpack:///./node_modules/intersects/lineToLine.js","webpack:///./node_modules/@openeo/vue-components/components/ModelBuilder.vue?2f3c","webpack:///./node_modules/@openeo/vue-components/components/model-builder/Block.vue?25d0","webpack:///./node_modules/@openeo/vue-components/components/model-builder/BlockParameter.vue?f393","webpack:///node_modules/@openeo/vue-components/components/model-builder/BlockParameter.vue","webpack:///./node_modules/@openeo/vue-components/components/model-builder/BlockParameter.vue?2b31","webpack:///./node_modules/@openeo/vue-components/components/model-builder/BlockParameter.vue","webpack:///./node_modules/@openeo/vue-components/components/model-builder/config.js","webpack:///node_modules/@openeo/vue-components/components/model-builder/Block.vue","webpack:///./node_modules/@openeo/vue-components/components/model-builder/Block.vue?642a","webpack:///./node_modules/@openeo/vue-components/components/model-builder/Block.vue","webpack:///./node_modules/@openeo/vue-components/components/model-builder/Edge.vue?fb63","webpack:///./node_modules/@openeo/vue-components/components/model-builder/segment.js","webpack:///node_modules/@openeo/vue-components/components/model-builder/Edge.vue","webpack:///./node_modules/@openeo/vue-components/components/model-builder/Edge.vue?966e","webpack:///./node_modules/@openeo/vue-components/components/model-builder/Edge.vue","webpack:///node_modules/@openeo/vue-components/components/ModelBuilder.vue","webpack:///./node_modules/@openeo/vue-components/components/ModelBuilder.vue?1a13","webpack:///./node_modules/@openeo/vue-components/components/ModelBuilder.vue","webpack:///./node_modules/@openeo/js-processgraphs/src/processgraph.js","webpack:///./node_modules/@openeo/js-processgraphs/src/error.js","webpack:///./node_modules/ajv/lib/dotjs/oneOf.js","webpack:///./node_modules/uri-js/dist/es5/uri.all.js","webpack:///./node_modules/@openeo/vue-components/components/model-builder/Block.vue?995e","webpack:///./node_modules/@openeo/vue-components/components/ModelBuilder.vue?7b1c","webpack:///./node_modules/intersects/lineToPolygon.js","webpack:///./node_modules/ajv/lib/dotjs/comment.js","webpack:///./node_modules/ajv/lib/dotjs/contains.js","webpack:///./node_modules/ajv/lib/dotjs/anyOf.js","webpack:///./node_modules/ajv/lib/dotjs/index.js","webpack:///./node_modules/intersects/line-box.js","webpack:///./node_modules/ajv/lib/data.js","webpack:///./node_modules/@openeo/js-processgraphs/src/errorlist.js","webpack:///./node_modules/fast-deep-equal/index.js","webpack:///./node_modules/ajv/lib/dotjs/propertyNames.js","webpack:///./node_modules/ajv/lib/dotjs/ref.js","webpack:///./node_modules/ajv/lib/dotjs/pattern.js","webpack:///./node_modules/ajv/lib/dotjs/custom.js","webpack:///./node_modules/ajv/lib/compile/ucs2length.js","webpack:///./node_modules/ajv/lib/dotjs/_limitProperties.js","webpack:///./node_modules/ajv/lib/ajv.js","webpack:///./node_modules/ajv/lib/definition_schema.js","webpack:///./node_modules/ajv/lib/dotjs/items.js","webpack:///./node_modules/intersects/polygon-polygon.js","webpack:///./node_modules/ajv/lib/compile/error_classes.js","webpack:///./node_modules/json-schema-traverse/index.js","webpack:///./node_modules/ajv/lib/compile/index.js","webpack:///./node_modules/intersects/line-point.js","webpack:///./node_modules/ajv/lib/dotjs/_limitLength.js","webpack:///./node_modules/intersects/polygon-point.js","webpack:///./node_modules/@openeo/js-processgraphs/src/node.js","webpack:///./node_modules/ajv/lib/compile/formats.js","webpack:///./node_modules/intersects/box-line.js","webpack:///./node_modules/@openeo/js-processgraphs/src/main.js","webpack:///./node_modules/ajv/lib/dotjs/multipleOf.js","webpack:///./node_modules/ajv/lib/compile/resolve.js","webpack:///./node_modules/ajv/lib/compile/async.js","webpack:///./node_modules/@openeo/js-processgraphs/src/process.js","webpack:///./node_modules/ajv/lib/dotjs/required.js","webpack:///./node_modules/ajv/lib/dotjs/dependencies.js","webpack:///./node_modules/ajv/lib/compile/schema_obj.js","webpack:///./node_modules/ajv/lib/dotjs/properties.js","webpack:///./node_modules/ajv/lib/dotjs/_limit.js","webpack:///./node_modules/ajv/lib/compile/rules.js","webpack:///./node_modules/ajv/lib/dotjs/uniqueItems.js","webpack:///./node_modules/ajv/lib/dotjs/validate.js","webpack:///./node_modules/intersects/line-line.js","webpack:///./node_modules/ajv/lib/dotjs/_limitItems.js","webpack:///./node_modules/ajv/lib/dotjs/if.js","webpack:///./node_modules/@openeo/js-processgraphs/src/registry.js","webpack:///./node_modules/@openeo/vue-components/components/model-builder/BlockParameter.vue?a580","webpack:///./node_modules/ajv/lib/dotjs/enum.js","webpack:///./node_modules/ajv/lib/dotjs/allOf.js","webpack:///./node_modules/ajv/lib/cache.js","webpack:///./node_modules/intersects/box-point.js","webpack:///./node_modules/fast-json-stable-stringify/index.js","webpack:///./node_modules/@openeo/js-processgraphs/src/jsonschema.js","webpack:///./node_modules/ajv/lib/compile/util.js","webpack:///./node_modules/ajv/lib/keyword.js"],"names":["module","exports","it","$keyword","$ruleType","out","$lvl","level","$dataLvl","dataLevel","$schema","schema","$schemaPath","schemaPath","util","getProperty","$errSchemaPath","errSchemaPath","$breakOnError","opts","allErrors","$data","format","$schemaValue","$isData","getData","dataPathArr","$unknownFormats","unknownFormats","$allowUnknown","Array","isArray","$format","$isObject","$formatType","async","formats","logger","warn","indexOf","Error","RegExp","validate","type","$async","$formatRef","$$outStack","push","createErrors","toQuotedString","messages","escapeQuotes","verbose","__err","pop","compositeRule","$errs","$it","copy","$nextValid","strictKeywords","Object","keys","length","schemaHasRules","RULES","all","$allErrorsOption","$wasComposite","$valid","subtype","metaSchema","parameters","dependencies","items","required","properties","name","pattern","description","optional","default","deprecated","experimental","oneOf","returns","polygonPoint","lineLine","x1","y1","x2","y2","points","tolerance","i","j","CommonUtils","Utils","value","checkProcess","checkCallbacks","getType","containsRef","process_graph","key","getFromProcess","getFromCallbacks","store","concat","getRefs","unique","ProcessGraph","hasOwnProperty","w1","h1","w2","h2","x3","y3","x4","y4","s1_x","s1_y","s2_x","s2_y","s","t","render","_vm","this","_h","$createElement","_c","_self","ref","class","classes","attrs","id","on","onMouseMove","onMouseDown","onMouseWheel","onKeyDown","$event","hasFocus","staticClass","_l","edge","parameter1","parameter2","selected","inactive","issues","state","node","mount","updateEdgePos","arguments","_b","linkingLine","_e","selectRect","block","spec","position","origin","process_id","namespace","result","args","len","updateBlock","apply","startDragBlock","scale","showZoomInfo","_v","parameterViewer","staticRenderFns","containerClasses","style","_k","keyCode","preventDefault","stopPropagation","button","emitDrag","plainTitle","directives","rawName","expression","_s","focus","allowsDescription","showDescriptionField","addDescription","remove","showInfo","isParameter","edit","param","refInFor","updateArgument","edgesChanged","outputLabel","updateResult","output","editable","domProps","updateDescription","_g","circleClasses","circleListeners","textListeners","displayLabel","displayValue","props","label","data","edges","computed","schemas","hasValue","click","listeners","event","unspecified","formattedValue","isArrayType","isObjectType","isEditable","allowsArgumentChange","allowsMultipleInputs","watch","immediate","handler","methods","updateEdgeStatus","getCirclePosition","console","openEditorForArguments","jsonSchema","setValue","resetValue","getEdgeRef","addRefToValue","removeRefFromValue","removeRefFromValueDeep","addEdge","eraseEdge","isEdgeUsed","hasRefInValue","getEdgeCount","formatProcess","formatValue","formatArray","parts","maxLength","formatArraySimple","formatObject","component","defaultScale","blockWidth","compactParams","compact","normalParams","normal","defaultFontSize","components","BlockParameter","drag","width","styles","marginLeft","marginTop","fontSize","invalid","processId","collectionId","allowsParameterChange","allowsDelete","allowsInfo","showId","hasParametersDefined","names","fields","mounted","document","beforeDestroy","hasParameter","updatePosition","pos","updateArguments","filter","select","getDimensions","dim","parameter","editParameter","showArguments","getDragPos","startDrag","mouse","stopDrag","dragging","hasOutputEdges","getBlockParameter","isParameterScoped","hiddenParameterRef","line","Segment","x","y","dx","dy","point1","point2","Math","sqrt","pow","point","intersection","distance","alpha","other","a","b","c","d","b0","b1","det","r1","r2","lineWidth","lineColor","position1","position2","segment","scaledLineWidth","lines","mainLine","created","updatePositions","getLineStyle","color","getLine","collide","equals","getDefaultState","root","compactMode","moving","selecting","center","linkFrom","linkTo","MARGIN","selectionChangeWatcher","newVal","oldVal","Block","Edge","ParameterViewer","collections","processes","parent","parentSchema","historySize","explicitZoom","isMounted","allMounted","newBlockOffset","history","historyPointer","process","blocks","hiddenParameterRefEdges","processGraph","nextBlockId","nextEdgeId","clipboard","activeTransactions","height","processRegistry","hasProcesses","processBlocks","selectedBlocks","selectedEdges","selectedSideEdge","hasSelection","processParametersFromSchemas","parentParams","callbackParams","propagate","undoOnError","beforeCreate","elem","checkAllMounted","updateBlockArguments","updateBlockDescription","updateBlockPos","updateBlockResult","updateBlockSelected","updateBlockSpec","updateHiddenParameterRefEdges","hiddenRefs","$el","parameterRemoved","refreshEdges","refreshEdgesFor","supports","link","unlink","multiSelect","map","e","toJSON","captured","domBoundingBox","rect","getMousePos","start","current","sideSelected","commit","saveHistory","perfectScale","setResultNode","hasOtherBlocks","foundNewResultNode","getPositionForPageXY","addProcess","addBlock","getNewBlockDefaultPosition","getBlockSize","moveCenter","unselectAll","selectEdge","removeEdge","getBlockById","allSuccessors","explored","exploreList","export","success","pg","options","getPgParameters","getPgParameterById","imported","maxX","nextNodes","incrementId","xMin","xMax","yMin","yMax","showParameterViewer","values","title","selectParameterName","BlocksProcess","constructor","BaseProcess","ErrorList","JsonSchemaValidator","ProcessGraphError","ProcessGraphNode","ProcessUtils","processKeys","jsonSchemaValidator","nodes","startNodes","resultNode","children","parentNode","parsed","validated","errors","callbackParameters","allowEmptyGraph","fillProcessParameters","allowUndefinedParameterRefs","createJsonSchemaValidatorInstance","setProcessGraphParser","nodeObj","getJsonSchemaValidator","copyProcessGraphInstanceProperties","parameterPath","createProcessGraphInstance","setArguments","setParentNode","parameterName","shift","setCallbackParameters","getCallbackParametersForProcess","getParentProcess","parse","getProcessGraph","count","error","add","allow","fill","makeError","errorId","getParentProcessId","node_id","isObject","size","hasProcessKey","find","includes","mapObjectValues","createNodeInstance","isResultNode","parseNodeArguments","isStartNode","sort","localeCompare","throwOnErrors","first","addError","validateNodes","getStartNodes","allowUndefinedParameters","reset","executeNodes","getResultNode","previousNode","promises","solveDependency","validateNode","merge","getNextNodes","Promise","getProcess","executeNode","setResult","execute","nodeId","argumentName","arg","path","prevNode","from_node","addPreviousNode","addNextNode","createChildProcessGraph","from_parameter","addProcessParameter","getCallbackParameters","p","undefined","getParameterDefault","getParameter","includeUndefined","slice","refs","getProcessParameters","callbackParam","getCallbackParameter","processParam","getProcessParameter","assign","forEach","child","get","createProcessInstance","getParentNode","MESSAGES","codeOrMsg","variables","super","code","message","replacePlaceholders","replace","$closingBraces","$currentBaseId","baseId","$prevValid","$passingSchemas","arr1","$sch","$i","l1","global","factory","_len","sets","_key","xl","join","subexp","str","typeOf","o","prototype","toString","call","split","toLowerCase","toUpperCase","toArray","obj","setInterval","target","source","buildExps","isIRI","ALPHA$$","DIGIT$$","HEXDIG$$","PCT_ENCODED$","GEN_DELIMS$$","SUB_DELIMS$$","RESERVED$$","UCSCHAR$$","IPRIVATE$$","UNRESERVED$$","SCHEME$","USERINFO$","DEC_OCTET_RELAXED$","IPV4ADDRESS$","H16$","LS32$","IPV6ADDRESS1$","IPV6ADDRESS2$","IPV6ADDRESS3$","IPV6ADDRESS4$","IPV6ADDRESS5$","IPV6ADDRESS6$","IPV6ADDRESS7$","IPV6ADDRESS8$","IPV6ADDRESS9$","IPV6ADDRESS$","ZONEID$","IPV6ADDRZ_RELAXED$","IPVFUTURE$","IP_LITERAL$","REG_NAME$","HOST$","PORT$","AUTHORITY$","PCHAR$","SEGMENT$","SEGMENT_NZ$","SEGMENT_NZ_NC$","PATH_ABEMPTY$","PATH_ABSOLUTE$","PATH_NOSCHEME$","PATH_ROOTLESS$","PATH_EMPTY$","QUERY$","FRAGMENT$","HIER_PART$","URI$","RELATIVE_PART$","RELATIVE$","NOT_SCHEME","NOT_USERINFO","NOT_HOST","NOT_PATH","NOT_PATH_NOSCHEME","NOT_QUERY","NOT_FRAGMENT","ESCAPE","UNRESERVED","OTHER_CHARS","PCT_ENCODED","IPV4ADDRESS","IPV6ADDRESS","URI_PROTOCOL","IRI_PROTOCOL","slicedToArray","sliceIterator","arr","_arr","_n","_d","_i","Symbol","iterator","next","done","err","TypeError","toConsumableArray","arr2","from","maxInt","base","tMin","tMax","skew","damp","initialBias","initialN","delimiter","regexPunycode","regexNonASCII","regexSeparators","baseMinusTMin","floor","stringFromCharCode","String","fromCharCode","error$1","RangeError","array","fn","mapDomain","string","labels","encoded","ucs2decode","counter","charCodeAt","extra","ucs2encode","fromCodePoint","basicToDigit","codePoint","digitToBasic","digit","flag","adapt","delta","numPoints","firstTime","k","decode","input","inputLength","n","bias","basic","lastIndexOf","index","oldi","w","baseMinusT","splice","encode","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","_currentValue2","return","basicLength","handledCPCount","m","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","currentValue","handledCPCountPlusOne","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","_currentValue","q","qMinusT","toUnicode","test","toASCII","punycode","SCHEMES","pctEncChar","chr","pctDecChars","newStr","il","parseInt","substr","c2","c3","_normalizeComponentEncoding","protocol","decodeUnreserved","decStr","match","scheme","userinfo","host","query","fragment","_stripLeadingZeros","_normalizeIPv4","matches","_matches","address","_normalizeIPv6","_matches2","zone","_address$toLowerCase$","reverse","_address$toLowerCase$2","last","firstFields","lastFields","isLastFieldIPv4Address","fieldCount","lastFieldsStart","allZeroFields","reduce","acc","field","lastLongest","longestZeroFields","newHost","newFirst","newLast","URI_PARSE","NO_MATCH_IS_UNDEFINED","uriString","iri","reference","port","isNaN","schemeHandler","unicodeSupport","domainHost","_recomposeAuthority","uriTokens","_","$1","$2","RDS1","RDS2","RDS3","RDS5","removeDotSegments","im","serialize","authority","charAt","absolutePath","resolveComponents","relative","skipNormalization","tolerant","resolve","baseURI","relativeURI","schemelessOptions","normalize","uri","equal","uriA","uriB","escapeComponent","unescapeComponent","secure","handler$1","isSecure","wsComponents","handler$2","resourceName","_wsComponents$resourc","_wsComponents$resourc2","handler$3","O","ATEXT$$","QTEXT$$","VCHAR$$","SOME_DELIMS$$","NOT_LOCAL_PART","NOT_HFNAME","NOT_HFVALUE","handler$4","mailtoComponents","to","unknownHeaders","headers","hfields","hfield","toAddrs","_x","_xl","subject","body","_x2","_xl2","addr","toAddr","atIdx","localPart","domain","URN_PARSE","handler$5","urnComponents","nid","nss","urnScheme","uriComponents","UUID","handler$6","uuidComponents","uuid","defineProperty","thickness","angle","atan2","PI","half","cos","sin","$comment","$idx","$dataNxt","$nextData","$nonEmptySchema","errorPath","getPathExpr","jsonPointers","$passData","$code","varOccurences","varReplace","$noEmptySchema","every","allOf","anyOf","const","contains","maximum","minimum","maxItems","minItems","minLength","maxProperties","minProperties","multipleOf","not","propertyNames","uniqueItems","boxPoint","xb","yb","wb","hb","KEYWORDS","keywordsJsonPointers","JSON","stringify","segments","keywords","$ref","errorList","getAll","msg","trim","flags","valueOf","$key","$invalidName","$dataProperties","$ownProperties","ownProperties","$refCode","isRoot","$refVal","resolveRef","$message","MissingRefError","missingRefs","inline","passContext","$parentData","$parentDataProperty","__callValidate","$regexp","usePattern","$errorKeyword","$compile","$inline","$macro","$ruleValidate","$validateCode","$rule","$definition","$rDef","definition","$validateSchema","validateSchema","useCustomRule","compile","macro","$ruleErrs","$ruleErr","$asyncKeyword","statements","def_callRuleValidate","modifying","valid","keyword","def_customError","$op","compileSchema","Cache","SchemaObject","stableStringify","rules","$dataMetaSchema","Ajv","addSchema","addMetaSchema","getSchema","removeSchema","addFormat","errorsText","_addSchema","_compile","compileAsync","customKeyword","addKeyword","getKeyword","removeKeyword","validateKeyword","errorClasses","ValidationError","Validation","MissingRef","META_SCHEMA_ID","META_IGNORE_OPTIONS","META_SUPPORT_DATA","_opts","setLogger","_schemas","_refs","_fragments","_formats","_cache","cache","_loadingSchemas","_compilations","_getId","chooseGetId","loopRequired","Infinity","errorDataPath","_errorDataPathProperty","_metaOpts","getMetaSchemaOptions","addInitialFormats","addInitialKeywords","addDefaultMetaSchema","meta","nullable","addInitialSchemas","schemaKeyRef","v","schemaObj","_meta","_skipValidation","normalizeId","checkUnique","skipValidation","throwOrLogError","defaultMeta","self","keyRef","_getSchemaObj","_getSchemaFragment","res","_removeAllSchemas","clear","del","cacheKey","regex","shouldAddSchema","cached","addUsedSchema","recursiveMeta","willValidate","localRefs","ids","put","compiling","callValidate","currentOpts","refVal","_validate","schemaId","_get$IdOrId","_get$Id","$id","separator","dataVar","text","dataPath","$dataSchema","optsSchemas","metaOpts","log","noop","definitions","simpleTypes","$additionalItems","additionalItems","$currErrSchemaPath","points1","points2","minA","maxA","projected","minB","maxB","polygons","polygon","i1","i2","ajv","validation","missingRef","url","missingSchema","fullPath","errorSubclass","Subclass","create","traverse","cb","pre","post","_traverse","jsonPtr","rootSchema","parentJsonPtr","parentKeyword","keyIndex","sch","arrayKeywords","propsKeywords","prop","escapeJsonPtr","allKeys","skipKeywords","additionalProperties","patternProperties","enum","exclusiveMaximum","exclusiveMinimum","validateGenerator","ucs2length","patterns","patternsHash","defaults","defaultsHash","customRules","checkCompiling","compilation","localCompile","cv","sourceCode","endCompiling","_schema","_root","isTop","useDefault","vars","refValCode","patternCode","defaultCode","customRuleCode","processCode","makeValidate","Function","_refVal","refCode","refIndex","resolvedRef","rootRefId","addLocalRef","localSchema","inlineRef","inlineRefs","replaceLocalRef","removeLocalRef","refId","regexStr","valueStr","rule","deps","compIndex","statement","distanceSquared","xp","yp","abs","unicode","linePoint","p2x","p2y","p1x","p1y","deepClone","expectsFrom","receivedFrom","passesTo","computedResult","getRawArgument","defaultValue","evaluateArgument","hasArgument","getArgument","hasParameterDefault","getParent","argument","getNode","getResult","getProcessGraphParameterValue","dependencyNode","DATE","DAYS","TIME","HOSTNAME","URI","URIREF","URITEMPLATE","URL","JSON_POINTER","JSON_POINTER_URI_FRAGMENT","RELATIVE_JSON_POINTER","mode","isLeapYear","year","date","month","day","time","full","hour","minute","second","timeZone","fast","email","hostname","ipv4","ipv6","date_time","DATE_TIME_SEPARATOR","dateTime","NOT_URI_FRAGMENT","Z_ANCHOR","lineBox","ProcessRegistry","multipleOfPrecision","resolveSchema","refPath","_getFullPath","getFullPath","resolveRecursive","getJsonPointer","parsedRef","resolveUrl","resolveIds","PREVENT_SCOPE_CHANGE","toHash","part","unescapeFragment","SIMPLE_INLINED","limit","checkNoRef","countKeys","item","TRAILING_SLASH_HASH","baseIds","fullPaths","escapeFragment","callback","loadSchema","loadMetaSchemaOf","then","_compileAsync","loadMissingSchema","added","schemaPromise","removePromise","omitFromObject","unsupportedArgs","getArgumentNames","findIndex","getParsedArgument","rawArg","validateArgument","argType","isSchemaCompatible","reason","normalizeJsonSchema","isProcessGraphSchema","elementSchema","getElementJsonSchema","lastError","validator","validateValue","$vSchema","$required","$property","$propertySch","$currentErrorPath","$loopRequired","$propertyPath","$missingProperty","l2","$propertyKey","$prop","$useData","arr3","i3","l3","getPath","$schemaDeps","$propertyDeps","$deps","$schemaKeys","notProto","$pProperties","$pPropertyKeys","$aProperties","$someProperties","$noAdditional","$additionalIsSchema","$removeAdditional","removeAdditional","$checkAdditional","$requiredHash","$pProperty","$additionalProperty","$useDefaults","useDefaults","$hasDefault","arr4","i4","l4","$isMax","$exclusiveKeyword","$schemaExcl","$isDataExcl","$notOp","$schemaValueExcl","$exclusive","$exclType","$exclIsNumber","$opExpr","$opStr","ruleModules","ALL","TYPES","types","group","implKeywords","implements","custom","$itemType","$typeIsArray","$method","strictNumbers","$refKeywords","schemaHasRulesExcept","$unknownKwd","schemaUnknownRules","$keywordsMsg","$top","rootId","strictDefaults","$defaultMsg","$closingBraces1","$closingBraces2","$typeSchema","extendRefs","coerceTypes","$coerceToTypes","coerceToTypes","$rulesGroup","$shouldUseGroup","$dataType","$coerced","checkDataType","$type","arr5","i5","l5","$shouldUseRule","$ruleImplementsSomeKeyword","impl","lineToPolygon","polygonPolygon","linePolygon","lineToLine","lineLineThickness","thickness1","thickness2","$thenSch","$elseSch","$thenPresent","$elsePresent","$ifClause","CommonProcessRegistry","$allSchemasEmpty","cmp","cycles","f","aobj","bobj","seen","isFinite","seenIndex","geoJsonSchema","subtypeSchemas","validateSubtype","epsgCodes","fileFormats","udfRuntimes","char","makeSchema","funcName","getFunctionName","io","codeWords","some","word","date1","Date","date2","getTime","interval","validateTemporalInterval","parser","paramSchema","valueSchema","strict","allowValueAsElements","paramSchemas","valueSchemas","compatible","ps","vs","dataType","negate","EQUAL","AND","OK","NOT","checkDataTypes","dataTypes","object","null","number","integer","unescapeJsonPointer","escapeJsonPointer","COERCE_TO_TYPES","optionCoerceTypes","hash","IDENTIFIER","SINGLE_QUOTE","expr","exceptKeyword","currentPath","isNumber","joinPaths","lvl","paths","up","jsonPointer","decodeURIComponent","encodeURIComponent","definitionSchema","_addRule","ruleGroup","rg","throwError","_validateKeyword"],"mappings":"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ACA5E,oBAGA,YACA,WACAA,sBAEA,mBACAA,oBAOA,OAHA,oDACAA,sBAEA,GAEAgF,eACA,kCACA,OACA,wEACA,8DACA,yBACAY,4BAYA,MARA,oBACA,eACAA,oBAIAA,KAEA,GAEAb,eACA,2CACA,GAEA,iEACA,WAGA,WAGAc,cACA,+CAEAC,eACA,gDAEAC,aACA,+CAEAC,uBACA,+CAEAC,uBAEA,oFAGAC,OACAd,QACA,wBACA,4CAEA1H,OACAyI,aACAC,UACA,2BAIAC,SACAC,mBACA,gBACA,wBACA1F,gCAIA2F,oBACA,IACA,wDACA,kCACA,sCACA,qCACA,YACA,SAEA,OADAC,gBACA,OAGAC,yBACA,2BACA,uCAGAC,aACA,8BAEAC,YACA,4DACAjJ,OAEA,uBAEAkJ,aACA,sCAKA,MACA,2BACAlJ,WAEA,CACA,oCACA,UACA,aACAA,KACA,MACA,YACAA,KACA,MACA,aACAA,KACA,MACA,cACA,aACAA,IACA,MACA,cACAA,KACA,MACA,QACAA,UAGA,sBA/BA,6BAiCAmJ,cACA,mBACA,WAGA,oBAGAC,iBACA,yBACA,KAGA,6BAGA,oBACA,4BACA,mCAEA,mDACA,iBACApJ,UACA,sBAGA,sBAGA,sBACA,8BACA,0CAGA,GACA,kBAHA,sBAWA,sBA7BA,kBAgCAqJ,sBACA,iBACA,yBACA,gCACA,mBAEA,sCACA,2DAIAC,4BACA,qBACA,eACA,aACA,sCAGA,0BACAtJ,cAGAA,+CAKA,sBACA,eACA,2DAGA,iCACA,KAGAA,0CAIA,UAEAuJ,WACA,mBACA,iCACA,uBAGAC,aACA,wBACA,oBAGA,OAFA,2BACA,4BACA,EAGA,UAEAC,cACA,yBACA,yCAGA,kCAEAC,mBACA,2BACA,SAEA,0BACA,SAEA,eACA,8BACA,SAGA,UAEAC,eACA,0BAEAC,mBACA,wDACA,wDAEA,qCACA,oBACA,oCAGA,WAGAC,sBACA,uBACA,gBACA,MAEA,iBACA,wBAGA,yBAGA,wBACA,eACA,yCACA,iEAGA,8BAGA,2BACA,WAEA,oBACA,aAGA,wCAGAC,sBACA,SACA,gBACA,WACA,2BACA,wDAEA,eACA,gBACA,sDAGAC,sCACA,MAIAA,UACAC,cAGA,qBAEAC,4BACA,mBACA,qDACA,yCAGA,UAGAC,uBACA,iCACA,OAEA,iEACA,wBAEA,gBACA,wCAEA,qHACA,4BAEA,wBACA,2BAIA,uFCnfqT,I,wBCQjTC,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,MAIa,EAAAA,E,QCnBA,GACdC,aAAc,IACdC,WAAY,CACXC,cAAe,IACfC,QAAS,GACTC,aAAc,IACdC,OAAQ,MCiDV,MAAMC,EAAkB,GAET,OACf/L,aACAgM,YACAC,kBAEArD,OACA/E,IACA/F,YACAgC,aAEAhC,MACAA,YACAgC,aAEA4E,UACA5G,aACAsC,YAEAoF,UACA1H,WACAgC,aAEA4F,YACA5H,aAEA6H,WACA7H,YACAsC,cAEAF,aACApC,YACAsC,cAEAyF,MACA/H,YACAsC,kBAEAwF,QACA9H,aACAsC,YAEAqF,QACA3H,YACAsC,cAEAmF,MACAzH,YACAsC,kBAEAyE,OACA/G,YACAgC,cAGAgJ,OACA,OACAxB,wBACA4E,YAGArC,OACA,sBACA,mCAEA3J,aACA4J,aACAC,UACA,qDAIAf,UAEAmD,QACA,mBACA,gCACA,sDAGA,2CAGAC,SACA,OACAC,mFACAC,kFACAC,6CACAJ,qDAGApF,aACA,SAQA,OAPAqE,kBACA,gBACAA,2BAEA,aACAA,oBAEA,YAEApL,OACA,kBACA,cACA,yBACA,kBAGA,eAEA,gBACA,sBACA,QACA,2BAGAgI,cACA,mBACA,SAEA,iBACA,oBAGA,IAGAzB,mBACA,gBAiBA,OAhBA,kBACA5C,2BAEA,kBACAA,yBAEA,aACAA,uBAEA,eACAA,yBAEA,cACAA,wBAGA,GAEA6I,UACA,qDAGA,SAEA,gDAEA,SAEA,mBACA,SAIA,cACA,SAIA,oEACA,sCACA,uBACA,SAGA,SAGA,UAEAC,YACA,0BACA,mBACA,uBAEA,4CACA,oBAGA,aAEAC,eACA,4FAGA,KAFA,cAIAhF,cACA,+BAEAiF,wBACA,wBACA,8DAGA,oDAGAC,eACA,8FAEAC,aACA,yBACA,wCAEA,iBACA,mEAGA,sCAGAxF,oBAEA,mDAEAyF,SACA,+BAGAC,uBACA,gHAEApN,aACA,SACA,KAKA,GAJA,4BACAA,4DACAqN,oBAEA,yBACA,uBACA,eACArN,kCACAK,OACAE,kBAKA,UAEA+M,SACA,SACA,6BACAA,YAGA,OADAA,qBACA,GAEA/E,SACA,SACA,6BACA,iBACA3C,YAEA,qCACAA,sBAGA,OACAvF,cACAlE,oBACAoE,8BACAC,YACA+H,UACA7G,UAQA,OANA,iBACA6G,yCAGAA,oCAEA,IAGAgF,UAEA,yCACAC,uDAEA,yCACAA,qDAEA,4BAEAC,gBACAD,0DACAA,wDAEA,8BAEAnD,SACArC,OACA,iBACA,qBAGA,sBAGA0F,gBACA,8EAEAhF,qBACA,MAEAhH,EADA,0DACAA,eAGAA,KAEA,mCACA,sBACA,sCAGAiM,uBACAC,wBACA,kDACA,qCAGAC,mBACA,6BACAC,OAAA9L,kFAEA,6BACA,uHACA,UAGA,sCAEAmG,oBACA,kCACAjC,OACA,yBAEAoC,gBACA,sBACA,0EAGA,iBACA,iCAGAb,QACA,sBAEApD,eACA,yCAEA0J,kBACA,oCACA,cAEAC,gBACA,kDACA,mCAGA,OAFAC,8BACAA,4BACA,GAEA7F,kBACA8F,qCAEAC,gBACA,mHAEAC,sBACA,+JAEAtG,WACA,kBACA,uDAEA,iBACA,8CAGA,iEAGA,uBACA,cACA,mCACA,iBACA,qCAEA,kBACA,4BACA,mBACA,iBACA,sBAEAuG,gBACA,+DAEAC,aACA,kBACA,OAGA,kCACA,WACAxI,qBACAyI,yCAGAC,WACA,cAIA,0BACA,qGACA,mCAEA,iBAEAC,YACA,cACA,OAGA,kCACA,qCAEA,2BAGAC,iBACA,8DAGA,qBACA,gCAMAC,qBACA,mCACA,yBAEA,yCACA,kDACA,cACA,YAGA,aAGAC,uBACA,gCACA,4DACA,sBAGAC,sBACA,yBACA,YAEA,qBACA,wBACA,mBACA,yDACA,kCACA,gFACA,UAIA,eC/hB4S,ICQxS,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,OAIa,I,QCnBX,EAAS,WAAa,IAAIrL,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,IAAIJ,EAAImB,GAAInB,EAAS,OAAE,SAASsL,EAAKxN,GAAG,OAAOsC,EAAG,OAAOJ,EAAI+B,GAAG,CAACvD,IAAIV,GAAG,OAAOwN,GAAK,OAAU,IAC7L,EAAkB,GCDP,MAAMC,EAEjB,YAAYC,EAAGC,EAAGC,EAAIC,GAClB1L,KAAKuL,EAAIA,EACTvL,KAAKwL,EAAIA,EACTxL,KAAKyL,GAAKA,EACVzL,KAAK0L,GAAKA,EAMd,SAASC,EAAQC,GACb,OAAOC,KAAKC,KAAKD,KAAKE,IAAIH,EAAOL,EAAEI,EAAOJ,EAAE,GAAKM,KAAKE,IAAIH,EAAOJ,EAAEG,EAAOH,EAAE,IAMhF,UAAUQ,GACN,IAAItD,EAAS1I,KAAK0I,SAClBA,EAAO6C,EAAIS,EAAMT,EACjB7C,EAAO8C,EAAIQ,EAAMR,EACjB,IAAIS,EAAejM,KAAKiM,aAAavD,GAErC,MAAO,CAACuD,EAAa,GAAIjM,KAAKkM,SAASxD,EAAOyD,MAAMF,EAAa,IAAKD,IAM1E,SACI,OAAO,IAAIV,EAAQtL,KAAKuL,EAAGvL,KAAKwL,EAAGxL,KAAK0L,IAAK1L,KAAKyL,IAMtD,aAAaW,GACT,IAAIC,EAAIrM,KAAKyL,GACTa,GAAKF,EAAMX,GACXc,EAAIvM,KAAK0L,GACTc,GAAKJ,EAAMV,GACXe,EAAKL,EAAMb,EAAEvL,KAAKuL,EAClBmB,EAAKN,EAAMZ,EAAExL,KAAKwL,EAClBmB,EAAMN,EAAEG,EAAIF,EAAEC,EAElB,GAAW,GAAPI,EACA,OAAO,KAGX,IAAIC,GAAMJ,EAAEC,EAAKH,EAAEI,GAAIC,EACnBE,IAAON,EAAEE,EAAKJ,EAAEK,GAAIC,EAExB,MAAO,CAACC,EAAIC,GAMhB,MAAMR,GACF,IAAIL,EAAQ,GAIZ,OAHAA,EAAMT,EAAIvL,KAAKuL,EAAEvL,KAAKyL,GAAGY,EACzBL,EAAMR,EAAIxL,KAAKwL,EAAExL,KAAK0L,GAAGW,EAElBL,GCxDA,OACfpP,YACA4I,OACA/E,MACAW,YACA1G,YACAgC,aAEA2E,YACA3G,YACAgC,aAEA4E,UACA5G,aACAsC,YAEAuE,UACA7G,aACAsC,YAEAwE,QACA9G,WACAsC,gBAEA8P,WACApS,YACAsC,WAEA+P,WACArS,WACAsC,2BAEAyE,OACA/G,YACAgC,cAGAgJ,OACA,OACAsH,eACAC,iBAGArH,UACAsH,UACA,aACA,kBACA,kBACA,oCACA,sCAGAC,kBACA,wCAEAC,QAEA,8CACA,0CAEA,iBACA,cACA,cACA,eACA,eAEA,6GACA,8BACA,0BACA,0BAEA,sEACA,4DAEA,0FACA,4CAEA,IAGA,CACAC,EACA,4CACA,+CAKA5G,OACA,iBACA,wBAEA,gBACA,wBAEA,iBACA,yBAGA6G,UACA,wBAEAxD,UACA,4BAEAE,gBACA,8BAEApD,SACA2G,kBACA,0CACA,sCACA,OAGA,yIACA,gCACA,gCACA,wDAGAC,0BACA,yBACA,iBAOA,OANA,EACAC,cAEA,uBACAA,eAEA,CACA,+BACA,iBACA,0CAaAC,sBACA,sBAAAnQ,KAAAC,KAAAC,KAAAC,MAAA,IAKAiQ,aACA,iBACA,SAGA,8BAAApC,IAAAC,MAEA,yBACA,wCACA,MASAoC,UACA,qEAGA,gECvL2S,ICOvS,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,MAIa,I,8DCoCf,MAAMC,EAAkB,SAAxB,GACA,0BACAC,OACA/I,YACAgJ,eACAC,YACAC,eACAC,aACApD,YACAhI,qBACAqL,cACAC,eAGMC,EAAS,GAETC,EAAyB,SAAUC,EAAQC,GACjD,yFACA,uEAIe,OACf5R,oBACAgM,YACA6F,QACAC,OACAC,qEAEAnJ,OACA/E,IACA/F,YACAgC,aAEAqI,UACArK,aACAsC,YAEAiB,OACAvD,YACAsC,kBAEA4R,aACAlU,WACAsC,gBAEA6R,WACAnU,oBACAsC,gBAEA8R,QACApU,YACAsC,cAEA+R,cACArU,YACAsC,cAEAgS,aACAtU,YACAsC,YAEAiS,cACAvU,aACAsC,aAGA0I,OACA,OACAwJ,aACAC,cAGAC,iBAGAC,WACAC,oBAEAC,kCAEAC,UAEA7J,SACA8J,2BAEAC,kBAGAC,cAEAC,aAEAC,eAEAC,qBACA9O,YACAe,iBACAkB,qBAEAF,+BAGAtB,gBAGAmE,UACArF,UACA,OACA,gBACA,iBA6BA,OA3BA,eACAA,gBAEA,eACAA,mBAGA,wBACAA,kBAGA,oBACAA,mBAEA,oBACAA,kBAEA,oBACAA,kBAEA,qBACAA,kBAGAA,mBAGA,GAEA0B,aACA,4BAGA,CACAsJ,0EACAC,0EACAzC,8EACAgH,+EACA,yBACA,iBACA,yBATA,MAYAC,kBAGA,oIACA,sBAEA,iCACA,gDAGA,kFAGAC,eACA,uCAEAC,gBACA,kDAEAC,iBACA,0CAEAC,gBACA,yCAEAC,mBACA,8EACA,sBAEA,MAEAC,eACA,kEAEAC,+BAGA,SACA,4FACAC,wDAGA,SAEA,oBACAC,6CAIA,+CAEA,qBAGAhK,OACAsI,eACA,qEAEA,eAEA,kBAKA,iBACA,qBACA,eAAA2B,aAAAC,oBAGA5L,UACA2B,aACAC,WACA,wBAGAyJ,gBACAD,iBACAhB,aACA,sCAEAD,YACA,yBAGA0B,eACA5S,8BAEA,gBACA,wBAEA,iDAEA,gCACA,kEAGA,gBACAA,6BAGA,wBAGA,2DACA+L,oEAEA,0EACA,wBAAA2G,aAAAC,kBACA,oBAEArC,eAEA,mBAEAtE,gBACAD,kEAEAnD,SACAhF,mBACAT,iBACAA,kBAEAQ,gBACAkP,QACA,wBAEAC,kBACA,eAIA,0EAHA,oBAMAC,4BACA,YACA,2BAEA,2BACA,cACA,YACA,yCAGAC,4BACA,6BACA,eAEAC,yBACA,0BACA,wBAEAC,uBACA,wBACA,eAEAC,8BACA,GACA,mBAEA,0BACA,yBAEAC,qBACA,uFACA,kCACAxV,mBAEA,oBACA,kBACA,WAEA,qBACA,aAEA,uBACA,eAEA,sBACA,eAEA+G,qBACA,UACA,gBACA,iCACA,MACA,kBACA,iCACA,MACA,eACA,2BACA,MACA,aACA,wBACA,MACA,eACA,gCACA,MACA,WACA,0BACA,QAGA0O,gCAIA,oFAEA,YADA,iCAIA,SACA,gCACA,0BACA,qBACA,0DACA,SAGA,mFACA,eACA,IACA,+CACA,SAEA,oDACA,MACA,SAEA,wCACA,6BACA,0BACA,OACA,gCACAC,qCAGAA,MACAC,SACA9Q,KACAW,aACAC,eAIA,SACA0F,iBAMA,gCAEAyK,sBACA,iCACA,+DACA,oBAIA3O,kBACA,yBACA,OACAX,oBAIAuP,eACA,iCACA,mEAEAC,mBACA,eACA,OACAvQ,yBAIAwQ,YACA,qDAEA3N,QACA,wBAEA4N,QACA,oBACA,oBAGA,uBAGAC,eACA,EACA,qBACA,uBAEA,yBACA,yBACA,wBAIA,uBACA,yBACA,wBAGAC,cACA,sBACA,YACAzH,OAAAiC,IACA,qCACA,4BACA,8DAEA,WAEAyF,IAAAzF,kBACA,WACAjC,OAAA2H,sJACAD,IAAAC,mBAEAC,SACA,oBACA,iCAEA,2BACA,2BAGA,uBACA,4CAEA,uBACA,mBACA,2BAEA,oBACA,wBAEA,2CACA,iCACA,UACA,oDACA,SACA,sBAGA,gBAGA,mBACA,wBACA,OAEA,6EACA,eACA,8BACA,OAIA,SACA,uBAEA,qBACA,sBACAC,UAEA,wBACA,oBACA,qCACA,OAGA,IACA,6CACA,0BACA,eACA,SACA,oCAGAA,UAEA,oBACA,qBACA,gBACA1C,oCACA7J,wCAIA,IACA,0BACA,iCACAuM,KACA,SACA,mCAGAA,KAKA,IACAjM,mBACAA,sBAGApF,gBACA,4BAGA,yDACA,0BACA,gCACA,4BACA,uCACA,mCACA,oBACAoF,mBACA,uBAGAkM,kBACA,gCAGA,OAFAC,uFACAA,2FACA,GAEAC,eACA,6CACA,OACApM,iBACAA,kBAGAtF,eACA,yBAGA,IACA,0BAEA,+CACA,kEACA,MACA,6DACA,OACA,mDACA,uCACA,gBAcA,GATA,uBACA,gCAGA,oBACA,qEACA,qBAGA,qBACA,8CACA,IACA,kBACApD,QACAC,QACAC,QACAC,QACA,yBACA,qCAIA,SACA,wBAGAkD,eACA,wBACA,OAEA,WACA,sBAEA,cAcA,aAbA,WAEA,sBACA0R,QACAC,WAKA,mBAIA,YACA,UAGA,+BACA,SAUA,GATA,4CACA,KACAC,eAEA,OACAA,iBAGA,wBACA,kBACA,sBACA,sBAGAvM,mBACA,OAKA,0CACA,qBAGA,cAGAsE,gBACA,4CAGA,cACA,6CACA,cAEA,sGACA,mBACA,kBACA,gBACA,sCACA,KAIAkI,yBAEA,6BAIA,OACA,oBAEA,OACA,6CACA,sCAGA,sBAOAC,cACA,sBACA,6EACA,sCACA,qBAEA,0CACA,+DAEA,mBACA,sBAEA,mBACA,qBAEA,qBACA,4BACA,kBACA,IACA,sBACA,eAAAA,eAAA/B,eAAAgC,kBACA,gEAIAC,sBAEA,GADA1Q,0BACA,iBAIA,4BACA,SACA,KACA,gCACA,mBAMA,GAFA2Q,KAEA,EACA,kCAIA,mCACA,6BACAC,KACA,OAKA,SACA,sEAIAC,0BACA,2BAOA,OANA,WACAxH,0DAEA,WACAC,yDAEA,OAGAwH,+BACA,sBACA1Q,aACAC,YACAV,YACAO,cAIA6Q,mBACA,kCACA,wCACAxS,+CACA,2BACAA,MAIAA,IAEA,+BACAiB,cAEA,OACAjB,SACA/F,eACA4G,YACAc,oBACAE,wBACAC,sBACAV,sBACA/E,gCACA0F,qBAEA,uBACAN,2DAGA,2BAcA,OAbAA,iFAGA,6DACA,SAGA,gCACAA,aAGA,uCACA,cACA,GAGAgR,8BACA,2BACA,KACA,8EACA,8EAKA,OAHA,0BACA,yBAEA,GAGAC,gBACA,UACA,4BACA,2DAGA,IAMA,EANA,WACAnV,yBACAA,0DAGA,eAGA+K,EADA,IACAA,sDAGAA,0CAGA,2CACA,WAEA,aAGAqK,qBACA,2BACA,oBACA,qCACA,sCAEA,uBAGAC,cACA,yBACA,kCAEA,wBACA,uBAIAC,0BAIA,OAHA,qBACAnS,iBAEA,iBAGA,UACA,0BAEA,oCACA,IAMAoS,cACApS,0BACAA,0BACA,gDAMA,qBAGA,yBACA,WACA,uBACAqD,8BACA,WAEA,KACA,kHAKA,6CACA,2CACA,OACA,SAGA,iCACA,gEACA,mBASA,OALA,UACA,yBAGA,6BACA,KAOAgP,gBACA,sCACA,kBACA,KAEA,MAMA,uBACA,iCAIA,gCAEA,0CACA,0BACA,oBAKA,yCACA,mBAEA,YAIA,8BACA,SACA,mBACA,2BACA,MACA,4BAEA,UACA,iCAEAhE,oBAEA,aACAA,0BACAA,4BAIA,mBACA,UACA,yCAGA,SAIA,wBACA,wCAGA,wBACA,GAAA/O,KAAAa,YAAAC,YAAAC,UAAA+P,UAYA,GAXA,UACApQ,eACAA,iBAIAA,eACAA,gBAIA,0CACA,gDAGA,kEACA,iCAGA,qEACA,wCAIA,wBACA,0BACA,sCAKA,wGACA,mFACAA,iBACA,sBAGA,6CACA,cAGA,sCACAA,wBACAA,wBAGA,6CACA,MAOAsS,iBACA,gBAEA,KACA,MACAC,WAEA,kBACA,cACA,qBACA,yBACA,oBACA,gBACA,eACA,YACAA,WACAC,aAOA,yBAMA,sBACA,+CACA,uDACA,iBACA,qBAGAC,aACA,OACAtV,kBAGA,iCACA,oEACA,GAEAzC,mBAEA,iCAEA,6BACA,eAEA,qBACA,SAEA,oBACA,YAEA,qBACA6J,qBAGA,iBACAA,gBACA,6BACA,eACAA,0BAMA,gDAOA,oCACA,MACA,0BAEA,IACAmO,aACA,SAGA,GADA,0CACA,kBACA,UACA,YACA,SACA,sCAGAA,KAMA,OAHA,0BACA,4CAEA,GAOA,qBACA,6CAOA,IALA,oBACA,aACA,2DAGA,mBACA,SAIA,MAuBA,OAtBA,gCAEAC,yDACAA,sDAGAA,gDAEAA,eACAA,UACA,yCAEA,8FACA,0DACA,qCAEA,oBACA,oBAGA,0DAEA,GACAC,IAGA,mCACA,qBACA,OAGA,OACApD,eACA+B,eACAhC,cAEA,6CAEA,IACA,uEAGA,4BACA,QACA,eACAtO,IACA,OACAvE,kBAGA,+BAEAkW,IAGA,wCACA,6CACA,iBAEA,sEAGAvP,sBACA,gCACAA,aAEA,oCACA/D,KACA/F,iBACA2H,SACAD,0FACAD,0BAEA,MAIA6R,kBACA,oDAGAC,sBACA,4DAGA,qBACA,mBACA,+BACA,2BACA,gBACA,6BACA,gCACA,mBACA,6EACA,MACA,sBACA,oEACA,MACA,aACA,kBACA,+BACA,UAMA,gCACA,eAEA,2DACA,sCAEA,qBACA,SAEA,kBACA,6EAEA,wBACA,sEAKA,kCACA,SACA,IACA,gBAMA,+EAC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","file":"js/chunk-492aef2a.4cb5206a.js","sourcesContent":["'use strict';\nmodule.exports = function generate_format(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  if (it.opts.format === false) {\n    if ($breakOnError) {\n      out += ' if (true) { ';\n    }\n    return out;\n  }\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  var $unknownFormats = it.opts.unknownFormats,\n    $allowUnknown = Array.isArray($unknownFormats);\n  if ($isData) {\n    var $format = 'format' + $lvl,\n      $isObject = 'isObject' + $lvl,\n      $formatType = 'formatType' + $lvl;\n    out += ' var ' + ($format) + ' = formats[' + ($schemaValue) + ']; var ' + ($isObject) + ' = typeof ' + ($format) + ' == \\'object\\' && !(' + ($format) + ' instanceof RegExp) && ' + ($format) + '.validate; var ' + ($formatType) + ' = ' + ($isObject) + ' && ' + ($format) + '.type || \\'string\\'; if (' + ($isObject) + ') { ';\n    if (it.async) {\n      out += ' var async' + ($lvl) + ' = ' + ($format) + '.async; ';\n    }\n    out += ' ' + ($format) + ' = ' + ($format) + '.validate; } if (  ';\n    if ($isData) {\n      out += ' (' + ($schemaValue) + ' !== undefined && typeof ' + ($schemaValue) + ' != \\'string\\') || ';\n    }\n    out += ' (';\n    if ($unknownFormats != 'ignore') {\n      out += ' (' + ($schemaValue) + ' && !' + ($format) + ' ';\n      if ($allowUnknown) {\n        out += ' && self._opts.unknownFormats.indexOf(' + ($schemaValue) + ') == -1 ';\n      }\n      out += ') || ';\n    }\n    out += ' (' + ($format) + ' && ' + ($formatType) + ' == \\'' + ($ruleType) + '\\' && !(typeof ' + ($format) + ' == \\'function\\' ? ';\n    if (it.async) {\n      out += ' (async' + ($lvl) + ' ? await ' + ($format) + '(' + ($data) + ') : ' + ($format) + '(' + ($data) + ')) ';\n    } else {\n      out += ' ' + ($format) + '(' + ($data) + ') ';\n    }\n    out += ' : ' + ($format) + '.test(' + ($data) + '))))) {';\n  } else {\n    var $format = it.formats[$schema];\n    if (!$format) {\n      if ($unknownFormats == 'ignore') {\n        it.logger.warn('unknown format \"' + $schema + '\" ignored in schema at path \"' + it.errSchemaPath + '\"');\n        if ($breakOnError) {\n          out += ' if (true) { ';\n        }\n        return out;\n      } else if ($allowUnknown && $unknownFormats.indexOf($schema) >= 0) {\n        if ($breakOnError) {\n          out += ' if (true) { ';\n        }\n        return out;\n      } else {\n        throw new Error('unknown format \"' + $schema + '\" is used in schema at path \"' + it.errSchemaPath + '\"');\n      }\n    }\n    var $isObject = typeof $format == 'object' && !($format instanceof RegExp) && $format.validate;\n    var $formatType = $isObject && $format.type || 'string';\n    if ($isObject) {\n      var $async = $format.async === true;\n      $format = $format.validate;\n    }\n    if ($formatType != $ruleType) {\n      if ($breakOnError) {\n        out += ' if (true) { ';\n      }\n      return out;\n    }\n    if ($async) {\n      if (!it.async) throw new Error('async format in sync schema');\n      var $formatRef = 'formats' + it.util.getProperty($schema) + '.validate';\n      out += ' if (!(await ' + ($formatRef) + '(' + ($data) + '))) { ';\n    } else {\n      out += ' if (! ';\n      var $formatRef = 'formats' + it.util.getProperty($schema);\n      if ($isObject) $formatRef += '.validate';\n      if (typeof $format == 'function') {\n        out += ' ' + ($formatRef) + '(' + ($data) + ') ';\n      } else {\n        out += ' ' + ($formatRef) + '.test(' + ($data) + ') ';\n      }\n      out += ') { ';\n    }\n  }\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ('format') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { format:  ';\n    if ($isData) {\n      out += '' + ($schemaValue);\n    } else {\n      out += '' + (it.util.toQuotedString($schema));\n    }\n    out += '  } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should match format \"';\n      if ($isData) {\n        out += '\\' + ' + ($schemaValue) + ' + \\'';\n      } else {\n        out += '' + (it.util.escapeQuotes($schema));\n      }\n      out += '\"\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema:  ';\n      if ($isData) {\n        out += 'validate.schema' + ($schemaPath);\n      } else {\n        out += '' + (it.util.toQuotedString($schema));\n      }\n      out += '         , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += ' } ';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_not(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  if ((it.opts.strictKeywords ? (typeof $schema == 'object' && Object.keys($schema).length > 0) || $schema === false : it.util.schemaHasRules($schema, it.RULES.all))) {\n    $it.schema = $schema;\n    $it.schemaPath = $schemaPath;\n    $it.errSchemaPath = $errSchemaPath;\n    out += ' var ' + ($errs) + ' = errors;  ';\n    var $wasComposite = it.compositeRule;\n    it.compositeRule = $it.compositeRule = true;\n    $it.createErrors = false;\n    var $allErrorsOption;\n    if ($it.opts.allErrors) {\n      $allErrorsOption = $it.opts.allErrors;\n      $it.opts.allErrors = false;\n    }\n    out += ' ' + (it.validate($it)) + ' ';\n    $it.createErrors = true;\n    if ($allErrorsOption) $it.opts.allErrors = $allErrorsOption;\n    it.compositeRule = $it.compositeRule = $wasComposite;\n    out += ' if (' + ($nextValid) + ') {   ';\n    var $$outStack = $$outStack || [];\n    $$outStack.push(out);\n    out = ''; /* istanbul ignore else */\n    if (it.createErrors !== false) {\n      out += ' { keyword: \\'' + ('not') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: {} ';\n      if (it.opts.messages !== false) {\n        out += ' , message: \\'should NOT be valid\\' ';\n      }\n      if (it.opts.verbose) {\n        out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n      }\n      out += ' } ';\n    } else {\n      out += ' {} ';\n    }\n    var __err = out;\n    out = $$outStack.pop();\n    if (!it.compositeRule && $breakOnError) {\n      /* istanbul ignore if */\n      if (it.async) {\n        out += ' throw new ValidationError([' + (__err) + ']); ';\n      } else {\n        out += ' validate.errors = [' + (__err) + ']; return false; ';\n      }\n    } else {\n      out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n    }\n    out += ' } else {  errors = ' + ($errs) + '; if (vErrors !== null) { if (' + ($errs) + ') vErrors.length = ' + ($errs) + '; else vErrors = null; } ';\n    if (it.opts.allErrors) {\n      out += ' } ';\n    }\n  } else {\n    out += '  var err =   '; /* istanbul ignore else */\n    if (it.createErrors !== false) {\n      out += ' { keyword: \\'' + ('not') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: {} ';\n      if (it.opts.messages !== false) {\n        out += ' , message: \\'should NOT be valid\\' ';\n      }\n      if (it.opts.verbose) {\n        out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n      }\n      out += ' } ';\n    } else {\n      out += ' {} ';\n    }\n    out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n    if ($breakOnError) {\n      out += ' if (false) { ';\n    }\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_const(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  if (!$isData) {\n    out += ' var schema' + ($lvl) + ' = validate.schema' + ($schemaPath) + ';';\n  }\n  out += 'var ' + ($valid) + ' = equal(' + ($data) + ', schema' + ($lvl) + '); if (!' + ($valid) + ') {   ';\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ('const') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { allowedValue: schema' + ($lvl) + ' } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should be equal to constant\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += ' }';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","module.exports = {\r\n\tsubtype: {\r\n\t\tmetaSchema: {\r\n\t\t\ttype: \"string\"\r\n\t\t}\r\n\t},\r\n\tparameters: {\r\n\t\tdependencies: [\r\n\t\t\t\"subtype\"\r\n\t\t],\r\n\t\tmetaSchema: {\r\n\t\t\ttype: \"array\",\r\n\t\t\titems: {\r\n\t\t\t\ttype: \"object\",\r\n\t\t\t\trequired: [\r\n\t\t\t\t\t\"name\",\r\n\t\t\t\t\t\"description\",\r\n\t\t\t\t\t\"schema\"\r\n\t\t\t\t],\r\n\t\t\t\tproperties: {\r\n\t\t\t\t\tname: {\r\n\t\t\t\t\t\ttype: \"string\",\r\n\t\t\t\t\t\tpattern: \"^\\\\w+$\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdescription: {\r\n\t\t\t\t\t\ttype: \"string\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\toptional: {\r\n\t\t\t\t\t\ttype: \"boolean\",\r\n\t\t\t\t\t\tdefault: false\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdeprecated: {\r\n\t\t\t\t\t\ttype: \"boolean\",\r\n\t\t\t\t\t\tdefault: false\r\n\t\t\t\t\t},\r\n\t\t\t\t\texperimental: {\r\n\t\t\t\t\t\ttype: \"boolean\",\r\n\t\t\t\t\t\tdefault: false\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdefault: {\r\n\t\t\t\t\t\t// Any type\r\n\t\t\t\t\t},\r\n\t\t\t\t\tschema: {\r\n\t\t\t\t\t\toneOf: [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\"$ref\": \"http://json-schema.org/draft-07/schema\"\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ttype: \"array\",\r\n\t\t\t\t\t\t\t\titems: {\r\n\t\t\t\t\t\t\t\t\t\"$ref\": \"http://json-schema.org/draft-07/schema\"\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\treturns: {\r\n\t\tdependencies: [\r\n\t\t\t\"subtype\"\r\n\t\t],\r\n\t\tmetaSchema: {\r\n\t\t\ttype: \"object\",\r\n\t\t\trequired: [\r\n\t\t\t\t\"schema\"\r\n\t\t\t],\r\n\t\t\tproperties: {\r\n\t\t\t\tdescription: {\r\n\t\t\t\t\ttype: \"string\"\r\n\t\t\t\t},\r\n\t\t\t\tschema: {\r\n\t\t\t\t\toneOf: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"$ref\": \"http://json-schema.org/draft-07/schema\"\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttype: \"array\",\r\n\t\t\t\t\t\t\titems: {\r\n\t\t\t\t\t\t\t\t\"$ref\": \"http://json-schema.org/draft-07/schema\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};","var polygonPoint = require('./polygon-point')\nvar lineLine = require('./lineToLine')\n\n/**\n * line-polygon collision\n @param {number} x1 point 1 of line\n @param {number} y1 point 1 of line\n @param {number} x2 point 2 of line\n @param {number} y2 point 2 of line\n @param {number[]} points of polygon\n @param {tolerance=1} maximum distance of point to polygon's edges that triggers collision (see pointLine)\n */\nmodule.exports = function linePolygon(x1, y1, x2, y2, points, tolerance)\n{\n    var length = points.length\n\n    // check if first point is inside the shape (this covers if the line is completely enclosed by the shape)\n    if (polygonPoint(points, x1, y1, tolerance))\n    {\n        return true\n    }\n\n    // check for intersections for all of the sides\n    for (var i = 0; i < length; i += 2)\n    {\n        var j = (i + 2) % length\n        if (lineLine(x1, y1, x2, y2, points[i], points[i + 1], points[j], points[j + 1]))\n        {\n            return true\n        }\n    }\n    return false\n}\n","const CommonUtils = require('@openeo/js-commons/src/utils.js');\r\n\r\n/**\r\n * Utilities\r\n * \r\n * @class\r\n */\r\nclass Utils extends CommonUtils {\r\n\r\n\t/**\r\n\t * Checks whether a value contains references (from_parameter, from_node).\r\n\t * \r\n\t * Doesn't return references from ProcessGraph objects if checkCallbacks is set to true.\r\n\t * \r\n\t * @param {*} value \r\n\t * @param {boolean} checkProcess - Set to `false` to not check for refs in a process if provided as value.\r\n\t * @param {boolean} checkCallbacks - Set to `true` to also check for refs in callbacks. Only applies if `checkProcess` is true.\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic containsRef(value, checkProcess = true, checkCallbacks = false) {\r\n\t\tlet type = Utils.getType(value);\r\n\t\tswitch(type) {\r\n\t\t\tcase 'result':\r\n\t\t\tcase 'parameter':\r\n\t\t\t\treturn true;\r\n\t\t\tcase 'callback':\r\n\t\t\t\tif (checkProcess && Utils.containsRef(value.process_graph, checkCallbacks, checkCallbacks)) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'array':\r\n\t\t\tcase 'object':\r\n\t\t\t\tfor(let key in value) {\r\n\t\t\t\t\tif (Utils.containsRef(value[key], checkProcess, checkCallbacks)) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns all distinct references (from_parameter, from_node) contained in a value.\r\n\t * \r\n\t * Doesn't return references from ProcessGraph objects if checkCallbacks is set to true.\r\n\t * \r\n\t * @param {*} value \r\n\t * @param {boolean} getFromProcess - Set to `false` to not get refs from a process if provided as value.\r\n\t * @param {boolean} getFromCallbacks - Set to `true` to also include refs in callbacks. Only applies if `getFromProcess` is true.\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic getRefs(value, getFromProcess = true, getFromCallbacks = false) {\r\n\t\tvar store = [];\r\n\t\tvar type = Utils.getType(value);\r\n\t\tswitch(type) {\r\n\t\t\tcase 'result':\r\n\t\t\tcase 'parameter':\r\n\t\t\t\tstore.push(value);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'callback':\r\n\t\t\t\tif (getFromProcess) {\r\n\t\t\t\t\tstore = store.concat(Utils.getRefs(value.process_graph, getFromCallbacks, getFromCallbacks));\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'array':\r\n\t\t\tcase 'object':\r\n\t\t\t\tfor(var key in value) {\r\n\t\t\t\t\tstore = store.concat(Utils.getRefs(value[key], getFromProcess, getFromCallbacks));\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn Utils.unique(store, true);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the type of the value.\r\n\t * \r\n\t * Similar to typeof, but gives more details for objects (array, parameter, callback, result, null, object).\r\n\t * \r\n\t * @param {*} value \r\n\t * @returns {string}\r\n\t */\r\n\tstatic getType(value) {\r\n\t\tconst ProcessGraph = require('./processgraph');\r\n\t\tif (typeof value === 'object') {\r\n\t\t\tif (value === null) {\r\n\t\t\t\treturn 'null';\r\n\t\t\t}\r\n\t\t\telse if (Array.isArray(value)) {\r\n\t\t\t\treturn 'array';\r\n\t\t\t}\r\n\t\t\telse if(value.hasOwnProperty(\"process_graph\") || value instanceof ProcessGraph) {\r\n\t\t\t\treturn 'callback';\r\n\t\t\t}\r\n\t\t\telse if(value.hasOwnProperty(\"from_node\")) {\r\n\t\t\t\treturn 'result';\r\n\t\t\t}\r\n\t\t\telse if(value.hasOwnProperty(\"from_parameter\")) {\r\n\t\t\t\treturn 'parameter';\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn 'object';\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn (typeof value);\r\n\t}\r\n\r\n}\r\n\r\nmodule.exports = Utils;","'use strict'\n\n/**\n * box-box collision\n * @param {number} x1 top-left corner of first box\n * @param {number} y1 top-left corner of first box\n * @param {number} w1 width of first box\n * @param {number} h1 height of first box\n * @param {number} x2 top-left corner of second box\n * @param {number} y2 top-left corner of second box\n * @param {number} w2 width of second box\n * @param {number} h2 height of second box\n */\nmodule.exports = function boxBox(x1, y1, w1, h1, x2, y2, w2, h2)\n{\n    return x1 < x2 + w2 && x1 + w1 > x2 && y1 < y2 + h2 && y1 + h1 > y2\n}\n","'use strict'\n\n/**\n * lineToLine helper function (to avoid circular dependencies)\n * from http://stackoverflow.com/questions/563198/how-do-you-detect-where-two-line-segments-intersect\n * @param {number} x1 first point in line 1\n * @param {number} y1 first point in line 1\n * @param {number} x2 second point in line 1\n * @param {number} y2 second point in line 1\n * @param {number} x3 first point in line 2\n * @param {number} y3 first point in line 2\n * @param {number} x4 second point in line 2\n * @param {number} y4 second point in line 2\n * @return {boolean}\n */\nmodule.exports = function lineToLine(x1, y1, x2, y2, x3, y3, x4, y4)\n{\n    var s1_x = x2 - x1\n    var s1_y = y2 - y1\n    var s2_x = x4 - x3\n    var s2_y = y4 - y3\n    var s = (-s1_y * (x1 - x3) + s1_x * (y1 - y3)) / (-s2_x * s1_y + s1_x * s2_y)\n    var t = (s2_x * (y1 - y3) - s2_y * (x1 - x3)) / (-s2_x * s1_y + s1_x * s2_y)\n    return s >= 0 && s <= 1 && t >= 0 && t <= 1\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"div\",class:_vm.classes,attrs:{\"id\":_vm.id,\"tabindex\":\"0\"},on:{\"mousemove\":_vm.onMouseMove,\"mousedown\":_vm.onMouseDown,\"wheel\":_vm.onMouseWheel,\"keydown\":_vm.onKeyDown,\"focus\":function($event){_vm.hasFocus = true},\"blur\":function($event){_vm.hasFocus = false}}},[_c('svg',{staticClass:\"canvas\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"version\":\"1.1\"}},[_vm._l((_vm.edges),function(edge){return _c('Edge',{key:edge.id,attrs:{\"id\":edge.id,\"parameter1\":edge.parameter1,\"parameter2\":edge.parameter2,\"selected\":edge.selected,\"inactive\":edge.inactive,\"issues\":edge.issues,\"state\":_vm.state},on:{\"mounted\":function (node) { return _vm.mount(edge, node); },\"unmounted\":function () { return _vm.mount(edge); },\"position\":function($event){return _vm.updateEdgePos(edge, arguments)}}})}),_vm._l((_vm.hiddenParameterRefEdges),function(edge){return _c('Edge',{key:edge.id,attrs:{\"id\":edge.id,\"parameter1\":edge.parameter1,\"parameter2\":edge.parameter2,\"inactive\":true,\"lineColor\":[200,200,200,1],\"lineWidth\":2,\"state\":_vm.state},on:{\"mounted\":function (node) { return _vm.mount(edge, node); },\"unmounted\":function () { return _vm.mount(edge); }}})}),(_vm.linkingLine)?_c('line',_vm._b({},'line',_vm.linkingLine,false)):_vm._e(),(_vm.selectRect)?_c('rect',_vm._b({},'rect',_vm.selectRect,false)):_vm._e()],2),_c('div',{staticClass:\"blocks\"},_vm._l((_vm.blocks),function(block){return _c('Block',{key:block.id,attrs:{\"id\":block.id,\"type\":block.type,\"spec\":block.spec,\"state\":_vm.state,\"selected\":block.selected,\"position\":block.position,\"origin\":block.origin,\"process_id\":block.process_id,\"namespace\":block.namespace,\"result\":block.result,\"args\":block.arguments,\"description\":block.description},on:{\"update\":function () {\n\tvar args = [], len = arguments.length;\n\twhile ( len-- ) args[ len ] = arguments[ len ];\n\n\treturn _vm.updateBlock.apply(void 0, [ block ].concat( args ));\n},\"mounted\":function (node) { return _vm.mount(block, node); },\"unmounted\":function () { return _vm.mount(block); },\"move\":_vm.startDragBlock}})}),1),(_vm.state.scale < 0.7 || _vm.showZoomInfo)?_c('div',{staticClass:\"zoomInfo\"},[(_vm.state.scale < 0.7)?_c('div',[_vm._v(\" Zoom in for more details. \")]):_vm._e(),(_vm.showZoomInfo)?_c('div',[_vm._v(\" Zoom with \"),_c('kbd',[_vm._v(\"STRG\")]),_vm._v(\" or \"),_c('kbd',[_vm._v(\"Meta\")]),_vm._v(\" key and the mouse wheel. \")]):_vm._e()]):_vm._e(),(_vm.parameterViewer)?_c('ParameterViewer',_vm._b({on:{\"close\":function($event){_vm.parameterViewer = null}}},'ParameterViewer',_vm.parameterViewer,false)):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"div\",class:_vm.containerClasses,style:(_vm.styles),attrs:{\"id\":'block' + this.id},on:{\"mousedown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"left\",37,$event.key,[\"Left\",\"ArrowLeft\"])){ return null; }$event.preventDefault();$event.stopPropagation();if('button' in $event && $event.button !== 0){ return null; }return _vm.onMouseDown.apply(null, arguments)}}},[_c('div',{staticClass:\"blockTitle\",on:{\"mousedown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"left\",37,$event.key,[\"Left\",\"ArrowLeft\"])){ return null; }$event.preventDefault();$event.stopPropagation();if('button' in $event && $event.button !== 0){ return null; }return _vm.emitDrag.apply(null, arguments)}}},[_c('span',{staticClass:\"titleText\",attrs:{\"title\":_vm.plainTitle}},[_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.invalid),expression:\"invalid\"}],staticClass:\"invalid\",attrs:{\"title\":\"Process or Collection not supported!\"}},[_c('i',{staticClass:\"fas fa-exclamation-triangle\"})]),_vm._v(\" \"+_vm._s(_vm.name)+\" \"),(_vm.showId)?_c('span',{staticClass:\"blockId\"},[_vm._v(_vm._s(_vm.id))]):_vm._e()]),_c('div',{staticClass:\"blockicon\",on:{\"mousedown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"left\",37,$event.key,[\"Left\",\"ArrowLeft\"])){ return null; }$event.preventDefault();$event.stopPropagation();if('button' in $event && $event.button !== 0){ return null; }return _vm.focus()}}},[_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.allowsDescription && !_vm.showDescriptionField),expression:\"allowsDescription && !showDescriptionField\"}],staticClass:\"addDescription\",attrs:{\"title\":\"Add description\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.addDescription()}}},[_c('i',{staticClass:\"fas fa-comment-medical\"})]),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.allowsDelete),expression:\"allowsDelete\"}],staticClass:\"delete\",attrs:{\"title\":\"Remove (DEL)\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.remove()}}},[_c('i',{staticClass:\"fas fa-trash\"})]),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.allowsInfo),expression:\"allowsInfo\"}],staticClass:\"info\",attrs:{\"title\":\"Details\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.showInfo()}}},[_c('i',{staticClass:\"fas fa-info\"})]),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.allowsParameterChange),expression:\"allowsParameterChange\"}],staticClass:\"settings\",attrs:{\"title\":_vm.isParameter ? 'Edit parameter' : 'Change parameter values'},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.edit.apply(null, arguments)}}},[_c('i',{staticClass:\"fas fa-edit\"})])])]),_c('div',{staticClass:\"inout\"},[_c('div',{staticClass:\"inputs\"},_vm._l((_vm.parameters),function(param,i){return _c('BlockParameter',{key:i,ref:\"parameters\",refInFor:true,attrs:{\"state\":_vm.state,\"value\":_vm.args[param.name],\"name\":param.name,\"description\":param.description,\"optional\":param.optional,\"deprecated\":param.deprecated,\"experimental\":param.experimental,\"default\":param.default,\"schema\":param.schema},on:{\"input\":function (value) { return _vm.updateArgument(param.name, value); },\"edgesChanged\":function($event){return _vm.edgesChanged(param, $event)}}})}),1),_c('div',{staticClass:\"outputs\"},[_c('BlockParameter',_vm._b({ref:\"output\",attrs:{\"state\":_vm.state,\"label\":_vm.outputLabel},on:{\"input\":_vm.updateResult}},'BlockParameter',_vm.output,false))],1)]),(_vm.showDescriptionField)?_c('textarea',{ref:\"descriptionField\",staticClass:\"editDescription\",attrs:{\"readonly\":!_vm.state.editable,\"placeholder\":\"Type description here...\"},domProps:{\"value\":_vm.description},on:{\"blur\":_vm.updateDescription,\"mousedown\":function($event){$event.stopPropagation();}}}):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:_vm.classes},[(!_vm.output)?_c('div',_vm._g({ref:\"circle\",class:_vm.circleClasses},_vm.circleListeners)):_vm._e(),_c('span',_vm._g({staticClass:\"text\"},_vm.textListeners),[_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.unspecified),expression:\"unspecified\"}],staticClass:\"unspecified\",attrs:{\"title\":\"Parameter is likely unsupported!\"}},[_c('i',{staticClass:\"fas fa-exclamation-triangle\"})]),_c('span',{staticClass:\"label\"},[_vm._v(_vm._s(_vm.displayLabel))]),(_vm.displayValue.length)?[_vm._v(\": \")]:_vm._e(),_c('span',{staticClass:\"value\",domProps:{\"innerHTML\":_vm._s(_vm.displayValue)}})],2),(_vm.output)?_c('div',_vm._g({ref:\"circle\",class:_vm.circleClasses,attrs:{\"title\":\"Output of the process\"}},_vm.circleListeners)):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div :class=\"classes\">\r\n        <div v-if=\"!output\" ref=\"circle\" :class=\"circleClasses\" v-on=\"circleListeners\"></div>\r\n        <span class=\"text\" v-on=\"textListeners\">\r\n            <span v-show=\"unspecified\" class=\"unspecified\" title=\"Parameter is likely unsupported!\">\r\n                <i class=\"fas fa-exclamation-triangle\"></i>\r\n            </span>\r\n            <span class=\"label\">{{ displayLabel }}</span><template v-if=\"displayValue.length\">: </template>\r\n            <span class=\"value\" v-html=\"displayValue\"></span>\r\n        </span>\r\n        <div v-if=\"output\" ref=\"circle\" :class=\"circleClasses\" v-on=\"circleListeners\" title=\"Output of the process\"></div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { ProcessSchema } from '@openeo/js-commons';\r\nimport { ProcessGraph } from '@openeo/js-processgraphs';\r\nimport Utils from '../../utils.js';\r\n\r\nexport default {\r\n    name: 'BlockParameter',\r\n    props: {\r\n        name: {\r\n            type: String,\r\n            default: 'output'\r\n        },\r\n        description: {\r\n            type: String,\r\n            default: ''\r\n        },\r\n        optional: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        deprecated: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        experimental: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        default: {},\r\n        value: {},\r\n        schema: {\r\n            type: [Object, Array],\r\n            default: null\r\n        },\r\n        label: {\r\n            type: String\r\n        },\r\n        output: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        state: {\r\n            type: Object,\r\n            required: true\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            // The attached edges\r\n            edges: []\r\n        };\r\n    },\r\n    computed: {\r\n        schemas() {\r\n            if (this.schema instanceof ProcessSchema) {\r\n                return this.schema;\r\n            }\r\n            else {\r\n                return new ProcessSchema(this.schema);\r\n            }\r\n        },\r\n        hasValue() {\r\n            return (this.value !== undefined);\r\n        },\r\n        textListeners() {\r\n            if (this.allowsArgumentChange) {\r\n                return {\r\n                    click: this.openEditorForArguments\r\n                };\r\n            }\r\n            else {\r\n                return {};\r\n            }\r\n        },\r\n        circleListeners() {\r\n            var listeners = {};\r\n            if (this.state.editable) {\r\n                listeners.mousedown = event => {\r\n                    if (event.which == 1) {\r\n                        this.state.root.link(this);\r\n                        event.preventDefault();\r\n                        event.stopPropagation();\r\n                    }\r\n                };\r\n\r\n                if (this.output) {\r\n                    // Allow specifying the result node\r\n                    listeners.dblclick = event => {\r\n                        if (event.which == 1) {\r\n                            this.$emit('input', true);\r\n                        }\r\n                    };\r\n                }\r\n\r\n                // Handle focus on the I/Os\r\n                listeners.mouseover = () => this.state.linkFrom && this.state.root.link(this);\r\n                listeners.mouseout = () => this.state.linkTo && this.state.root.unlink(this);\r\n            }\r\n            return listeners;\r\n        },\r\n        classes() {\r\n            let classes = [\r\n                this.output ? 'output' : 'input',\r\n                'connector',\r\n                'field_' + this.name,\r\n                (this.hasValue || this.optional || this.output || this.getEdgeCount() > 0) ? 'hasValue' : 'noValue',\r\n            ];\r\n            if (this.allowsArgumentChange) {\r\n                classes.push(\"editable\");\r\n            }\r\n            return classes;\r\n        },\r\n        unspecified() {\r\n            return !this.$parent.invalid && this.state.root.hasProcesses && this.schemas.unspecified;\r\n        },\r\n        circleClasses() {\r\n            var classes = ['circle'];\r\n            if (this.getEdgeCount() > 0) {\r\n                classes.push('io_active');\r\n            }\r\n\r\n            for (var edge of this.edges) {\r\n                if (edge.selected) {\r\n                    classes.push('io_selected');\r\n                }\r\n                else if (edge.issues.length > 0) {\r\n                    classes.push('io_issues');\r\n                }\r\n            }\r\n\r\n            if (this.state.linkFrom == this || this.state.linkTo == this) {\r\n                classes.push('io_selected');\r\n            }\r\n            return classes;\r\n        },\r\n        displayValue() {\r\n            var maxLength = 38 - this.displayLabel.length;\r\n            var formattedValue = null;\r\n            if (this.isEditable && !this.state.compactMode && !Utils.isRef(this.value)) {\r\n                let value = typeof this.value !== 'undefined' ? this.value : this.default;\r\n                if (typeof value !== 'undefined') {\r\n                    formattedValue = this.formatValue(value, maxLength, true);\r\n                }\r\n            }\r\n\r\n            if (typeof formattedValue === 'string') {\r\n                if (formattedValue.length === 0) {\r\n                    formattedValue = '<em>Empty</em>';\r\n                }\r\n            }\r\n            else {\r\n                formattedValue = '';\r\n            }\r\n            return formattedValue;\r\n        },\r\n        displayLabel() {\r\n            if (this.output && this.state.compactMode) {\r\n                return '';\r\n            }\r\n            else if (typeof this.label === 'string' && (this.label.length > 0 || this.output)) {\r\n                return this.label;\r\n            }\r\n            else {\r\n                return this.name;\r\n            }\r\n        },\r\n        isArrayType() {\r\n            return this.schemas.nativeDataType() === 'array';\r\n        },\r\n        isObjectType() {\r\n            return this.schemas.nativeDataType() === 'object';\r\n        },\r\n        isEditable() {\r\n            return !this.output && this.schemas.isEditable();\r\n        },\r\n        allowsArgumentChange() {\r\n            return (!this.output && this.schemas.isEditable());\r\n        },\r\n        allowsMultipleInputs() {\r\n            // Is there any type that potentially allows multiple inputs?\r\n            return this.isArrayType || this.isObjectType || this.schemas.nativeDataType() === 'any';\r\n        },\r\n    },\r\n    watch: {\r\n        edges() {\r\n            this.updateEdgeStatus();\r\n            this.$emit('edgesChanged', this.edges, this);\r\n        },\r\n        value: {\r\n            immediate: true,\r\n            handler() {\r\n                this.updateEdgeStatus();\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n        updateEdgeStatus() {\r\n            if (!this.output) {\r\n                for(var edge of this.edges) {\r\n                    edge.inactive = !this.isEdgeUsed(edge);\r\n                }\r\n            }\r\n        },\r\n        getCirclePosition() {\r\n            try {\r\n                var dim = this.state.root.domBoundingBox(this.$refs.circle);\r\n                var blocksDim = this.state.root.getDimensions();\r\n                var x = (dim.offsetLeft - blocksDim.offsetLeft) + dim.width / 2;\r\n                var y = (dim.offsetTop - blocksDim.offsetTop) + dim.height / 2;\r\n                return [x, y];\r\n            } catch (error) {\r\n                console.warn(error);\r\n                return null;\r\n            }\r\n        },\r\n        openEditorForArguments() {\r\n            if (this.allowsArgumentChange) {\r\n                this.$parent.showArguments(this.name);\r\n            }\r\n        },\r\n        jsonSchema() {\r\n            return this.schemas.toJSON();\r\n        },\r\n        setValue(value) {\r\n            if (this.schemas.nativeDataType() == 'boolean' && !Utils.isRef(value)) {\r\n                value = !!value;\r\n            }\r\n            this.$emit('input', value);\r\n        },\r\n        resetValue() {\r\n            if (typeof this.default !== 'undefined') {\r\n                this.setValue(this.default);\r\n                return;\r\n            }\r\n            \r\n            var value;\r\n            if (this.schemas.nullable()) {\r\n                value = null;\r\n            }\r\n            else {\r\n                var dataType = this.schemas.nativeDataType();\r\n                switch(dataType) {\r\n                    case 'object':\r\n                        value = {};\r\n                        break;\r\n                    case 'array':\r\n                        value = [];\r\n                        break;\r\n                    case 'string':\r\n                        value = '';\r\n                        break;\r\n                    case 'integer':\r\n                    case 'number':\r\n                        value = 0;\r\n                        break;\r\n                    case 'boolean':\r\n                        value = false;\r\n                        break;\r\n                    default:\r\n                        value = undefined;\r\n                }\r\n            }\r\n            this.setValue(value);\r\n        },\r\n        getEdgeRef(edge) {\r\n            if (this.output) {\r\n                return this.value;\r\n            }\r\n            else {\r\n                return edge.parameter1.value;\r\n            }\r\n        },\r\n        addRefToValue(edge) {\r\n            var ref = this.getEdgeRef(edge);\r\n            if (!ref) {\r\n                return;\r\n            }\r\n            else if (!this.allowsMultipleInputs) {\r\n                this.setValue(ref);\r\n            }\r\n            else if (this.isArrayType) {\r\n                if (Utils.isRef(this.value)) {\r\n                    this.setValue([this.value, ref]);\r\n                }\r\n                else if (Array.isArray(this.value) && this.value.length > 0) {\r\n                    var value = this.value;\r\n                    value.push(ref);\r\n                    this.setValue(value);\r\n                }\r\n                else {\r\n                    this.setValue(ref);\r\n                }\r\n            }\r\n            else if (this.isObjectType) {\r\n                var propertyCount = Utils.size(this.value);\r\n                if (this.getEdgeCount() === 1 && (!this.hasValue || !propertyCount)) {\r\n                    this.setValue(ref);\r\n                }\r\n                else if (!propertyCount) {\r\n                    this.resetValue();\r\n                }\r\n                else {\r\n                    // Don't change value\r\n                }\r\n            }\r\n            else {\r\n                // ToDo: This is probably of data type mixed or any, how to handle?\r\n                this.setValue(ref);\r\n            }\r\n        },\r\n        removeRefFromValue(edge) {\r\n            if (!this.output) {\r\n                var ref = this.getEdgeRef(edge);\r\n                if (Utils.isRefEqual(ref, this.value)) {\r\n                    this.resetValue();\r\n                }\r\n                else if (this.isArrayType || this.isObjectType) {\r\n                    this.setValue(this.removeRefFromValueDeep(this.value, ref));\r\n                }\r\n            }\r\n        },\r\n        removeRefFromValueDeep(value, ref) {\r\n            if (Array.isArray(value)) {\r\n                var i = value.length;\r\n                while(--i >= 0) {\r\n                    if (value[i] === null || typeof value[i] !== 'object') {\r\n                        continue;\r\n                    }\r\n                    else if (Utils.isRefEqual(ref, value[i])) {\r\n                        value.splice(i, 1);\r\n                    }\r\n                    else {\r\n                        value[i] = this.removeRefFromValueDeep(value[i], ref);\r\n                    }\r\n                }\r\n\r\n            }\r\n            else if (Utils.isObject(value)) {\r\n                for(var key in value) {\r\n                    if (!value.hasOwnProperty(key) || value[key] === null || typeof value[key] !== 'object') {\r\n                        continue;\r\n                    }\r\n                    else if (Utils.isRefEqual(ref, value[key])) {\r\n                        delete value[key];\r\n                    }\r\n                    else {\r\n                        value[i] = this.removeRefFromValueDeep(value[key], ref);\r\n                    }\r\n                }\r\n            }\r\n            return value;\r\n        },\r\n        addEdge(edge) {\r\n            this.edges.push(edge);\r\n            if (!this.isEdgeUsed(edge) && !this.output) {\r\n                this.addRefToValue(edge);\r\n            }\r\n        },\r\n        eraseEdge(edge) {\r\n            for (var k in this.edges) {\r\n                if (this.edges[k] == edge) {\r\n                    this.removeRefFromValue(edge);\r\n                    this.$delete(this.edges, k);\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n        isEdgeUsed(edge) {\r\n            var ref = this.getEdgeRef(edge);\r\n            if (Utils.isRefEqual(ref, this.value)) {\r\n                return true;\r\n            }\r\n            return this.hasRefInValue(ref, this.value);\r\n        },\r\n        hasRefInValue(ref, value) {\r\n            if (!value || typeof value !== 'object') {\r\n                return false;\r\n            }\r\n            else if (Utils.isRefEqual(ref, value)) {\r\n                return true;\r\n            }\r\n            for(let key in value) {\r\n                if (this.hasRefInValue(ref, value[key])) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n        getEdgeCount() {\r\n            return this.edges.length;\r\n        },\r\n        formatProcess(pg, maxLength) {\r\n            if (pg instanceof ProcessGraph && pg.getNodeCount() === 1) {\r\n                return this.formatValue(pg.getResultNode().process_id, maxLength);\r\n            }\r\n            var nodes = Object.values(pg.process_graph);\r\n            if (nodes.length === 1) {\r\n                return this.formatValue(nodes[0].process_id, maxLength);\r\n            }\r\n            else {\r\n                return 'Process';\r\n            }\r\n        },\r\n        formatValue(value, maxLength, html = true) {\r\n            if (typeof value === 'object') {\r\n                if (value === null) {\r\n                    return 'n/a';\r\n                }\r\n                else if (Array.isArray(value)) {\r\n                    return this.formatArray(value, maxLength, html);\r\n                }\r\n                else {\r\n                    return this.formatObject(value, maxLength, html);\r\n                }\r\n            }\r\n            else if (typeof value === 'string') {\r\n                if (value.length > maxLength) {\r\n                    var text = Utils.htmlentities(value.substr(0, maxLength));\r\n                    return html ? text + '<span title=\"' + Utils.htmlentities(value) + '\"></span>' : text;\r\n                }\r\n                else {\r\n                    return Utils.htmlentities(value);\r\n                }\r\n            }\r\n            else if (typeof value === 'boolean') {\r\n                return value ? '' : '';\r\n            }\r\n            else if (typeof value === 'number') {\r\n                return value.toString();\r\n            }\r\n            else {\r\n                return Utils.htmlentities(JSON.stringify(value));\r\n            }\r\n        },\r\n        formatArray(values, maxLength, html = true) {\r\n            let parts = [];\r\n            for(let i in values) {\r\n                let value = values[i];\r\n                let formatted = this.formatValue(value, 10, html);\r\n                let unformatted = Utils.htmlentities_decode(this.formatValue(value, 10, false));\r\n\r\n                if (unformatted.length > maxLength) {\r\n                    if (parts.length === 0) {\r\n                        return this.formatArraySimple(values, 'List(' + values.length + ')');\r\n                    }\r\n                    else {\r\n                        parts.push(this.formatArraySimple(values, ''));\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                parts.push(formatted);\r\n                maxLength -= unformatted.length + 2;\r\n            }\r\n            \r\n            return parts.join(\", \");\r\n        },\r\n        formatArraySimple(values, text, html = true) {\r\n            if (html && values.length < 10) {\r\n                let title = values.map(v => this.formatValue(v, 25, false)).join(', ');\r\n                return '<span title=\"' + title + '\">' + text + '</span>';\r\n            }\r\n            else {\r\n                return text;\r\n            }\r\n        },\r\n        formatObject(value, maxLength, html = true) {\r\n            if (Object.keys(value).length === 0) {\r\n                return 'None';\r\n            }\r\n            else if (value instanceof ProcessGraph || Utils.isObject(value.process_graph)) {\r\n                return this.formatProcess(value, maxLength);\r\n            }\r\n            else if (Utils.isRef(value)) {\r\n                return this.formatValue(Utils.formatRef(value), maxLength);\r\n            }\r\n            else if (typeof value.west !== 'undefined' && typeof value.east !== 'undefined' && typeof value.south !== 'undefined' && typeof value.north !== 'undefined') {\r\n                return maxLength >= 12 ? 'Bounding Box' : 'BBox';\r\n            }\r\n            else if (Utils.detectGeoJson(value)) {\r\n                return this.formatValue(value.type, maxLength);\r\n            }\r\n\r\n            // Fallback to default\r\n            return html ? '<span title=\"' + Utils.htmlentities(JSON.stringify(value)) + '\">Object</span>' : 'Object';\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.vue-component.model-builder {\r\n    .block .connector {\r\n        font-size: 0.9em;\r\n        margin: 0.2em 0;\r\n        white-space: nowrap;\r\n        \r\n        &.noValue {\r\n            color: red;\r\n        }\r\n        &.editable .label,\r\n        &.editable .value {\r\n            cursor: pointer;\r\n        }\r\n        span[title] {\r\n            cursor: help;\r\n        }\r\n        .input {\r\n            max-width: 100%;\r\n            overflow: hidden;\r\n            text-overflow: ellipsis;\r\n        }\r\n        .output {\r\n            text-align: right;\r\n        }\r\n        .unspecified {\r\n            color: red;\r\n            margin-right: 0.3em;\r\n        }\r\n        .circle {\r\n            width: 0.8em;\r\n            height: 0.8em;\r\n            margin: 0 0.2em;\r\n            border: 1px solid #888;\r\n            background-color: transparent;\r\n            display: inline-block;\r\n\r\n            &.io_active {\r\n                background-color: #FFC800;\r\n            }\r\n            &.io_selected {\r\n                background-color: #00C800 !important;\r\n            }\r\n            &.io_issues {\r\n                background-color: #FF0000;\r\n            }\r\n        }\r\n    }\r\n\r\n    &.editable .circle {\r\n        cursor: pointer;\r\n    }\r\n}\r\n</style>","import mod from \"-!../../../../cache-loader/dist/cjs.js??ref--13-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!./BlockParameter.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../cache-loader/dist/cjs.js??ref--13-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!./BlockParameter.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BlockParameter.vue?vue&type=template&id=70b6715c&\"\nimport script from \"./BlockParameter.vue?vue&type=script&lang=js&\"\nexport * from \"./BlockParameter.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BlockParameter.vue?vue&type=style&index=0&id=70b6715c&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default {\r\n\tdefaultScale: 1.3,\r\n\tblockWidth: {\r\n\t\tcompactParams: 110,\r\n\t\tcompact: 60,\r\n\t\tnormalParams: 220,\r\n\t\tnormal: 110\r\n\t}\r\n};","<template>\r\n    <div :id=\"'block' + this.id\" ref=\"div\" :class=\"containerClasses\" @mousedown.prevent.stop.left=\"onMouseDown\" :style=\"styles\">\r\n        <div class=\"blockTitle\" @mousedown.prevent.stop.left=\"emitDrag\">\r\n            <span class=\"titleText\" :title=\"plainTitle\">\r\n                <span v-show=\"invalid\" class=\"invalid\" title=\"Process or Collection not supported!\">\r\n                    <i class=\"fas fa-exclamation-triangle\"></i>\r\n                </span>\r\n                {{ name }}\r\n                <span v-if=\"showId\" class=\"blockId\">{{ id }}</span>\r\n            </span>\r\n            <div class=\"blockicon\" @mousedown.prevent.stop.left=\"focus()\">\r\n                <span v-show=\"allowsDescription && !showDescriptionField\" class=\"addDescription\" title=\"Add description\" @click.stop.prevent=\"addDescription()\">\r\n                    <i class=\"fas fa-comment-medical\"></i>\r\n                </span>\r\n                <span v-show=\"allowsDelete\" class=\"delete\" title=\"Remove (DEL)\" @click.stop.prevent=\"remove()\">\r\n                    <i class=\"fas fa-trash\"></i>\r\n                </span>\r\n                <span v-show=\"allowsInfo\" class=\"info\" title=\"Details\" @click.stop.prevent=\"showInfo()\">\r\n                    <i class=\"fas fa-info\"></i>\r\n                </span>\r\n                <span v-show=\"allowsParameterChange\" class=\"settings\" :title=\"isParameter ? 'Edit parameter' : 'Change parameter values'\" @click.stop.prevent=\"edit\">\r\n                    <i class=\"fas fa-edit\"></i>\r\n                </span>\r\n            </div>\r\n        </div>\r\n        <div class=\"inout\">\r\n            <div class=\"inputs\">\r\n                <BlockParameter v-for=\"(param, i) in parameters\" :key=\"i\" ref=\"parameters\" :state=\"state\" :value=\"args[param.name]\" @input=\"value => updateArgument(param.name, value)\" @edgesChanged=\"edgesChanged(param, $event)\" :name=\"param.name\" :description=\"param.description\" :optional=\"param.optional\" :deprecated=\"param.deprecated\" :experimental=\"param.experimental\" :default=\"param.default\" :schema=\"param.schema\" />\r\n            </div>\r\n            <div class=\"outputs\">\r\n                <BlockParameter ref=\"output\" :state=\"state\" :label=\"outputLabel\" v-bind=\"output\" @input=\"updateResult\" />\r\n            </div>\r\n        </div>\r\n        <textarea ref=\"descriptionField\" v-if=\"showDescriptionField\" :value=\"description\" :readonly=\"!state.editable\" class=\"editDescription\" placeholder=\"Type description here...\" @blur=\"updateDescription\" @mousedown.stop=\"\"></textarea>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport BlockParameter from './BlockParameter.vue';\r\nimport Utils from '../../utils.js';\r\nimport { ProcessParameter, ProcessUtils } from '@openeo/js-commons';\r\nimport { Utils as PgUtils } from '@openeo/js-processgraphs';\r\nimport Config from './config.js';\r\n\r\n/*\r\nEvents:\r\n\r\nEmits locally:\r\n- moved(x, y) - The block has been moved\r\n- input(value) - The value has been updated\r\n- move() - A block is now being moved\r\n- mounted(node) - The block is now part of the DOM.\r\n- unmounted(node) - The block not not part of the DOM anylonger.\r\n*/\r\n\r\nconst defaultFontSize = 10;\r\n\r\nexport default {\r\n    name: 'Block',\r\n    components: {\r\n        BlockParameter\r\n    },\r\n    props: {\r\n        id: {\r\n            type: String,\r\n            required: true\r\n        },\r\n        type: {\r\n            type: String,\r\n            required: true\r\n        },\r\n        selected: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        position: {\r\n            type: Array,\r\n            required: true\r\n        },\r\n        process_id: {\r\n            type: String\r\n        },\r\n        namespace: {\r\n            type: String,\r\n            default: null\r\n        },\r\n        description: {\r\n            type: String,\r\n            default: null\r\n        },\r\n        args: {\r\n            type: Object,\r\n            default: () => ({})\r\n        },\r\n        result: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        origin: {\r\n            type: String,\r\n            default: null\r\n        },\r\n        spec: {\r\n            type: Object,\r\n            default: () => null\r\n        },\r\n        state: {\r\n            type: Object,\r\n            required: true\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            showDescriptionField: false,\r\n            drag: null // Is the user dragging ?\r\n        };\r\n    },\r\n    watch: {\r\n        'state.compactMode'() {\r\n            this.$emit('moved', this.position);\r\n        },\r\n        description: {\r\n            immediate: true,\r\n            handler() {\r\n                this.showDescriptionField = (this.description !== null);\r\n            }\r\n        }\r\n    },\r\n    computed: {\r\n        // Visualizations\r\n        width() {\r\n            let size = Config.blockWidth;\r\n            if (this.parameters.length > 0) {\r\n                return this.state.compactMode ? size.compactParams : size.normalParams;\r\n            }\r\n            else {\r\n                return this.state.compactMode ? size.compact : size.normal;\r\n            }\r\n        },\r\n        styles() {\r\n            return {\r\n                marginLeft: Math.round(this.state.center[0] + this.position[0] * this.state.scale) + 'px',\r\n                marginTop: Math.round(this.state.center[1] + this.position[1] * this.state.scale) + 'px',\r\n                fontSize: Math.round(this.state.scale * defaultFontSize) + 'px',\r\n                width: Math.round(this.state.scale * this.width) + 'px',\r\n            };\r\n        },\r\n        plainTitle() {\r\n            let parts = [];\r\n            parts.push(this.name);\r\n            if (this.namespace) {\r\n                parts.push(`@${this.namespace}`);\r\n            }\r\n            if (this.showId) {\r\n                parts.push(` ${this.id}`);\r\n            }\r\n            return parts.join('');\r\n        },\r\n        name() {\r\n            switch(this.type) {\r\n                case 'process':\r\n                    if (this.collectionId) {\r\n                        return this.collectionId;\r\n                    }\r\n                    else {\r\n                        return this.processId;\r\n                    }\r\n                case 'parameter':\r\n                    return this.spec.name;\r\n                default:\r\n                    return this.id.substr(1);\r\n            }\r\n        },\r\n        outputLabel() {\r\n            if (this.result) {\r\n                return \"Result\";\r\n            }\r\n            else if (this.isParameter) {\r\n                return \"Process Parameter\";\r\n            }\r\n            else {\r\n                return \"\";\r\n            }\r\n        },\r\n        containerClasses() {\r\n            var classes = ['block'];\r\n            if (this.collectionId) {\r\n                classes.push('block_collection');\r\n            }\r\n            else if (this.isParameter) {\r\n                classes.push('block_argument');\r\n            }\r\n            if (this.result) {\r\n                classes.push('block_result');\r\n            }\r\n            if (this.selected) {\r\n                classes.push('block_selected');\r\n            }\r\n            if (this.invalid) {\r\n                classes.push('block_invalid');\r\n            }\r\n\r\n            return classes;\r\n        },\r\n        invalid() {\r\n            if (this.type !== 'process' || !this.$parent.hasProcesses) {\r\n                // We can only check processes for validity\r\n                // Also, don't check for validity if no processes to validate against are given\r\n                return false;\r\n            }\r\n            else if (this.namespace && Utils.isUrl(this.namespace)) {\r\n                // If the namespace is a URL, then don't complain about a missing process\r\n                return false;\r\n            }\r\n            else if (!this.processId) {\r\n                return true;\r\n            }\r\n\r\n            // Check that the process exists\r\n            if (!this.spec) {\r\n                return true;\r\n            }\r\n\r\n            // Check that the collection exists\r\n            if (this.processId === 'load_collection' && !Utils.isRef(this.args.id)) {\r\n                for(let collection of this.$parent.collections) {\r\n                    if (this.args.id === collection.id) {\r\n                        return false;\r\n                    }\r\n                }\r\n                return true;\r\n            }\r\n\r\n            return false;\r\n        },\r\n        processId() {\r\n            if (this.type === 'process') {\r\n                if (this.process_id) {\r\n                    return this.process_id;\r\n                }\r\n                else if (Utils.isObject(this.spec) && this.spec.id) {\r\n                    return this.spec.id;\r\n                }\r\n            }\r\n            return null;\r\n        },\r\n        collectionId() {\r\n            if (this.type === 'process' && this.processId === 'load_collection' && !Utils.isRef(this.args.id)) {\r\n                return this.args.id;\r\n            }\r\n            return null;\r\n        },\r\n        isParameter() {\r\n            return this.type === 'parameter';\r\n        },\r\n        allowsParameterChange() {\r\n            if (this.isParameter) {\r\n                return this.state.editable && !!this.$parent.supports('editParameter');\r\n            }\r\n            else {\r\n                return this.parameters.filter(p => p.isEditable()).length > 0;\r\n            }\r\n        },\r\n        allowsDelete() {\r\n            return (this.state.editable && (!this.spec || (Utils.isObject(this.spec) && this.origin !== 'schema')));\r\n        },\r\n        allowsInfo() {\r\n            if (this.collectionId) {\r\n                return this.$parent.supports('showCollection');\r\n            }\r\n            else if (this.isParameter) {\r\n                return Utils.isObject(this.spec) && this.$parent.supports('showParameter');\r\n            }\r\n            else {\r\n                return this.$parent.supports('showProcess');\r\n            }\r\n        },\r\n        allowsDescription() {\r\n            // ToDo: Remove type restriction and store description for parameters.\r\n            return (this.state.editable && this.type === 'process');\r\n        },\r\n        showId() {\r\n            return (this.type !== 'parameter');\r\n        },\r\n        // Parameters and related\r\n        hasParametersDefined() {\r\n            return Boolean(Utils.isObject(this.spec) && Array.isArray(this.spec.parameters) && this.spec.parameters.length > 0);\r\n        },\r\n        parameters() {\r\n            let names = [];\r\n            let parameters = [];\r\n            if (this.hasParametersDefined) {\r\n                parameters = this.spec.parameters.map(p => new ProcessParameter(p));\r\n                names = parameters.map(p => p.name);\r\n            }\r\n            if (Utils.size(this.args) > 0) {\r\n                for(var key in this.args) {\r\n                    if (!names.includes(key)) {\r\n                        parameters.push(new ProcessParameter({\r\n                            name: key,\r\n                            description: ''\r\n                        }));\r\n                    }\r\n                }\r\n            }\r\n            return parameters;\r\n        },\r\n        fields() {\r\n            var fields = {};\r\n            for(var p of this.parameters) {\r\n                fields[p.name] = p;\r\n            }\r\n            fields.output = this.output;\r\n            return fields;\r\n        },\r\n        output() {\r\n            var spec = {};\r\n            if (Utils.isObject(this.spec)) {\r\n                if (this.isParameter) {\r\n                    spec = this.spec;\r\n                }\r\n                else if (Utils.isObject(this.spec.returns)) {\r\n                    spec = this.spec.returns;\r\n                }\r\n            }\r\n            var output = {\r\n                name: \"output\",\r\n                schema: spec.schema || {},\r\n                description: spec.description || '',\r\n                optional: true,\r\n                output: true,\r\n                value: {}\r\n            };\r\n            if (this.isParameter) {\r\n                output.value.from_parameter = this.id.substr(1);\r\n            }\r\n            else {\r\n                output.value.from_node = this.id.substr(1);\r\n            }\r\n            return output;\r\n        }\r\n    },\r\n    mounted() {\r\n        // ToDo: Move mousemove listener for dragging to Blocks?\r\n        this.draggingFn = this.dragging.bind(this);\r\n        document.addEventListener('mousemove', this.draggingFn);\r\n        // ToDO: Replace with mouseleave?\r\n        this.stopDragFn = this.stopDrag.bind(this);\r\n        document.addEventListener('mouseup', this.stopDragFn);\r\n\r\n        this.$emit('mounted', this);\r\n    },\r\n    beforeDestroy() {\r\n        document.removeEventListener('mousemove', this.draggingFn);\r\n        document.removeEventListener('mouseup', this.stopDragFn);\r\n\r\n        this.$emit('unmounted', this);\r\n    },\r\n    methods: {\r\n        edit() {\r\n            if (this.isParameter) {\r\n                this.editParameter();\r\n            }\r\n            else {\r\n                this.showArguments();\r\n            }\r\n        },\r\n        hasParameter(name) {\r\n            return this.hasParametersDefined && !!this.spec.parameters.find(p => p.name === name);\r\n        },\r\n        updateDescription(event) {\r\n            let value;\r\n            if (typeof event.target.value === 'string' && event.target.value.length > 0) {\r\n                value = event.target.value;\r\n            }\r\n            else {\r\n                value = null;\r\n            }\r\n            this.showDescriptionField = (value !== null);\r\n            if (this.description !== value) {\r\n                this.$emit('update', 'description', value);\r\n            }\r\n        },\r\n        updatePosition(pos, saveHistory = true) {\r\n            pos = Utils.ensurePoint(pos);\r\n            if (this.position[0] !== pos[0] || this.position[1] !== pos[1]) {\r\n                this.$emit('update', 'position', pos, saveHistory);\r\n            }\r\n        },\r\n        updateArguments(value) {\r\n            let removeParameters = Object.keys(this.args)\r\n                    .filter(key => typeof value[key] === 'undefined' && (!this.hasParametersDefined || this.hasParameter(key)));\r\n            // Remove default values\r\n            for(let p of this.parameters) {\r\n                if (typeof value[p.name] !== 'undefined' && p.optional && typeof p.default !== 'undefined' && Utils.equals(p.default, value[p.name]))  {\r\n                    delete value[p.name];\r\n                }\r\n            }\r\n            this.$emit('update', 'arguments', value, removeParameters);\r\n        },\r\n        updateArgument(key, value) {\r\n            let args = Utils.deepClone(this.args);\r\n            args[key] = value;\r\n            this.updateArguments(args);\r\n        },\r\n        updateResult(value) {\r\n            if (this.hasOutputEdges()) {\r\n                this.state.root.$emit(\"error\", \"A result node can't have outgoing edges.\");\r\n                return;\r\n            }\r\n            if (value !== this.result) {\r\n                this.$emit('update', 'result', value);\r\n            }\r\n        },\r\n        focus() {\r\n            this.$parent.focus();\r\n        },\r\n        onMouseDown(event) {\r\n            this.select(!this.selected, !event.shiftKey);\r\n        },\r\n        select(selected = true, unselectOthers = true) {\r\n            this.$emit('update', 'selected', selected, unselectOthers);\r\n            this.focus();\r\n        },\r\n        getDimensions() {\r\n            let dim = this.$parent.domBoundingBox(this.$refs.div);\r\n            var blocksDim = this.$parent.getDimensions();\r\n            dim.x = dim.offsetLeft - blocksDim.offsetLeft;\r\n            dim.y = dim.offsetTop - blocksDim.offsetTop;\r\n            return dim;\r\n        },\r\n        edgesChanged(parameter, edges) {\r\n            parameter.refs = edges.map(edge => edge.parameter1.value);\r\n        },\r\n        editParameter() {\r\n            this.$parent.$emit('editParameter', this.spec, \"Edit Parameter: \" + this.plainTitle, data => this.$emit('update', 'spec', data));\r\n        },\r\n        showArguments(parameterName = null) {\r\n            this.$parent.$emit('editArguments', this.parameters.filter(p => p.isEditable()), this.args, this.plainTitle, this.state.editable, parameterName, data => this.updateArguments(data), this);\r\n        },\r\n        showInfo() {\r\n            if(this.collectionId) {\r\n                this.$parent.$emit('showCollection', this.collectionId);\r\n            }\r\n            else if (this.isParameter) {\r\n                this.$parent.$emit('showParameter', this.spec);\r\n            }\r\n            else {\r\n                this.$parent.$emit('showProcess', this.processId, this.namespace);\r\n            }\r\n        },\r\n        async addDescription() {\r\n            this.select();\r\n            this.showDescriptionField = true;\r\n            await this.$nextTick();\r\n            this.$refs.descriptionField.focus();\r\n        },\r\n        async emitDrag(event) {\r\n            this.select(true, !event.shiftKey);\r\n            this.focus();\r\n            await this.$nextTick();\r\n            this.$emit('move', event);\r\n        },\r\n        getDragPos(pos, mouse) {\r\n            return [mouse[0]/this.state.scale-pos[0], mouse[1]/this.state.scale-pos[1]];\r\n        },\r\n        startDrag(event) {\r\n            if (!this.selected) {\r\n                return;\r\n            }\r\n\r\n            let mousePos = this.$parent.getMousePos(event);\r\n            this.drag = {\r\n                origin: this.position,\r\n                mouse: this.getDragPos(this.position, mousePos)\r\n            };\r\n        },\r\n        stopDrag() {\r\n            if (!this.drag) {\r\n                return;\r\n            }\r\n\r\n            var delta = 5 / this.state.scale; // Only store History if block was moved enough\r\n            if (Math.abs(this.drag.origin[0] - this.position[0]) > delta || Math.abs(this.drag.origin[1] - this.position[1]) > delta) {\r\n                this.updatePosition(this.position);\r\n            }\r\n            this.drag = null;\r\n        },\r\n        dragging(event) {\r\n            if (!this.drag) {\r\n                return;\r\n            }\r\n            \r\n            let mousePos = this.$parent.getMousePos(event);\r\n            let drapPos = this.getDragPos(this.drag.mouse, mousePos);\r\n            // Don't store for each run a history step...\r\n            this.updatePosition(drapPos, false);\r\n        },\r\n\r\n        hasOutputEdges() {\r\n            return this.$refs.output && this.$refs.output.getEdgeCount() > 0;\r\n        },\r\n\r\n        async remove() {\r\n            await this.$parent.removeBlock(this);\r\n        },\r\n\r\n        /**\r\n         * Getting a field by name\r\n         */\r\n        getBlockParameter(name) {\r\n            if (name === 'output' && this.$refs.output) {\r\n                return this.$refs.output;\r\n            }\r\n            else if (Array.isArray(this.$refs.parameters)) {\r\n                var params = this.$refs.parameters.filter(param => param.name === name);\r\n                if (params.length > 0) {\r\n                    return params[0];\r\n                }\r\n            }\r\n            return null;\r\n        },\r\n\r\n        isParameterScoped(parameterName, referenceName) {\r\n            let parameterBlock = this.getBlockParameter(parameterName);\r\n            let cbParams = ProcessUtils.getCallbackParameters(parameterBlock).map(cbParam => cbParam.name);\r\n            return cbParams.includes(referenceName);\r\n        },\r\n\r\n        hiddenParameterRef(parameterBlock) {\r\n            if (this.type !== 'process') {\r\n                return null;\r\n            }\r\n            let globalParam = parameterBlock.id.substr(1);\r\n            for (let argName in this.args) {\r\n                let value = this.args[argName];\r\n                if (Utils.isObject(value) && Utils.isObject(value.process_graph)) {\r\n                    let refs = PgUtils.getRefs(value, true, true);\r\n                    if (refs.find(r => r.from_parameter === globalParam && !this.isParameterScoped(argName, r.from_parameter))) {\r\n                        return argName;\r\n                    }\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n    }\r\n\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.vue-component.model-builder {\r\n    .block {\r\n        position:absolute;\r\n        border:2px solid #ccc;\r\n        margin-left:0px;\r\n        margin-top:0px;\r\n        background-color:#fafafa;\r\n        opacity:0.8;\r\n        font-size:14px;\r\n        user-select:none;\r\n        -moz-user-select:none;\r\n        -khtml-user-select:none;\r\n        -webkit-user-select:none;\r\n        -o-user-select:none;\r\n\r\n        .description {\r\n            display:none;\r\n            width:200px;\r\n            padding:3px;\r\n            border:1px solid #083776;\r\n            border-radius:5px;\r\n            color:#001531;\r\n            background-color:#91bcf6;\r\n            margin-top:15px;\r\n            position:absolute;\r\n            font-weight:normal;\r\n        }\r\n\r\n        .blockTitle {\r\n            display: flex;\r\n            padding: 0.3em 0.1em;\r\n            font-weight:bold;\r\n            background-color:#ddd;\r\n            margin-bottom: 0.1em;\r\n            cursor: move;\r\n            font-size: 0.9em;\r\n            \r\n            .blockId {\r\n                opacity: 0.4;\r\n                margin-left: 0.25em;\r\n                font-weight: normal;\r\n            }\r\n            \r\n            .namespace {\r\n                font-weight: normal;\r\n            }\r\n\r\n            .titleText {\r\n                flex-grow: 1;\r\n                white-space: nowrap;\r\n                overflow: hidden;\r\n                text-overflow: ellipsis;\r\n            }\r\n            \r\n            .blockicon {\r\n                white-space: nowrap;\r\n                text-align: center;\r\n\r\n                i.fas {\r\n                    min-width: 1.4em;\r\n                    cursor: pointer;\r\n                    opacity: 0.5;\r\n                    margin-left: 0.1em;\r\n\r\n                    &:hover {\r\n                        opacity:1.0;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        .invalid {\r\n            color: red;\r\n            cursor: help;\r\n        }\r\n\r\n        .inout {\r\n            display: flex;\r\n        }\r\n\r\n        .inputs {\r\n            flex-grow: 1;\r\n            max-width: 100%;\r\n            overflow: hidden;\r\n            text-overflow: ellipsis;\r\n        }\r\n\r\n        .editDescription {\r\n            padding: 0.3em 0.2em;\r\n            box-sizing: border-box;\r\n            font-size: 0.9em;\r\n            line-height: 1em;\r\n            overflow: auto;\r\n            border: 0;\r\n            border-top: 1px dotted #ccc;\r\n            background-color: transparent;\r\n            width: 100%;\r\n            max-width: 100%;\r\n            height: 3.7em;\r\n            min-height: 2.5em;\r\n            resize: none;\r\n\r\n            &:focus {\r\n                outline: 0;\r\n            }\r\n        }\r\n    }\r\n\r\n    .block_collection {\r\n        border:2px solid #6B8DAF;\r\n\r\n        .blockTitle {\r\n            background-color:#A3B7CC;\r\n        }\r\n        .field_id { /* Hide collection ID as it's shown in the title */\r\n            display: none;\r\n        }\r\n    }\r\n\r\n    .block_result {\r\n        border:2px solid #888;\r\n\r\n        .field_output .circle {\r\n            background-color: #888;\r\n            cursor: auto;\r\n        }\r\n    }\r\n\r\n    .block_argument {\r\n        border:2px solid #B28C6B;\r\n\r\n        .blockTitle {\r\n            background-color:#CCB7A3;\r\n        }\r\n    }\r\n\r\n    .block_selected {\r\n        border:2px solid #0a0 !important; /* important is used to override the styles for block_collection and block_argument above */\r\n\r\n        .blockTitle {\r\n            background-color:#0c0 !important;\r\n        }\r\n    }\r\n\r\n    .block_invalid {\r\n        border:2px solid #ff0000 !important; /* important is used to override the styles for block_selected above */\r\n    }\r\n}\r\n</style>","import mod from \"-!../../../../cache-loader/dist/cjs.js??ref--13-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!./Block.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../cache-loader/dist/cjs.js??ref--13-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!./Block.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Block.vue?vue&type=template&id=be4946b6&\"\nimport script from \"./Block.vue?vue&type=script&lang=js&\"\nexport * from \"./Block.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Block.vue?vue&type=style&index=0&id=be4946b6&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',_vm._l((_vm.lines),function(line,i){return _c('line',_vm._b({key:i},'line',line,false))}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default class Segment {\r\n\r\n    constructor(x, y, dx, dy) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.dx = dx;\r\n        this.dy = dy;\r\n    }\r\n\r\n    /**\r\n     * Distance\r\n     */\r\n    distance(point1, point2) {\r\n        return Math.sqrt(Math.pow(point2.x-point1.x,2) + Math.pow(point2.y-point1.y,2));\r\n    }\r\n\r\n    /**\r\n     * Distance with a point\r\n     */\r\n    distanceP(point) {\r\n        var normal = this.normal();\r\n        normal.x = point.x;\r\n        normal.y = point.y;\r\n        var intersection = this.intersection(normal);\r\n\r\n        return [intersection[0], this.distance(normal.alpha(intersection[1]), point)];\r\n    }\r\n\r\n    /**\r\n     * Normal\r\n     */\r\n    normal() {\r\n        return new Segment(this.x, this.y, this.dy, -this.dx);\r\n    }\r\n\r\n    /**\r\n     * Gets the intersection alpha with another \r\n     */\r\n    intersection(other) {\r\n        var a = this.dx;\r\n        var b = -other.dx;\r\n        var c = this.dy;\r\n        var d = -other.dy;\r\n        var b0 = other.x-this.x;\r\n        var b1 = other.y-this.y;\r\n        var det = a*d - b*c;\r\n\r\n        if (det == 0) {\r\n            return null;\r\n        }\r\n\r\n        var r1 = (d*b0 - b*b1)/det;\r\n        var r2 = (-c*b0 + a*b1)/det;\r\n\r\n        return [r1, r2];\r\n    }\r\n\r\n    /**\r\n     * Gets the alpha point\r\n     */\r\n    alpha(a) {\r\n        var point = {};\r\n        point.x = this.x+this.dx*a;\r\n        point.y = this.y+this.dy*a;\r\n\r\n        return point;\r\n    }\r\n\r\n}","<template>\r\n    <g>\r\n        <line v-for=\"(line, i) in lines\" :key=\"i\" v-bind=\"line\" />\r\n    </g>\r\n</template>\r\n\r\n<script>\r\nimport Segment from './segment.js';\r\n\r\nexport default {\r\n    name: 'Edge',\r\n    props: {\r\n        id: {},\r\n        parameter1: {\r\n            type: Object,\r\n            required: true\r\n        },\r\n        parameter2: {\r\n            type: Object,\r\n            required: true\r\n        },\r\n        selected: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        inactive: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        issues: {\r\n            type: Array,\r\n            default: () => ([])\r\n        },\r\n        lineWidth: {\r\n            type: Number,\r\n            default: 3\r\n        },\r\n        lineColor: {\r\n            type: Array,\r\n            default: () => ([255, 200, 0, 1])\r\n        },\r\n        state: {\r\n            type: Object,\r\n            required: true\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            position1: null,\r\n            position2: null\r\n        }\r\n    },\r\n    computed: {\r\n        segment() {\r\n            return new Segment(\r\n                this.position1[0],\r\n                this.position1[1], \r\n                this.position2[0] - this.position1[0],\r\n                this.position2[1] - this.position1[1]\r\n            );\r\n        },\r\n        scaledLineWidth() {\r\n            return this.lineWidth * this.state.scale;\r\n        },\r\n        lines() {\r\n            // Drawing the arrow\r\n            var xM = ((this.position1[0]+this.position2[0])/2.0);\r\n            var yM = ((this.position1[1]+this.position2[1])/2.0);\r\n\r\n            var alpha = (35*Math.PI/180.0);\r\n            var cos = Math.cos(alpha);\r\n            var sin = Math.sin(alpha);\r\n            var cosB = Math.cos(-alpha);\r\n            var sinB = Math.sin(-alpha);\r\n\r\n            var norm = Math.sqrt(Math.pow(this.position1[0]-this.position2[0],2)+Math.pow(this.position1[1]-this.position2[1],2));\r\n            var arrowLength = this.state.scale*10/(norm/1.5);\r\n            var xA = (this.position1[0]-xM)*arrowLength;\r\n            var yA = (this.position1[1]-yM)*arrowLength;\r\n\r\n            var lineStyle = this.getLineStyle(this.scaledLineWidth, this.selected, this.inactive);\r\n            var arrowStyle = this.getLineStyle(this.scaledLineWidth / 1.5, this.selected);\r\n\r\n            var mainLine = this.getLine(this.position1[0], this.position1[1], this.position2[0], this.position2[1], lineStyle);\r\n            if (this.inactive || norm/this.state.scale < 25) {\r\n                // Hide arrow\r\n                return [mainLine];\r\n            }\r\n            else {\r\n                return [\r\n                    mainLine,\r\n                    this.getLine(xM, yM, xM+(xA*cos-yA*sin), yM+(yA*cos+xA*sin), arrowStyle),\r\n                    this.getLine(xM, yM, xM+(xA*cosB-yA*sinB), yM+(yA*cosB+xA*sinB), arrowStyle)\r\n                ];\r\n            }\r\n        }\r\n    },\r\n    watch: {\r\n        'state.center'() {\r\n            this.updatePositions();\r\n        },\r\n        'state.scale'() {\r\n            this.updatePositions();\r\n        },\r\n        'state.moving'() {\r\n            this.updatePositions();\r\n        }\r\n    },\r\n    created() {\r\n        this.updatePositions();\r\n    },\r\n    mounted() {\r\n        this.$emit('mounted', this);\r\n    },\r\n    beforeDestroy() {\r\n        this.$emit('unmounted', this);\r\n    },\r\n    methods: {\r\n        updatePositions() {\r\n            let pos1 = this.parameter1.getCirclePosition();\r\n            let pos2 = this.parameter2.getCirclePosition();\r\n            if (!pos1 || !pos2) {\r\n                return;\r\n            }\r\n            if (!this.position1 || !this.position2 || pos1[0] !== this.position1[0] || pos1[1] !== this.position1[1] || pos2[0] !== this.position2[0] || pos2[1] !== this.position2[1]) {\r\n                this.position1 = Object.freeze(pos1);\r\n                this.position2 = Object.freeze(pos2);\r\n                this.$emit('position', this.position1, this.position2);\r\n            }\r\n        },\r\n        getLineStyle(lineWidth, selected = false, dashed = false) {\r\n            let dashLength = 2 * this.state.scale;\r\n            let color = this.lineColor;\r\n            if (selected) {\r\n                color = [0, 200, 0, 1];\r\n            }\r\n            else if (this.issues.length > 0) {\r\n                color = [255, 0, 0, 1];\r\n            }\r\n            return {\r\n                'stroke': `rgba(${color.join(', ')})`,\r\n                'stroke-width': lineWidth,\r\n                'stroke-dasharray': dashed ? dashLength * 3 + ' ' + dashLength * 2 : 'none'\r\n            }\r\n        },\r\n        /**\r\n         * Get line options.\r\n         * \r\n         * @param x1 {number} The x-coordinate for the start of the line.\r\n         * @param y1 {number} The y-coordinate for the start of the line.\r\n         * @param x2 {number} The x-coordinate for the end of the line.\r\n         * @param y2 {number} The y-coordinate for the end of the line.\r\n         * @param [settings] {object} Additional settings for this node.\r\n         * @return {object} Options for SVG Line\r\n         */\r\n        getLine(x1, y1, x2, y2, settings = {}) {\r\n            return Object.assign({x1, y1, x2, y2}, settings);\r\n        },\r\n        /**\r\n         * Does the position collide the line ?\r\n         */\r\n        collide(x, y) {\r\n            if (!this.segment) {\r\n                return false;\r\n            }\r\n\r\n            var dp = this.segment.distanceP({x: x, y: y});\r\n\r\n            if (dp[0] >= 0 && dp[0] <= 1) {\r\n                if (dp[1] < (this.lineWidth*this.state.scale)*2) {\r\n                    return dp[0];\r\n                }\r\n            }\r\n\r\n            return false;\r\n        },\r\n        /**\r\n         * Test if this edge is the same than another\r\n         */\r\n        equals(other) {\r\n            if (this.parameter1 == other.parameter1 && this.parameter2 == other.parameter2) {\r\n                return true;\r\n            }\r\n            else if (this.parameter1 == other.parameter2 && this.parameter2 == other.parameter1) {\r\n                return true;\r\n            }\r\n\r\n            return false;\r\n        }\r\n    }\r\n\r\n}\r\n</script>","import mod from \"-!../../../../cache-loader/dist/cjs.js??ref--13-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!./Edge.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../cache-loader/dist/cjs.js??ref--13-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!./Edge.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Edge.vue?vue&type=template&id=83b3fc4e&\"\nimport script from \"./Edge.vue?vue&type=script&lang=js&\"\nexport * from \"./Edge.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n    <div ref=\"div\" :id=\"id\" :class=\"classes\" tabindex=\"0\"\r\n        @mousemove=\"onMouseMove\"\r\n        @mousedown=\"onMouseDown\"\r\n        @wheel=\"onMouseWheel\"\r\n        @keydown=\"onKeyDown\"\r\n        @focus=\"hasFocus = true\"\r\n        @blur=\"hasFocus = false\">\r\n        <!-- tabindex is to allow focus for delete keystroke etc -->\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" class=\"canvas\">\r\n            <Edge v-for=\"edge in edges\" :key=\"edge.id\" :id=\"edge.id\"\r\n                :parameter1=\"edge.parameter1\" :parameter2=\"edge.parameter2\"\r\n                :selected=\"edge.selected\" :inactive=\"edge.inactive\" :issues=\"edge.issues\" :state=\"state\"\r\n                @mounted=\"node => mount(edge, node)\" @unmounted=\"() => mount(edge)\"\r\n                @position=\"updateEdgePos(edge, arguments)\" />\r\n            <Edge v-for=\"edge in hiddenParameterRefEdges\" :key=\"edge.id\" :id=\"edge.id\"\r\n                :parameter1=\"edge.parameter1\" :parameter2=\"edge.parameter2\"\r\n                @mounted=\"node => mount(edge, node)\" @unmounted=\"() => mount(edge)\"\r\n                :inactive=\"true\" :lineColor=\"[200,200,200,1]\" :lineWidth=\"2\" :state=\"state\" />\r\n            <line v-if=\"linkingLine\" v-bind=\"linkingLine\" />\r\n            <rect v-if=\"selectRect\" v-bind=\"selectRect\" />\r\n        </svg>\r\n        <div class=\"blocks\">\r\n            <Block v-for=\"(block) in blocks\" :key=\"block.id\"\r\n                :id=\"block.id\" :type=\"block.type\" :spec=\"block.spec\" :state=\"state\"\r\n                :selected=\"block.selected\" :position=\"block.position\" :origin=\"block.origin\"\r\n                :process_id=\"block.process_id\" :namespace=\"block.namespace\" :result=\"block.result\" :args=\"block.arguments\" :description=\"block.description\" \r\n                @update=\"(...args) => updateBlock(block, ...args)\"\r\n                @mounted=\"node => mount(block, node)\" @unmounted=\"() => mount(block)\"\r\n                @move=\"startDragBlock\" />\r\n        </div>\r\n        <div v-if=\"state.scale < 0.7 || showZoomInfo\" class=\"zoomInfo\">\r\n            <div v-if=\"state.scale < 0.7\">\r\n                Zoom in for more details.\r\n            </div>\r\n            <div v-if=\"showZoomInfo\">\r\n                Zoom with <kbd>STRG</kbd> or <kbd>Meta</kbd> key and the mouse wheel.\r\n            </div>\r\n        </div>\r\n        <ParameterViewer v-if=\"parameterViewer\" v-bind=\"parameterViewer\" @close=\"parameterViewer = null\" />\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport Block from './model-builder/Block.vue';\r\nimport Edge from './model-builder/Edge.vue';\r\nimport Utils from '../utils.js';\r\nimport { ProcessRegistry } from '@openeo/js-commons';\r\nimport { JsonSchemaValidator, ProcessGraph, Utils as PgUtils } from '@openeo/js-processgraphs';\r\nimport Vue from 'vue';\r\nimport boxIntersectsBox from 'intersects/box-box';\r\nimport boxIntersectsLine from 'intersects/box-line';\r\nimport Config from './model-builder/config.js';\r\n\r\nconst getDefaultState = function(blocks) {\r\n    return Vue.observable({\r\n        root: blocks,\r\n        editable: false,\r\n        compactMode: false,\r\n        moving: null, // Is the user dragging the view?\r\n        selecting: null, // Is the user multi-selecting?\r\n        center: [0,0],\r\n        mouse: [0,0],\r\n        scale: Config.defaultScale,\r\n        linkFrom: null, // Array\r\n        linkTo: null // Array\r\n    });\r\n};\r\nconst MARGIN = 20;\r\n\r\nconst selectionChangeWatcher = function (newVal, oldVal) {\r\n    if (!Array.isArray(newVal) || !Array.isArray(oldVal) || newVal.length !== oldVal.length || !newVal.every((value,i) => value.id === oldVal[i].id)) {\r\n        this.$emit('selectionChanged', this.selectedBlocks, this.selectedEdges);\r\n    }\r\n};\r\n\r\nexport default {\r\n    name: 'ModelBuilder',\r\n    components: {\r\n        Block,\r\n        Edge,\r\n        ParameterViewer: () => import('./model-builder/ParameterViewer.vue')\r\n    },\r\n    props: {\r\n        id: {\r\n            type: String,\r\n            required: true\r\n        },\r\n        editable: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        value: {\r\n            type: Object,\r\n            default: () => ({})\r\n        },\r\n        collections: {\r\n            type: Array,\r\n            default: () => []\r\n        },\r\n        processes: {\r\n            type: [Array, Object],\r\n            default: () => []\r\n        },\r\n\t\tparent: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: null\r\n\t\t},\r\n\t\tparentSchema: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: null\r\n\t\t},\r\n        historySize: {\r\n            type: Number,\r\n            default: 30\r\n        },\r\n        explicitZoom: {\r\n            type: Boolean,\r\n            default: false\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            isMounted: false,\r\n            allMounted: false,\r\n\r\n            // Current offset for block that are generated without specific coordinates so that not all block occur on the same position\r\n            newBlockOffset: 0,\r\n\r\n            // History\r\n            history: [],\r\n            historyPointer: null,\r\n\r\n            process: Object.freeze(this.value),\r\n            // Metadata for blocks to show\r\n            blocks: [],\r\n            // Metadata for edges to show\r\n            edges: [],\r\n            hiddenParameterRefEdges: {},\r\n\r\n            processGraph: null,\r\n\r\n            // Next block id\r\n            nextBlockId: 1,\r\n            // Next edge id\r\n            nextEdgeId: 1,\r\n            // Copy&Paste\r\n            clipboard: null,\r\n\r\n            activeTransactions: 0,\r\n            hasFocus: false,\r\n            linkingLine: null,\r\n            parameterViewer: null,\r\n\r\n            showZoomInfo: this.explicitZoom,\r\n            \r\n            // State specific to this blocks instance including all children\r\n            state: getDefaultState(this)\r\n        };\r\n    },\r\n    computed: {\r\n        classes() {\r\n            let classes = [\r\n                'vue-component',\r\n                'model-builder'\r\n            ];\r\n            if (this.hasFocus) {\r\n                classes.push('focus');\r\n            }\r\n            if (this.editable) {\r\n                classes.push('editable');\r\n            }\r\n\r\n            if (this.state.compactMode) {\r\n                classes.push('compact');\r\n            }\r\n\r\n            if (this.state.scale < 0.5) {\r\n                classes.push('scale_xs');\r\n            }\r\n            else if (this.state.scale < 0.7) {\r\n                classes.push('scale_s');\r\n            }\r\n            else if (this.state.scale < 0.9) {\r\n                classes.push('scale_m');\r\n            }\r\n            else if (this.state.scale < 1.1) {\r\n                classes.push('scale_l');\r\n            }\r\n            else {\r\n                classes.push('scale_xl');\r\n            }\r\n\r\n            return classes;\r\n        },\r\n        selectRect() {\r\n            if (!this.state.selecting) {\r\n                return null;\r\n            }\r\n            return {\r\n                x: Math.min(this.state.selecting.current[0], this.state.selecting.start[0]),\r\n                y: Math.min(this.state.selecting.current[1], this.state.selecting.start[1]),\r\n                width: Math.abs(this.state.selecting.current[0] - this.state.selecting.start[0]),\r\n                height: Math.abs(this.state.selecting.current[1] - this.state.selecting.start[1]),\r\n                'stroke': 'rgba(0,0,0,0.8)',\r\n                'stroke-width': 1,\r\n                'fill': 'rgba(0,0,0,0.05)'\r\n            };\r\n        },\r\n        processRegistry() {\r\n            // If I link between openeo-web-editor and openeo-vue-components, instanceof ProcessRegistry fails.\r\n            // Webpack seems to mangle names and thus I need to check for specific processes alternatively to detect whether this could be a ProcessRegistry.\r\n            if (this.processes instanceof ProcessRegistry || (typeof this.processes.count === 'function' && typeof this.processes.get === 'function')) {\r\n                return this.processes;\r\n            }\r\n            else if (Array.isArray(this.processes)) {\r\n                return new ProcessRegistry(this.processes);\r\n            }\r\n            else {\r\n                throw new Error('Invalid processes specified, must be ProcessRegistry or Array');\r\n            }\r\n        },\r\n        hasProcesses() {\r\n            return this.processRegistry.count() > 0;\r\n        },\r\n        processBlocks() {\r\n            return this.blocks.filter(b => b.type === 'process');\r\n        },\r\n        selectedBlocks() {\r\n            return this.blocks.filter(block => block.selected);\r\n        },\r\n        selectedEdges() {\r\n            return this.edges.filter(edge => edge.selected);\r\n        },\r\n        selectedSideEdge() {\r\n            if (this.selectedEdges.length === 1 && this.selectedEdges[0].selectedParameter) {\r\n                return this.selectedEdges[0];\r\n            }\r\n            return null;\r\n        },\r\n        hasSelection() {\r\n            return this.selectedBlocks.length > 0 || this.selectedEdges.length > 0;\r\n        },\r\n        processParametersFromSchemas() {\r\n            // Get all process parameters from the parent process\r\n            // this.parent.$parent => ModelBuilder instance\r\n\t\t\tlet parentParams = [];\r\n\t\t\tif (this.parent && this.parent.$parent && typeof this.parent.$parent.getPgParameters === 'function') {\r\n\t\t\t\tparentParams = this.parent.$parent.getPgParameters().map(block => block.spec);\r\n\t\t\t}\r\n\r\n            let callbackParams = [];\r\n            // If we have a parameter schema given, go through the parameter schema and get the available process parameters from there.\r\n            if (this.parentSchema) {\r\n\t\t\t    callbackParams = this.parentSchema.getCallbackParameters();\r\n            }\r\n\r\n            // Remove all parameters from the parent that are overridden by the more specific parameters.\r\n            let filteredParentParams = parentParams.filter(p1 => !callbackParams.find(p2 => p1.name === p2.name));\r\n            // Add the filtered parameters from the parent to the more specific parameters\r\n            return callbackParams.concat(filteredParentParams);\r\n        }\r\n    },\r\n    watch: {\r\n        parentSchema() {\r\n            this.importPgParameters(this.processParametersFromSchemas, 'schema');\r\n        },\r\n        async value(value) {\r\n            // Only run if component has been mounted\r\n            if (!this.allMounted) {\r\n                return;\r\n            }\r\n\r\n            // Only import when user changes data (i.e. not a BlocksProcess exported from export())\r\n            if (!(value instanceof BlocksProcess)) {\r\n                this.process = value;\r\n                await this.import(value, { propagate: false, undoOnError: false }); // don't propagate, otherwise results in an infinite loop\r\n            }\r\n        },\r\n        editable: {\r\n            immediate: true,\r\n            handler(editable) {\r\n                this.state.editable = editable;\r\n            }\r\n        },\r\n        selectedEdges: selectionChangeWatcher,\r\n        selectedBlocks: selectionChangeWatcher,\r\n        allMounted() {\r\n            this.updateHiddenParameterRefEdges();\r\n        },\r\n        isMounted() {\r\n            this.checkAllMounted();\r\n        }\r\n    },\r\n\tbeforeCreate() {\r\n\t\tUtils.enableHtmlProps(this);\r\n\t},\r\n    async created() {\r\n        if (!this.supports('error')) {\r\n            // Print error to console if event is not supported by implementing context\r\n            this.$on('error', (msg, title = null) => console.error(msg, title));\r\n        }\r\n        if (!this.supports('editArguments')) {\r\n            this.$on('editArguments', (...args) => this.showParameterViewer(...args));\r\n        }\r\n    },\r\n    async mounted() {\r\n        Utils.loadFontAwesome(this);\r\n\r\n        // Setting up default viewer center\r\n        this.moveCenter(0, 0, true);\r\n\r\n        // ToDo: Replace with mouseleave?\r\n        this.onDocumentMouseUpFn = this.onDocumentMouseUp.bind(this)\r\n        document.addEventListener('mouseup', this.onDocumentMouseUpFn);\r\n\r\n        await this.importPgParameters(this.processParametersFromSchemas, 'schema');\r\n        if (!await this.import(this.value, { propagate: false, undoOnError: false })) {\r\n            this.perfectScale();\r\n        }\r\n        selectionChangeWatcher.bind(this)();\r\n\r\n        this.isMounted = true;\r\n    },\r\n    beforeDestroy() {\r\n        document.removeEventListener('mouseup', this.onDocumentMouseUpFn);\r\n    },\r\n    methods: {\r\n        updateEdgePos(edge, pos) {\r\n            edge.position1 = pos[0];\r\n            edge.position2 = pos[1];\r\n        },\r\n        mount(elem, node = null) {\r\n            elem.$el = node;\r\n            this.checkAllMounted();\r\n        },\r\n        checkAllMounted() {\r\n            if (!this.isMounted) {\r\n                this.allMounted = false;\r\n            }\r\n            else {\r\n                this.allMounted = !this.blocks.find(block => !block.$el) || !this.edges.find(edge => !edge.$el);\r\n            }\r\n        },\r\n        updateBlockArguments(block, args, removedParams) {\r\n            if (removedParams.length > 0) {\r\n                this.parameterRemoved(block, removedParams);\r\n            }\r\n            this.$set(block, 'arguments', args);\r\n            this.commit();\r\n            if(removedParams.length > 0) {\r\n                this.$nextTick(() => this.refreshEdges());\r\n            }\r\n        },\r\n        updateBlockDescription(block, description) {\r\n            this.$set(block, 'description', description);\r\n            this.commit();\r\n        },\r\n        updateBlockPos(block, pos, saveHistory = true) {\r\n            this.$set(block, 'position', pos);\r\n            this.commit(null, saveHistory, false);\r\n        },\r\n        updateBlockResult(block, result) {\r\n            this.$set(block, 'result', result);\r\n            this.commit();\r\n        },\r\n        updateBlockSelected(block, selected, unselectOthers = true) {\r\n            if (unselectOthers) {\r\n                this.unselectAll();\r\n            }\r\n            this.$set(block, 'selected', selected);\r\n            this.commit(null, false, false);\r\n        },\r\n        updateBlockSpec(block, data) {\r\n            let parameterFields = ['name', 'schema', 'description', 'optional', 'deprecated', 'experimental', 'default'];\r\n            let newBlock = Utils.omitFromObject(block.spec, parameterFields);\r\n            Object.assign(newBlock, data);\r\n            // Remove default values (and unset default value if parameter is required)\r\n            if (!newBlock.optional) {\r\n                delete newBlock.optional;\r\n                delete newBlock.default;\r\n            }\r\n            if (!newBlock.deprecated) {\r\n                delete newBlock.deprecated;\r\n            }\r\n            if (!newBlock.experimental) {\r\n                delete newBlock.experimental;\r\n            }\r\n            this.$set(block, 'spec', newBlock);\r\n            this.commit();\r\n        },\r\n        updateBlock(block, key, value, extra) {\r\n            switch(key) {\r\n                case 'arguments':\r\n                    this.updateBlockArguments(block, value, extra);\r\n                    break;\r\n                case 'description':\r\n                    this.updateBlockDescription(block, value);\r\n                    break;\r\n                case 'position':\r\n                    this.updateBlockPos(block, value, extra);\r\n                    break;\r\n                case 'result':\r\n                    this.setResultNode(block, value);\r\n                    break;\r\n                case 'selected':\r\n                    this.updateBlockSelected(block, value, extra);\r\n                    break;\r\n                case 'spec':\r\n                    this.updateBlockSpec(block, value);\r\n                    break;\r\n            }\r\n        },\r\n        updateHiddenParameterRefEdges() {\r\n            // We can only reliably detect parameter refs if we know which parameters a process makes available to the child process\r\n            // So if we don't have process schemas, don't offer this functionality.\r\n            // Also don't execute (yet) if no parameters are given or not all elements are mounted yet.\r\n            if (!this.hasProcesses || !this.allMounted || !this.blocks.find(block => block.type === 'parameter')) {\r\n                this.hiddenParameterRefEdges = {};\r\n                return;\r\n            }\r\n\r\n            let hiddenRefs = {};\r\n            for(let process of this.processBlocks) {\r\n                for (let argName in process.arguments) {\r\n                    let value = process.arguments[argName];\r\n                    if (!Utils.isObject(value) || !Utils.isObject(value.process_graph)) {\r\n                        continue; // Process can only have hidden refs it it contains a process graph\r\n                    }\r\n                    \r\n                    let refs = PgUtils.getRefs(value, true, true).filter(ref => typeof ref.from_parameter !== 'undefined');\r\n                    for(let ref of refs) {\r\n                        try {\r\n                            if (process.$el.isParameterScoped(argName, ref.from_parameter)) {\r\n                                continue; // Skip if the parameter usage is scoped (i.e. defined as process parameetr for the children)\r\n                            }\r\n                            let parameter = this.getPgParameterById('$' + ref.from_parameter);\r\n                            if (!parameter) {\r\n                                continue; // Skip if parameter can't be found\r\n                            }\r\n                            let parameter1 = parameter.$el.getBlockParameter('output');\r\n                            let parameter2 = process.$el.getBlockParameter(argName);\r\n                            let id = `${parameter.id}->${process.id}:${argName}`;\r\n                            if (parameter1 && parameter2) {\r\n                                if (this.hiddenParameterRefEdges[id]) {\r\n                                    hiddenRefs[id] = this.hiddenParameterRefEdges[id];\r\n                                }\r\n                                else {\r\n                                    hiddenRefs[id] = {\r\n                                        $el: null,\r\n                                        id,\r\n                                        parameter1,\r\n                                        parameter2\r\n                                    };\r\n                                }\r\n                            }\r\n                        } catch(error) {\r\n                             console.warn(error);\r\n                        }\r\n                    }\r\n                }\r\n\r\n            }\r\n            this.hiddenParameterRefEdges = hiddenRefs;\r\n        },\r\n        parameterRemoved(block, parameterNames) {\r\n            for(let edge of this.edges.slice(0)) {\r\n                if(edge.parameter2.$parent.id === block.id && parameterNames.includes(edge.parameter2.name)) {\r\n                    this.removeEdge(edge);\r\n                }\r\n            }\r\n        },\r\n        startDragBlock(event) {\r\n            for(let block of this.blocks) {\r\n                if (block.$el) {\r\n                    block.$el.startDrag(event);\r\n                }\r\n            }\r\n        },\r\n        refreshEdges() {\r\n            this.refreshEdgesFor(this.edges);\r\n            this.refreshEdgesFor(Object.values(this.hiddenParameterRefEdges));\r\n        },\r\n        refreshEdgesFor(edges) {\r\n            for(let edge of edges) {\r\n                if (edge.$el) {\r\n                    edge.$el.updatePositions();\r\n                }\r\n            }\r\n        },\r\n        supports(event) {\r\n            return Boolean(this.$listeners && this.$listeners[event]);\r\n        },\r\n        focus() {\r\n            this.$refs.div.focus();\r\n        },\r\n        link(parameter) {\r\n            if (this.state.linkFrom) {\r\n                this.state.linkTo = parameter;\r\n            }\r\n            else {\r\n                this.state.linkFrom = parameter;\r\n            }\r\n        },\r\n        unlink(parameter = null) {\r\n            if (parameter) {\r\n                if (this.state.linkTo == parameter) {\r\n                    this.state.linkTo = null;\r\n                }\r\n                else if (this.state.linkFrom == parameter) {\r\n                    this.state.linkFrom = null;\r\n                    this.linkingLine = null;\r\n                }\r\n            }\r\n            else {\r\n                this.state.linkTo = null;\r\n                this.state.linkFrom = null;\r\n                this.linkingLine = null;\r\n            }\r\n        },\r\n        multiSelect() {\r\n            let box = this.selectRect;\r\n            this.blocks\r\n                .filter(b => {\r\n                    if (Array.isArray(b.position) && b.$el) {\r\n                        let pos = b.$el.getDimensions();\r\n                        return boxIntersectsBox(box.x, box.y, box.width, box.height, pos.x, pos.y, pos.width, pos.height);\r\n                    }\r\n                    return false;\r\n                })\r\n                .map(b => b.selected = true);\r\n            this.edges\r\n                .filter(e => Array.isArray(e.position1) && Array.isArray(e.position2) && boxIntersectsLine(box.x, box.y, box.width, box.height, e.position1[0], e.position1[1], e.position2[0], e.position2[1]))\r\n                .map(e => e.selected = true);\r\n        },\r\n        toJSON() {\r\n            let process = this.export();\r\n            return JSON.stringify(process, null, 2);\r\n        },\r\n        async onDocumentMouseUp(event) {\r\n            if (this.parameterViewer) {\r\n                return;\r\n            }\r\n            if (this.selectedSideEdge) {\r\n                this.selectEdge(this.selectedSideEdge, null); // Reset selectedParameter, but don't change selected state.\r\n            }\r\n            if (this.state.selecting) {\r\n                this.multiSelect();\r\n                this.state.selecting = null;\r\n            }\r\n            if (this.state.moving) {\r\n                this.state.moving = null;\r\n            }\r\n            if (this.state.editable && this.state.linkFrom) {\r\n                if (event.which == 1 && this.state.linkTo) {\r\n                    try {\r\n                        await this.addEdge(this.state.linkFrom, this.state.linkTo);\r\n                    } catch (error) {\r\n                        this.$emit(\"error\", error);\r\n                    }\r\n                }\r\n                this.unlink();\r\n            }\r\n        },\r\n        async onKeyDown(event) {\r\n            if (this.parameterViewer) {\r\n                return;\r\n            }\r\n            var allInputs = document.querySelectorAll('input, textarea, button, select, datalist');\r\n            for(let el of allInputs) {\r\n                if (el === document.activeElement) {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            let captured = false;\r\n            if (this.state.editable) {\r\n                // delete selected blocks/edges\r\n                if (event.code === 'Delete') {\r\n                    this.deleteSelected();\r\n                    captured = true;\r\n                }\r\n                else if (event.ctrlKey || event.metaKey) { // STRG for Win/Linux, meta/cmd from Mac\r\n                    if (event.code === 'KeyV') {\r\n                        if (this.hasSelection && this.clipboard) {\r\n                            return; // ToDo: Implement pasting for selected blocks\r\n                        }\r\n                        else {\r\n                            try {\r\n                                const text = await navigator.clipboard.readText();\r\n                                let process = JSON.parse(text);\r\n                                await this.import(process);\r\n                            } catch(error) {\r\n                                this.$emit('error', error, 'Paste Error');\r\n                            }\r\n                        }\r\n                        captured = true;\r\n                    }\r\n                    else if (event.code === 'KeyC') {\r\n                        if (this.hasSelection) {\r\n                            this.clipboard = {\r\n                                blocks: this.selectedBlocks.slice(0),\r\n                                edges: this.selectedEdges.slice(0)\r\n                            };\r\n                        }\r\n                        else {\r\n                            try {\r\n                                let json = this.toJSON();\r\n                                await navigator.clipboard.writeText(json);\r\n                                captured = true;\r\n                            } catch(error) {\r\n                                this.$emit('error', error, 'Copy Error');\r\n                            }\r\n                        }\r\n                        captured = true;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (captured) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n            }\r\n        },\r\n        onMouseWheel(event) {\r\n            if (this.parameterViewer) {\r\n                return;\r\n            }\r\n            if (!this.explicitZoom || this.hasFocus || event.ctrlKey || event.metaKey) { // STRG for Win/Linux, meta/cmd for Mac\r\n                let mouse = this.getMousePos(event);\r\n                var dX = mouse[0] - this.state.center[0];\r\n                var dY = mouse[1] - this.state.center[1];\r\n                var deltaScale = Math.pow(1.1, Math.sign(event.deltaY)*-1);\r\n                this.moveCenter(-dX*(deltaScale-1), -dY*(deltaScale-1));\r\n                this.state.scale *= deltaScale;\r\n                event.preventDefault();\r\n                this.showZoomInfo = false;\r\n            }\r\n        },\r\n        domBoundingBox(el) {\r\n            var rect = el.getBoundingClientRect();\r\n            rect.offsetTop = rect.top + Math.max(document.documentElement.scrollTop, document.body.scrollTop);\r\n            rect.offsetLeft = rect.left + Math.max(document.documentElement.scrollLeft, document.body.scrollLeft);\r\n            return rect;\r\n        },\r\n        getMousePos(event) {\r\n            let root = this.$refs.div.getBoundingClientRect();\r\n            return [\r\n                event.clientX - root.left,\r\n                event.clientY - root.top\r\n            ];\r\n        },\r\n        onMouseMove(event) {\r\n            if (this.parameterViewer) {\r\n                return;\r\n            }\r\n            try {\r\n                let mousePos = this.getMousePos(event);\r\n\r\n                if (this.state.editable && this.selectedSideEdge) {\r\n                    var origin = this.selectedSideEdge.selectedParameter.getCirclePosition();\r\n                    if (origin) {\r\n                        var distance = Math.sqrt(Math.pow(mousePos[0]-origin[0], 2)+Math.pow(mousePos[1]-origin[1], 2));\r\n                        if (distance > 10) {\r\n                            this.link(this.selectedSideEdge.selectedParameter);\r\n                            this.removeEdge(this.selectedSideEdge);\r\n                            this.commit();\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (this.state.selecting) {\r\n                    this.state.selecting.current = mousePos;\r\n                }\r\n\r\n                if (this.state.moving) {\r\n                    this.moveCenter((mousePos[0]-this.state.moving[0]), (mousePos[1]-this.state.moving[1]));\r\n                    this.state.moving = mousePos;\r\n                }\r\n\r\n                if (this.state.linkFrom) {\r\n                    var position = this.state.linkFrom.getCirclePosition();\r\n                    if (position) {\r\n                        this.linkingLine = {\r\n                            x1: position[0],\r\n                            y1: position[1],\r\n                            x2: mousePos[0],\r\n                            y2: mousePos[1],\r\n                            'stroke': 'rgba(0,0,0,0.4)',\r\n                            'stroke-width': 3 * this.state.scale\r\n                        };\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                this.$emit(\"error\", error);\r\n            }\r\n        },\r\n        onMouseDown(event) {\r\n            if (this.parameterViewer) {\r\n                return;\r\n            }\r\n            let sideSelected = null;\r\n            let mousePos = this.getMousePos(event);\r\n\r\n            if (event.which == 1) {\r\n                if (event.shiftKey) {\r\n                    // Start multi select via box\r\n                    this.state.selecting = {\r\n                        start: mousePos,\r\n                        current: mousePos\r\n                    }\r\n                }\r\n                else {\r\n                    // No multiselect: unselect all\r\n                    this.unselectAll();\r\n                }\r\n\r\n                // Select edges\r\n                for (var edge of this.edges) {\r\n                    if (!edge.$el) {\r\n                        continue;\r\n                    }\r\n                    var collide = edge.$el.collide(mousePos[0], mousePos[1]);\r\n                    if (collide != false) {\r\n                        if (this.selectedEdges.length === 0 && !event.shiftKey) {\r\n                            if (collide < 0.3) {\r\n                                sideSelected = edge.parameter2;\r\n                            }\r\n                            else if (collide > 0.7) {\r\n                                sideSelected = edge.parameter1;\r\n                            }\r\n                        }\r\n                        this.selectEdge(edge, true, sideSelected);\r\n                        if (edge.issues.length > 0) {\r\n                            for(let issue of edge.issues) {\r\n                                this.$emit('error', issue);\r\n                            }\r\n                        }\r\n                        event.preventDefault();\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (event.which == 2 || (event.which == 1 && !sideSelected && !event.shiftKey)) {\r\n                this.state.moving = mousePos;\r\n            }\r\n\r\n            this.focus();\r\n        },\r\n\r\n        getDimensions() {\r\n            return this.domBoundingBox(this.$refs.div);\r\n        },\r\n\r\n        async clear() {\r\n            return await this.startTransaction(async () => {\r\n                this.edges = [];\r\n                // Don't remove parameters injected by props (fixed callback parameters)\r\n                this.blocks = this.blocks.filter(b => b.type === 'parameter' && Utils.isObject(b.spec) && b.origin === 'schema');\r\n                this.nextBlockId = 1;\r\n                this.nextEdgeId = 1;\r\n                this.process = {};\r\n                this.updateHiddenParameterRefEdges();\r\n                return true;\r\n            });\r\n        },\r\n\r\n        commit(data = null, history = true, propagate = true) {\r\n            // Don't commit when in a transaction\r\n            if (this.activeTransactions > 0) {\r\n                return;\r\n            }\r\n\r\n            if (history !== false) {\r\n                this.saveHistory();\r\n            }\r\n            if (propagate !== false) {\r\n                this.$emit('input', data === null ? this.export() : data);\r\n                this.updateHiddenParameterRefEdges();\r\n            }\r\n            else {\r\n                this.refreshEdges();\r\n            }\r\n        },\r\n    \r\n        /**\r\n         * Save the current situation to the history\r\n         */\r\n        saveHistory() {\r\n            var data = this.export(true);\r\n            this.history.splice(this.historyPointer + 1, this.historySize, Object.freeze(data));\r\n            if (this.history.length > this.historySize) {\r\n                this.history.shift();\r\n            }\r\n            this.historyPointer = this.history.length - 1;\r\n            this.$emit('historyChanged', this.history, this.historyPointer);\r\n        },\r\n        async undo() {\r\n            await this.historyStep(-1);\r\n        },\r\n        async redo() {\r\n            await this.historyStep(1);\r\n        },\r\n        async historyStep(step) {\r\n            var index = this.historyPointer + step;\r\n            var element = this.history[index];\r\n            if (element) {\r\n                this.historyPointer = index;\r\n                this.import(element, { saveHistory: false, undoOnError: false, perfectScale: false });\r\n                this.$emit('historyChanged', this.history, this.historyPointer);\r\n            }\r\n        },\r\n\r\n        setResultNode(block, result = true) {\r\n            block = this.getBlockById(block.id);\r\n            if (!block || block.result === result) {\r\n                return; // Nothing to change\r\n            }\r\n\r\n            this.updateBlockResult(block, result);\r\n            var foundNewResultNode = false;\r\n            var hasOtherBlocks = false;\r\n            for(var other of this.processBlocks) {\r\n                if (block && other.id === block.id) {\r\n                    continue;\r\n                }\r\n                \r\n                hasOtherBlocks = true;\r\n                // If we set a new result node, ensure that only that node is a result node and no other.\r\n                if (result) {\r\n                    this.updateBlockResult(other, false);\r\n                }\r\n                // Find a potential result node if we don't want this to be the result node\r\n                else {\r\n                    if (other.$el && !other.$el.hasOutputEdges()) {\r\n                        this.updateBlockResult(other, true);\r\n                        foundNewResultNode = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            // If we have no new potential result node, communicate to the user.\r\n            if (hasOtherBlocks && !result && !foundNewResultNode) {\r\n                this.$emit(\"error\", \"No result node available, please specify one.\");\r\n            }\r\n        },\r\n\r\n        getPositionForPageXY(x, y) {\r\n            var rect = this.getDimensions();\r\n            if (x !== null) {\r\n                x = (x - rect.offsetLeft - this.state.center[0]) / this.state.scale;\r\n            }\r\n            if (y !== null) {\r\n                y = (y - rect.offsetTop - this.state.center[1]) / this.state.scale;\r\n            }\r\n            return [x, y];\r\n        },\r\n\r\n        addProcess(process_id, args = {}, position = [], namespace = null) {\r\n            return this.addBlock({\r\n                process_id,\r\n                namespace,\r\n                arguments: args,\r\n                position\r\n            });\r\n        },\r\n\r\n        addBlock(node, id = null) {\r\n            let num = String(this.incrementId(id));\r\n            if (id === null && Utils.hasText(node.process_id)) {\r\n                id = node.process_id.replace(/^([a-z]*).*$/i, \"$1\") + num;\r\n                if (this.getBlockById('#' + id)) {\r\n                    id = num;\r\n                }\r\n            }\r\n            else {\r\n                id = num;\r\n            }\r\n            if (typeof node.toJSON === 'function') {\r\n                node = node.toJSON();\r\n            }\r\n            var block = {\r\n                id: '#' + id,\r\n                type: 'process',\r\n                selected: false,\r\n                position: node.position,\r\n                process_id: node.process_id,\r\n                namespace: node.namespace,\r\n                arguments: node.arguments,\r\n                description: node.description || null,\r\n                result: node.result || false\r\n            };\r\n            if (this.processRegistry) {\r\n                block.spec = this.processRegistry.get(node.process_id, node.namespace);\r\n            }\r\n\r\n            var size = this.getBlockSize(block);\r\n            block.position = Utils.ensurePoint(block.position, () => this.getNewBlockDefaultPosition(size));\r\n\r\n            // If there's already a result node, remove the flag here\r\n            if (block.result && this.blocks.filter(b => b.result === true).length) {\r\n                delete block.result;\r\n            }\r\n            // Make this the result node if there's no node yet\r\n            else if (this.processBlocks.length === 0) {\r\n                block.result = true;\r\n            }\r\n            \r\n            this.blocks.push(Vue.observable(block));\r\n            this.commit();\r\n            return block;\r\n        },\r\n\r\n        getNewBlockDefaultPosition(blockSize) {\r\n            var rect = this.getDimensions();\r\n            var position = [\r\n                (-this.state.center[0] + rect.width/2)/this.state.scale - blockSize[0]/2 + this.newBlockOffset,\r\n                (-this.state.center[1] + rect.height/2)/this.state.scale - blockSize[1]/2 + this.newBlockOffset\r\n            ];\r\n            if (this.newBlockOffset < 150) {\r\n                this.newBlockOffset += 10;\r\n            }\r\n            return position;\r\n        },\r\n\r\n        getBlockSize(block) {\r\n            if (block.$el) {\r\n                let dim = block.$el.getDimensions();\r\n                return [dim.width / this.state.scale, dim.height / this.state.scale];\r\n            }\r\n\r\n            let inputs = Math.max(\r\n                Utils.size(block.arguments),\r\n                Utils.isObject(block.spec) ? Utils.size(block.spec.parameters) : 0\r\n            );\r\n\r\n            let size = Config.blockWidth;\r\n            let width;\r\n            if (inputs > 0) {\r\n                width = this.state.compactMode ? size.compactParams : size.normalParams;\r\n            }\r\n            else {\r\n                width = this.state.compactMode ? size.compact : size.normal;\r\n            }\r\n\r\n            let commentHeight = typeof block.description === 'string' ? 40 : 0;\r\n            let height = MARGIN + inputs * 15 + commentHeight;\r\n\r\n            return [width, height];\r\n        },\r\n\r\n        moveCenter(dX, dY, reset = false) {\r\n            var rect = this.getDimensions();\r\n            this.state.center = [\r\n                (reset ? rect.width/2 : this.state.center[0]) + dX,\r\n                (reset ? rect.height/2 : this.state.center[1]) + dY\r\n            ];\r\n            this.newBlockOffset = 0;\r\n        },\r\n\r\n        unselectAll() {\r\n            for(var block of this.blocks) {\r\n                this.updateBlockSelected(block, false, false);\r\n            }\r\n            for(var edge of this.edges) {\r\n                this.selectEdge(edge, false);\r\n            }\r\n        },\r\n\r\n        selectEdge(edge, select = true, parameter = null) {\r\n            if (!Utils.isObject(edge)) {\r\n                edge = this.edges[edge];\r\n            }\r\n            if (edge.selected === select) {\r\n                return false; // Nothing to change\r\n            }\r\n            if (select !== null) {\r\n                this.$set(edge, \"selected\", select);\r\n            }\r\n            this.$set(edge, \"selectedParameter\", parameter);\r\n            return true;\r\n        },\r\n\r\n        /**\r\n         * Edge to remove\r\n         */\r\n        removeEdge(edge) {\r\n            edge.parameter1.eraseEdge(edge);\r\n            edge.parameter2.eraseEdge(edge);\r\n            this.$delete(this.edges, this.edges.indexOf(edge));\r\n        },\r\n            \r\n        /**\r\n         * Remove a block\r\n         */\r\n        async removeBlock(block) {\r\n            // Check if the parameter for this block is used in child processes (callbacks).\r\n            // Then don't delete, but give error instead.\r\n            if (block.type === 'parameter') {\r\n                let param = null;\r\n                let conflictBlock = this.blocks.find(otherBlock => {\r\n                    param = otherBlock.$el.hiddenParameterRef(block);\r\n                    return (param !== null);\r\n                });\r\n                if (conflictBlock) {\r\n                    throw new Error(`Parameter is still used in '${conflictBlock.id}', parameter '${param}'. Only unused parameters can be deleted.`);\r\n                }\r\n            }\r\n\r\n            // now start deleting the block\r\n            return await this.startTransaction(async () => {\r\n                var i = this.blocks.findIndex(b => b.id == block.id);\r\n                if (i < 0) {\r\n                    return false;\r\n                }\r\n\r\n                for (var edge of this.edges.slice(0)) {\r\n                    if (edge.parameter1.$parent.id === block.id || edge.parameter2.$parent.id === block.id) {\r\n                        this.removeEdge(edge);\r\n                    }\r\n                }\r\n\r\n                if (block.result) {\r\n                    this.setResultNode(block, false);\r\n                }\r\n\r\n                this.$delete(this.blocks, i);\r\n                return true;\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Retreive a block by ID\r\n         */\r\n        getBlockById(blockId) {\r\n            var blocks = this.blocks.filter(block => block.id === blockId);\r\n            if (blocks.length > 0) {\r\n                return blocks[0];\r\n            }\r\n            return null;\r\n        },\r\n\r\n        /**\r\n         * Delete the current link\r\n         */\r\n        async deleteSelected() {\r\n            if (!this.hasSelection) {\r\n                return false;\r\n            }\r\n\r\n            return await this.startTransaction(async () => {\r\n                // Remove the selected blocks and its edges\r\n                for(var block of this.selectedBlocks.slice(0)) { // copy to avoid race condition\r\n                    if (block.$el.allowsDelete) {\r\n                        await this.removeBlock(block);\r\n                    }\r\n                }\r\n\r\n                // Removes the selected edges\r\n                for(var edge of this.selectedEdges.slice(0)) { // copy to avoid race condition\r\n                    this.removeEdge(edge);\r\n                }\r\n                return true;\r\n            });\r\n        },\r\n\r\n        async addEdgeByNames(b1, p1, b2, p2) {\r\n            var blocks = [];\r\n            for(var id of [b1, b2]) {\r\n                var block = this.getBlockById(id);\r\n                if (!block) {\r\n                    throw \"Can't find block: \" + id;\r\n                }\r\n                else if (!block.$el) {\r\n                    throw \"Block not mounted yet: \" + id;\r\n                }\r\n                blocks.push(block.$el);\r\n            }\r\n            await this.addEdge(\r\n                blocks[0].getBlockParameter(p1),\r\n                blocks[1].getBlockParameter(p2)\r\n            );\r\n        },\r\n \r\n        async addEdge(p1, p2) {\r\n            if (!p1 || !p2) {\r\n                throw 'One of the parameters is invalid.';\r\n            }\r\n            // Check whether you want to connect the same parameters\r\n            if (p1 == p2) {\r\n                return; // Probably by mistake, don't show an error to not annoy people\r\n            }\r\n            // Check whether you want to connect the block to itself\r\n            if (p1.$parent == p2.$parent) {\r\n                throw 'You can\\'t link a block to itself';\r\n            }\r\n\r\n            var id = this.nextEdgeId++;\r\n            var edge = {id, selected: false, inactive: false, issues: [], $el: null};\r\n            if (p1.output) {\r\n                edge.parameter1 = p1;\r\n                edge.parameter2 = p2;\r\n            }\r\n            else {\r\n                // Reverse the order of in and out\r\n                edge.parameter1 = p2;\r\n                edge.parameter2 = p1;\r\n            }\r\n\r\n            // You have to link an input with an output\r\n            if (edge.parameter1.output === edge.parameter2.output) {\r\n                throw 'You have to link an input with an output';\r\n            }\r\n            // Check for non-recursiveness\r\n            if (this.allSuccessors(edge.parameter1).indexOf(edge.parameter2.id) !== -1) {\r\n                throw 'You can not create a loop';\r\n            }\r\n            // Check whether the data type allows multiple input edges\r\n            if (edge.parameter2.getEdgeCount() > 0 && !edge.parameter2.allowsMultipleInputs) {\r\n                throw 'Parameter accepts only one input';\r\n            }\r\n\r\n            // Check whether the edge exists\r\n            for (var other of this.edges) {\r\n                if (other.$el && other.$el.equals(edge)) {\r\n                    throw 'This connection exists already';\r\n                }\r\n            }\r\n\r\n            // Check type compatibility\r\n            if (!JsonSchemaValidator.isSchemaCompatible(edge.parameter2.schema || {}, edge.parameter1.schema || {}, false, true)) {\r\n                let issue = 'Incoming data type is not compatible for parameter \"' + edge.parameter2.name + '\"';\r\n                edge.issues.push(issue);\r\n                this.$emit('error', issue);\r\n            }\r\n\r\n            return await this.startTransaction(async () => {\r\n                this.unlink();\r\n\r\n                // Create edge\r\n                this.edges.push(Vue.observable(edge));\r\n                edge.parameter1.addEdge(edge);\r\n                edge.parameter2.addEdge(edge);\r\n\r\n                // Update result node\r\n                this.setResultNode(edge.parameter1.$parent, false);\r\n                return true;\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Find all successors of a block, and their successors\r\n         */\r\n        allSuccessors(outputParameter) {\r\n            var block = outputParameter.$parent;\r\n            // Blocks already explored\r\n            var explored = {};\r\n            var exploreList = [block];\r\n            explored[block.id] = true;\r\n        \r\n            while (exploreList.length > 0) {\r\n                var currentBlock = exploreList.pop();\r\n                for (var key in currentBlock.edges) {\r\n                    for (var i in currentBlock.edges[key]) {\r\n                        var edge = currentBlock.edges[key][i];\r\n                        if (edge.block1 == currentBlock) {\r\n                            var target = edge.block2;\r\n                            if (!(target.id in explored)) {\r\n                                explored[target.id] = true;\r\n                                exploreList.push(target);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            return Object.values(explored);\r\n        },\r\n\r\n        /**\r\n         * Changing the compact mode\r\n         */\r\n        async toggleCompact() {\r\n            this.state.compactMode = !this.state.compactMode;\r\n            this.$emit('compactMode', this.state.compactMode);\r\n            await this.$nextTick();\r\n            this.refreshEdges();\r\n        },\r\n\r\n        export(internal = false) {\r\n            let data = {\r\n                process_graph: {}\r\n            };\r\n\r\n            for(let block of this.processBlocks) {\r\n                let keys = ['process_id', 'namespace', 'arguments', 'description', 'result'];\r\n                if (internal) {\r\n                    // Keep internal state for history\r\n                    keys.push('position');\r\n                }\r\n                let copy = Utils.pickFromObject(block, keys);\r\n                // Remove default values for simplicity\r\n                if (copy.description === null) {\r\n                    delete copy.description;\r\n                }\r\n                if (copy.result !== true) {\r\n                    delete copy.result;\r\n                }\r\n                if (!copy.namespace) {\r\n                    delete copy.namespace;\r\n                }\r\n                let nodeId = block.id.substr(1);\r\n                data.process_graph[nodeId] = copy;\r\n            }\r\n\r\n            if (!this.parent) {\r\n                data.parameters = [];\r\n                let parameterBlocks = this.getPgParameters();\r\n                for(let param of parameterBlocks) {\r\n                    data.parameters.push(param.spec);\r\n                }\r\n            }\r\n\r\n            // ToDo: Currently, we just use the id, categories, result value etc from the original process.\r\n            // Implement to allow custom settings from users.\r\n            return new BlocksProcess(Object.assign({}, this.process, data));\r\n        },\r\n\r\n        // Options may contain:\r\n        // - undoOnError: don't undo changes when an error occured (default: true)\r\n        // - saveHistory: commit the changes to the history (default: true)\r\n        // - propagate: emit the changes to the parent v-model (default: true)\r\n        async startTransaction(fn, options = {}, ...args) {\r\n            let success;\r\n            this.activeTransactions++;\r\n\r\n            try {\r\n                success = await fn(args);\r\n            } catch (error) {\r\n                // If an error occured: show it and restore the last working state from history.\r\n                this.$emit('error', error, \"Model is invalid\");\r\n                if (options.undoOnError !== false) {\r\n                    try {\r\n                        await this.undo();\r\n                    } catch (error2) {\r\n                        this.$emit('error', error, \"Revert failed\");\r\n                    }\r\n                }\r\n                success = false;\r\n            }\r\n\r\n            this.activeTransactions--;\r\n            this.commit(null, options.saveHistory, options.propagate);\r\n\r\n            return success;\r\n        },\r\n\r\n        // Options may contain:\r\n        // - all from startTransaction()\r\n        // - clear: Clear the model builder before import (default: true)\r\n        // - perfectScale: Apply perfect scale after import (default: true)\r\n        async import(process, options = {}) {\r\n            return await this.startTransaction(async () => {\r\n                // clear screen...\r\n                if (options.clear !== false) {\r\n                    await this.clear();\r\n                    this.process = process instanceof ProcessGraph ? process.toJSON() : process;\r\n                }\r\n\r\n                if (!Utils.isObject(process)) {\r\n                    return false;\r\n                }\r\n\r\n                // Parse process\r\n                let pg;\r\n                if (process instanceof ProcessGraph) {\r\n                    // Make a copy\r\n                    pg = new ProcessGraph(process.toJSON(), this.processRegistry);\r\n                    pg.setParent(process.parentProcessId, process.parentParameterName);\r\n                }\r\n                else {\r\n                    pg = new ProcessGraph(process, this.processRegistry);\r\n                }\r\n                pg.allowEmpty();\r\n                pg.parse();\r\n                this.processGraph = Object.freeze(pg);\r\n\r\n                await this.importPgParameters(this.processGraph.getProcessParameters(true), 'user', options.clear !== false);\r\n                await this.importNodes(this.processGraph.getStartNodes());\r\n                await this.importEdges(this.processGraph);\r\n\r\n                if (options.perfectScale !== false) {\r\n                    this.perfectScale();\r\n                }\r\n\r\n                this.$nextTick(() => this.updateHiddenParameterRefEdges());\r\n\r\n                return true;\r\n            }, options);\r\n        },\r\n\r\n        async importPgParameters(params, origin, clear = true) {\r\n            if (!Array.isArray(params)) {\r\n                return;\r\n            }\r\n\r\n            let options = {\r\n                undoOnError: false,\r\n                saveHistory: false,\r\n                propagate: false\r\n            };\r\n            return await this.startTransaction(async () => {\r\n                // Remove existing parameters from the given origin\r\n                if (clear) {\r\n                    this.blocks = this.blocks.filter(b => b.type !== 'parameter' || b.origin !== origin);\r\n                }\r\n\r\n                let size = this.getBlockSize({}); // Estimate base size for an empty block\r\n                let position = [0,0];\r\n                for(var i in params) {\r\n                    position = [\r\n                        -size[0] - MARGIN,\r\n                        i * (size[1] + MARGIN)\r\n                    ];\r\n\r\n                    await this.addPgParameter(params[i], origin, position);\r\n                }\r\n            }, options);\r\n        },\r\n\r\n        async addPgParameter(param, origin = 'user', position = null) {\r\n            return await this.startTransaction(async () => {\r\n                let id = '$' + param.name;\r\n                // Check a parameter with the same name exists\r\n                if (this.blocks.findIndex(p => p.type === 'parameter' && p.id == id) >= 0) {\r\n                    return false;\r\n                }\r\n                param = Utils.deepClone(param);\r\n                if (typeof param.schema === 'undefined') {\r\n                    param.schema = {};\r\n                }\r\n                this.blocks.push(Vue.observable({\r\n                    id,\r\n                    type: 'parameter',\r\n                    origin,\r\n                    position: Utils.ensurePoint(position, () => this.getNewBlockDefaultPosition(this.getBlockSize({}))),\r\n                    spec: Object.freeze(param)\r\n                }));\r\n                return true;\r\n            });\r\n        },\r\n\r\n        getPgParameters() {\r\n            return this.blocks.filter(b => b.type === 'parameter');\r\n        },\r\n\r\n        getPgParameterById(id) {\r\n            return this.blocks.find(b => b.type === 'parameter' && b.id === id);\r\n        },\r\n\r\n        async importEdges(pg) {\r\n            var nodes = pg.getNodes();\r\n            for(var node of Object.values(nodes)) {\r\n                var args = node.getArgumentNames();\r\n                for(let i in args) {\r\n                    var val = node.getRawArgument(args[i]);\r\n                    switch(node.getArgumentType(args[i])) {\r\n                        case 'result':\r\n                            await this.addEdgeByNames('#' + pg.getNode(val.from_node).id, \"output\", '#' + node.id, args[i], false);\r\n                            break;\r\n                        case 'parameter':\r\n                            await this.addEdgeByNames('$' + val.from_parameter, \"output\", '#' + node.id, args[i], false);\r\n                            break;\r\n                        case 'object':\r\n                        case 'array':\r\n                            await this.importEdgeDeep(val, pg, node, args, i);\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        async importEdgeDeep(val, pg, node, args, i) {\r\n            for(let k in val) {\r\n                // k !== 'process_graph' prevents importing sub process graphs like in load_collection, see #118\r\n                if(val[k] && typeof val[k] === \"object\" && k !== 'process_graph') {\r\n                    await this.importEdgeDeep(val[k], pg, node, args, i);\r\n                }\r\n                else if (!Utils.isRef(val)) {\r\n                    continue;\r\n                }\r\n                else if (val.from_node) {\r\n                    await this.addEdgeByNames('#' + pg.getNode(val.from_node).id, \"output\", '#' + node.id, args[i], false);\r\n                }\r\n                else if (val.from_parameter) {\r\n                    await this.addEdgeByNames('$' + val.from_parameter, \"output\", '#' + node.id, args[i], false);\r\n                }\r\n            }\r\n        },\r\n\r\n        async importNodes(nodes, x = 0, y = 0, imported = []) {\r\n            let nextNodes = [];\r\n            let maxX = 0;\r\n            for(let node of nodes) {\r\n                // `node` is a Node class instance as defined by the js-processgraphs library\r\n                // `data` is the simple object that is defined by JSON process graphs\r\n                // `block` is the representation used by the Block component to render the block\r\n\r\n                // To get a better layout, only add the block once all previous nodes are added\r\n                if (imported.includes(node.id) || node.getPreviousNodes().find(prev => !imported.includes(prev.id)) !== undefined) {\r\n                    y += MARGIN / 2; // add a small offset so that lines going through a box are easier to see\r\n                    continue;\r\n                }\r\n\r\n                let data = typeof node.toJSON === 'function' ? node.toJSON() : node;\r\n                data.position = Utils.ensurePoint(data.position, () => [x,y]);\r\n\r\n                let block = this.addBlock(data, node.id);\r\n                imported.push(node.id);\r\n\r\n                let size = this.getBlockSize(block);\r\n                maxX = Math.max(maxX, data.position[0] + size[0]);\r\n                y = data.position[1] + size[1] + MARGIN;\r\n\r\n                nextNodes = nextNodes.concat(node.getNextNodes());\r\n            }\r\n            if (nextNodes.length) {\r\n                await this.importNodes(nextNodes, maxX + MARGIN, 0, imported);\r\n            }\r\n        },\r\n\r\n        incrementId(id = null) {\r\n            if (typeof id !== 'number' && (typeof id !== 'string' || id.length === 0)) {\r\n                id = this.nextBlockId;\r\n                this.nextBlockId++;\r\n            }\r\n            let int = Number.parseInt(id, 10);\r\n            if (!Number.isNaN(int)) {\r\n                this.nextBlockId = Math.max(this.nextBlockId, int+1);\r\n            }\r\n            return id;\r\n        },\r\n\r\n        /**\r\n         * Go to the perfect scale\r\n         */\r\n        perfectScale() {\r\n            if (!this.$refs.div || this.blocks.length === 0) {\r\n                return;\r\n            }\r\n\r\n            var xMin = null, xMax = null;\r\n            var yMin = null, yMax = null;\r\n\r\n            for (let block of this.blocks) {\r\n                let size = this.getBlockSize(block);\r\n                let pos = Utils.ensurePoint(block.position);\r\n                if (xMin == null) {\r\n                    xMin = pos[0]-15\r\n                    xMax = pos[0]+size[0]+15;\r\n                    yMin = pos[1]-15\r\n                    yMax = pos[1]+size[1]+15;\r\n                } else {\r\n                    xMin = Math.min(xMin, pos[0]-15);\r\n                    xMax = Math.max(xMax, pos[0]+size[0]+15);\r\n                    yMin = Math.min(yMin, pos[1]-15);\r\n                    yMax = Math.max(yMax, pos[1]+size[1]+15);\r\n                }\r\n            }\r\n\r\n            var rect = this.$refs.div.getBoundingClientRect();\r\n            var scaleA = rect.width/(xMax-xMin);\r\n            var scaleB = rect.height/(yMax-yMin);\r\n            this.state.scale = Math.min(scaleA, scaleB, 1.5); // Don't scale higher than 1.5\r\n            this.state.center = [\r\n                rect.width/2 - this.state.scale*(xMin+xMax)/2.0,\r\n                rect.height/2 - this.state.scale*(yMin+yMax)/2.0\r\n            ];\r\n            this.newBlockOffset = 0;\r\n        },\r\n\r\n        showParameterViewer(parameters, values, title, isEditable, selectParameterName, saveCallback, parent) {\r\n            this.parameterViewer = {\r\n                parameters,\r\n                values,\r\n                title,\r\n                selectParameterName,\r\n                parent\r\n            };\r\n        }\r\n    }\r\n};\r\n\r\nclass BlocksProcess {\r\n    constructor(process) {\r\n        Object.assign(this, process);\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.vue-component.model-builder {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tposition: relative;\r\n\r\n    &.editable.focus .blocks {\r\n        border-color: rgba(22, 102, 182, 0.3);\r\n    }\r\n\r\n    &:focus,\r\n    .blocks:focus,\r\n    .canvas:focus {\r\n        outline: 0;\r\n    }\r\n    \r\n    .canvas {\r\n        width: 100%;\r\n        height: 100%;\r\n        position: absolute;\r\n        z-index: 1;\r\n    }\r\n    \r\n    .blocks {\r\n        box-sizing: border-box;\r\n        border: 1px solid transparent;\r\n        overflow: hidden;\r\n        position: absolute;\r\n        z-index: 3;\r\n        width: 100%;\r\n        height: 100%;\r\n    }\r\n\r\n    &.compact .blockicon .delete,\r\n    &.compact .blockicon .info,\r\n    &.compact .blockicon .addDescription,\r\n    &.compact .blockId,\r\n    &.compact .editDescription, \r\n    &.scale_xs .blockicon,\r\n    &.scale_s .blockicon,\r\n    &.scale_xs .connector .text {\r\n        display: none;\r\n    }\r\n    .zoomInfo {\r\n        position: absolute;\r\n        top: 0;\r\n        right: 0;\r\n        display: inline-block;\r\n        padding: 0.3em;\r\n        background-color: #f9f9f9;\r\n        border-radius: 0 0 0 0.3em;\r\n        z-index: 5;\r\n    }\r\n    &.scale_xs .editDescription {\r\n        visibility: hidden;\r\n    }\r\n}\r\n</style>","import mod from \"-!../../../cache-loader/dist/cjs.js??ref--13-0!../../../thread-loader/dist/cjs.js!../../../babel-loader/lib/index.js!../../../cache-loader/dist/cjs.js??ref--1-0!../../../vue-loader/lib/index.js??vue-loader-options!./ModelBuilder.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../cache-loader/dist/cjs.js??ref--13-0!../../../thread-loader/dist/cjs.js!../../../babel-loader/lib/index.js!../../../cache-loader/dist/cjs.js??ref--1-0!../../../vue-loader/lib/index.js??vue-loader-options!./ModelBuilder.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ModelBuilder.vue?vue&type=template&id=46a53729&\"\nimport script from \"./ModelBuilder.vue?vue&type=script&lang=js&\"\nexport * from \"./ModelBuilder.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ModelBuilder.vue?vue&type=style&index=0&id=46a53729&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","const BaseProcess = require('./process');\r\nconst ErrorList = require('./errorlist');\r\nconst JsonSchemaValidator = require('./jsonschema');\r\nconst ProcessGraphError = require('./error');\r\nconst ProcessGraphNode = require('./node');\r\nconst Utils = require('./utils');\r\nconst ProcessUtils = require('@openeo/js-commons/src/processUtils.js');\r\n\r\nconst processKeys = [\r\n\t'id',\r\n\t'summary',\r\n\t'description',\r\n\t'categories',\r\n\t'parameters',\r\n\t'returns',\r\n\t'deprecated',\r\n\t'experimental',\r\n\t'exceptions',\r\n\t'examples',\r\n\t'links',\r\n\t'process_graph'\r\n];\r\n\r\n/**\r\n * Process parser, validator and executor.\r\n * \r\n * @class\r\n */\r\nclass ProcessGraph {\r\n\r\n\t// ToDo: Also parse and validate other parts of the process, e.g. id, parameters, etc.\r\n\r\n\tconstructor(process, processRegistry = null, jsonSchemaValidator = null) {\r\n\t\tthis.process = process;\r\n\t\tthis.nodes = {};\r\n\t\tthis.startNodes = [];\r\n\t\tthis.resultNode = null;\r\n\t\tthis.children = [];\r\n\t\tthis.parentNode = null;\r\n\t\tthis.parsed = false;\r\n\t\tthis.validated = false;\r\n\t\tthis.errors = new ErrorList();\r\n\t\tthis.callbackParameters = [];\r\n\t\t// Sub process graphs need to copy these:\r\n\t\tthis.processRegistry = processRegistry;\r\n\t\tthis.jsonSchemaValidator = jsonSchemaValidator;\r\n\t\tthis.arguments = {};\r\n\t\tthis.allowEmptyGraph = false;\r\n\t\tthis.fillProcessParameters = false;\r\n\t\tthis.allowUndefinedParameterRefs = true;\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\treturn this.process;\r\n\t}\r\n\r\n\tgetJsonSchemaValidator() {\r\n\t\tif (this.jsonSchemaValidator === null) {\r\n\t\t\tthis.jsonSchemaValidator = this.createJsonSchemaValidatorInstance();\r\n\t\t}\r\n\t\tthis.jsonSchemaValidator.setProcessGraphParser(this);\r\n\t\treturn this.jsonSchemaValidator;\r\n\t}\r\n\r\n\tcreateJsonSchemaValidatorInstance() {\r\n\t\treturn new JsonSchemaValidator();\r\n\t}\r\n\r\n\tcreateNodeInstance(nodeObj, id, parent) {\r\n\t\treturn new ProcessGraphNode(nodeObj, id, parent);\r\n\t}\r\n\r\n\tcreateProcessGraphInstance(process) {\r\n\t\tlet pg = new ProcessGraph(process, this.processRegistry, this.getJsonSchemaValidator());\r\n\t\treturn this.copyProcessGraphInstanceProperties(pg);\r\n\t}\r\n\r\n\tcreateProcessInstance(process) {\r\n\t\treturn new BaseProcess(process);\r\n\t}\r\n\r\n\tcopyProcessGraphInstanceProperties(pg) {\r\n\t\tpg.allowEmptyGraph = this.allowEmptyGraph;\r\n\t\tpg.fillProcessParameters = this.fillProcessParameters;\r\n\t\tpg.allowUndefinedParameterRefs = this.allowUndefinedParameterRefs;\r\n\t\treturn pg;\r\n\t}\r\n\r\n\tcreateChildProcessGraph(process, node, parameterPath = []) {\r\n\t\tvar pg = this.createProcessGraphInstance(process);\r\n\t\tpg.setArguments(this.arguments);\r\n\t\tpg.setParentNode(node);\r\n\t\tif (parameterPath.length > 0) {\r\n\t\t\tlet parameterName = parameterPath.shift();\r\n\t\t\tpg.setCallbackParameters(ProcessUtils.getCallbackParametersForProcess(pg.getParentProcess(), parameterName, parameterPath));\r\n\t\t}\r\n\t\tpg.parse();\r\n\t\tthis.children.push(pg);\r\n\t\treturn pg;\r\n\t}\r\n\r\n\tgetParentNode() {\r\n\t\treturn this.parentNode;\r\n\t}\r\n\r\n\tgetParent() {\r\n\t\tif (this.parentNode) {\r\n\t\t\treturn this.parentNode.getProcessGraph();\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tsetParentNode(parent) {\r\n\t\tif (parent instanceof ProcessGraphNode) {\r\n\t\t\tthis.parentNode = parent;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.parentNode = null;\r\n\t\t}\r\n\t}\r\n\r\n\tisValid() {\r\n\t\treturn this.validated && this.errors.count() === 0;\r\n\t}\r\n\r\n\taddError(error) {\r\n\t\tthis.errors.add(error);\r\n\t}\r\n\r\n\tallowUndefinedParameters(allow = true) {\r\n\t\tif (!allow) {\r\n\t\t\tthis.fillProcessParameters = false;\r\n\t\t}\r\n\t\tthis.allowUndefinedParameterRefs = allow;\r\n\t}\r\n\r\n\tfillUndefinedParameters(fill = true) {\r\n\t\tif (fill) {\r\n\t\t\tthis.allowUndefinedParameterRefs = true;\r\n\t\t}\r\n\t\tthis.fillProcessParameters = fill;\r\n\t}\r\n\r\n\tallowEmpty(allow = true) {\r\n\t\tthis.allowEmptyGraph = allow;\r\n\t}\r\n\r\n\tparse() {\r\n\t\tif (this.parsed) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst makeError = (errorId) => {\r\n\t\t\tif (this.getParentProcessId()) {\r\n\t\t\t\treturn new ProcessGraphError(\r\n\t\t\t\t\terrorId + 'Callback',\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tprocess_id: this.getParentProcessId(),\r\n\t\t\t\t\t\tnode_id: this.parentNode ? this.parentNode.id : 'N/A'\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn new ProcessGraphError(errorId);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif (!Utils.isObject(this.process)) {\r\n\t\t\tthrow makeError('ProcessMissing');\r\n\t\t}\r\n\r\n\t\tif (Utils.size(this.process.process_graph) === 0) {\r\n\t\t\tif (this.allowEmptyGraph) {\r\n\t\t\t\tlet hasProcessKey = Object.keys(this.process).find(key => processKeys.includes(key));\r\n\t\t\t\tif (Utils.size(this.process) === 0 || hasProcessKey) {\r\n\t\t\t\t\tthis.parsed = true;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthrow makeError('ProcessGraphMissing');\r\n\t\t}\r\n\r\n\t\tthis.nodes = Utils.mapObjectValues(this.process.process_graph, (pg, id) => this.createNodeInstance(pg, id, this));\r\n\r\n\t\tfor(let id in this.nodes) {\r\n\t\t\tvar node = this.nodes[id];\r\n\t\t\tif (node.isResultNode) {\r\n\t\t\t\tif (this.resultNode !== null) {\r\n\t\t\t\t\tthrow makeError('MultipleResultNodes');\r\n\t\t\t\t}\r\n\t\t\t\tthis.resultNode = node;\r\n\t\t\t}\r\n\r\n\t\t\tthis.parseNodeArguments(id, node);\r\n\t\t}\r\n\t\tif (this.resultNode === null) {\r\n\t\t\tthrow makeError('ResultNodeMissing');\r\n\t\t}\r\n\r\n\t\t// Find/Cache start nodes, only possible after parseNodeArguments have been called for all nodes\r\n\t\t// Sort nodes to ensure a consistent execution order\r\n\t\tthis.startNodes = Object.values(this.nodes).filter(node => node.isStartNode()).sort((a,b) => a.id.localeCompare(b.id));\r\n\t\tif (this.startNodes.length === 0) {\r\n\t\t\tthrow makeError('StartNodeMissing');\r\n\t\t}\r\n\r\n\t\tthis.parsed = true;\r\n\t}\r\n\r\n\tasync validate(throwOnErrors = true) {\r\n\t\tif (this.validated) {\r\n\t\t\tif (throwOnErrors && this.errors.count() > 0) {\r\n\t\t\t\tthrow this.errors.first();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn this.errors;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.validated = true;\r\n\r\n\t\t// Parse\r\n\t\ttry {\r\n\t\t\tthis.parse();\r\n\t\t} catch (error) {\r\n\t\t\tthis.addError(error);\r\n\t\t\tif (throwOnErrors) {\r\n\t\t\t\tthrow error;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Validate\r\n\t\tawait this.validateNodes(this.getStartNodes(), throwOnErrors);\r\n\t\treturn this.errors;\r\n\t}\r\n\r\n\tasync execute(args = null) {\r\n\t\tthis.allowUndefinedParameters(false);\r\n\t\tthis.setArguments(args);\r\n\t\tawait this.validate();\r\n\t\tthis.reset();\r\n\t\tawait this.executeNodes(this.getStartNodes());\r\n\t\treturn this.getResultNode();\r\n\t}\r\n\r\n\tasync validateNodes(nodes, throwOnErrors, previousNode = null) {\r\n\t\tif (nodes.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar promises = nodes.map(async (node) => {\r\n\t\t\t// Validate this node after all dependencies are available\r\n\t\t\tif (!node.solveDependency(previousNode)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Get process and validate\r\n\t\t\ttry {\r\n\t\t\t\tawait this.validateNode(node);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tif (e instanceof ErrorList) {\r\n\t\t\t\t\tthis.errors.merge(e);\r\n\t\t\t\t\tif (throwOnErrors) {\r\n\t\t\t\t\t\tthrow e.first();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.addError(e);\r\n\t\t\t\t\tif (throwOnErrors) {\r\n\t\t\t\t\t\tthrow e;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tawait this.validateNodes(node.getNextNodes(), throwOnErrors, node);\r\n\t\t});\r\n\r\n\t\tawait Promise.all(promises);\r\n\t}\r\n\r\n\tasync validateNode(node) {\r\n\t\tvar process = this.getProcess(node);\r\n\t\tif (process) {\r\n\t\t\treturn await process.validate(node);\r\n\t\t}\r\n\t}\r\n\r\n\tasync executeNodes(nodes, previousNode = null) {\r\n\t\tif (nodes.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar promises = nodes.map(async (node) => {\r\n\t\t\t// Execute this node after all dependencies are available\r\n\t\t\tif (!node.solveDependency(previousNode)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar result = await this.executeNode(node);\r\n\t\t\tnode.setResult(result);\r\n\r\n\t\t\t// Execute next nodes in chain\r\n\t\t\tawait this.executeNodes(node.getNextNodes(), node);\r\n\r\n\t\t});\r\n\r\n\t\treturn await Promise.all(promises);\r\n\t}\r\n\r\n\tasync executeNode(node) {\r\n\t\tvar process = this.getProcess(node);\r\n\t\treturn await process.execute(node);\r\n\t}\r\n\r\n\tparseNodeArguments(nodeId, node, parameterPath = [], args = undefined) {\r\n\t\tif (typeof args === 'undefined') {\r\n\t\t\targs = node.arguments;\r\n\t\t}\r\n\t\tfor(let argumentName in args) {\r\n\t\t\tlet arg = args[argumentName];\r\n\t\t\t// Make a \"path\" that consists of the parameter name and the keys of arrays/objects, if applicable.\r\n\t\t\tlet path = parameterPath.concat([argumentName]);\r\n\t\t\tlet type = Utils.getType(arg);\r\n\t\t\tswitch(type) {\r\n\t\t\t\tcase 'result':\r\n\t\t\t\t\t// Connect the nodes with each other\r\n\t\t\t\t\tvar prevNode = this.nodes[arg.from_node];\r\n\t\t\t\t\tif (typeof prevNode === 'undefined') {\r\n\t\t\t\t\t\tthrow new ProcessGraphError('ReferencedNodeMissing', {node_id: arg.from_node});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnode.addPreviousNode(prevNode);\r\n\t\t\t\t\tprevNode.addNextNode(node);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'callback':\r\n\t\t\t\t\t// Create a new process graph for the callback\r\n\t\t\t\t\targs[argumentName] = this.createChildProcessGraph(arg, node, path);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'parameter':\r\n\t\t\t\t\t// If we found a parameter and it's not defined yet (includes that it's not a callback parameter) and fillProcessParameters is set to true: Add it to the process spec.\r\n\t\t\t\t\tif (this.fillProcessParameters && !this.hasParameter(arg.from_parameter)) {\r\n\t\t\t\t\t\tthis.addProcessParameter(arg.from_parameter);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'array':\r\n\t\t\t\tcase 'object':\r\n\t\t\t\t\t// Parse everything hidden in arrays and objects\r\n\t\t\t\t\tthis.parseNodeArguments(nodeId, node, path, arg);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tsetCallbackParameters(parameters) {\r\n\t\tthis.callbackParameters = parameters;\r\n\t}\r\n\r\n\tgetCallbackParameter(name) {\r\n\t\treturn this.getCallbackParameters().find(p => p.name === name) || null;\r\n\t}\r\n\r\n\tgetCallbackParameters() {\t\t\r\n\t\treturn this.callbackParameters;\r\n\t}\r\n\r\n\taddProcessParameter(name, description = '', schema = {}) {\r\n\t\tif (!Array.isArray(this.process.parameters)) {\r\n\t\t\tthis.process.parameters = [];\r\n\t\t}\r\n\t\tthis.process.parameters.push({\r\n\t\t\tname, description, schema\r\n\t\t});\r\n\t}\r\n\r\n\thasParameterDefault(name) {\r\n\t\treturn this.getParameterDefault(name) !== undefined;\r\n\t}\r\n\r\n\tgetParameterDefault(name) {\r\n\t\tlet param = this.getParameter(name);\r\n\t\tif (param !== null) {\r\n\t\t\treturn param.default;\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\thasParameter(name) {\r\n\t\treturn this.getParameter(name) !== null;\r\n\t}\r\n\r\n\tgetProcessParameters(includeUndefined = false) {\r\n\t\tlet parameters = Array.isArray(this.process.parameters) ? this.process.parameters.slice(0) : [];\r\n\t\tif (includeUndefined && !this.fillProcessParameters) {\r\n\t\t\tfor (let key in this.nodes) {\r\n\t\t\t\tlet refs = this.nodes[key].getRefs();\r\n\t\t\t\tfor(let ref of refs) {\r\n\t\t\t\t\tif (ref.from_parameter && !parameters.find(other => other.name === ref.from_parameter)) { // jshint ignore:line\r\n\t\t\t\t\t\tparameters.push({\r\n\t\t\t\t\t\t\tname: ref.from_parameter,\r\n\t\t\t\t\t\t\tdescription: '',\r\n\t\t\t\t\t\t\tschema: {}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn parameters;\r\n\t}\r\n\r\n\tgetProcessParameter(name, includeUndefined = false) {\r\n\t\treturn this.getProcessParameters(includeUndefined).find(p => p.name === name) || null;\r\n\t}\r\n\r\n\tgetParameter(name) {\r\n\t\tlet callbackParam = this.getCallbackParameter(name);\r\n\t\tlet processParam = this.getProcessParameter(name);\r\n\t\tif (callbackParam && processParam) {\r\n\t\t\t// ToDo: Take https://github.com/Open-EO/openeo-api/issues/332 into account\r\n\t\t\treturn Object.assign({}, callbackParam, processParam);\r\n\t\t}\r\n\t\telse if (callbackParam) {\r\n\t\t\treturn callbackParam;\r\n\t\t}\r\n\t\telse if (processParam) {\r\n\t\t\treturn processParam;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tsetArguments(args) {\r\n\t\tif (Utils.isObject(args)) {\r\n\t\t\tObject.assign(this.arguments, args);\r\n\t\t}\r\n\t}\r\n\r\n\thasArgument(name) {\r\n\t\treturn typeof this.arguments[name] !== 'undefined';\r\n\t}\r\n\r\n\tgetArgument(name) {\r\n\t\treturn this.arguments[name];\r\n\t}\r\n\r\n\treset() {\r\n\t\tfor(var id in this.nodes) {\r\n\t\t\tthis.nodes[id].reset();\r\n\t\t}\r\n\t\tthis.children.forEach(child => child.reset());\r\n\t}\r\n\r\n\tgetResultNode() {\r\n\t\treturn this.resultNode;\r\n\t}\r\n\r\n\tgetStartNodes() {\r\n\t\treturn this.startNodes;\r\n\t}\r\n\r\n\tgetStartNodeIds() {\r\n\t\treturn this.startNodes.map(node => node.id);\r\n\t}\r\n\r\n\tgetNode(nodeId) {\r\n\t\treturn nodeId in this.nodes ? this.nodes[nodeId] : null;\r\n\t}\r\n\r\n\tgetNodeCount() {\r\n\t\treturn Utils.size(this.nodes);\r\n\t}\r\n\r\n\tgetNodes() {\r\n\t\treturn this.nodes;\r\n\t}\r\n\r\n\tgetErrors() {\r\n\t\treturn this.errors;\r\n\t}\r\n\r\n\t/**\r\n\t * Gets the process for the given process ID or node.\r\n\t * \r\n\t * @param {ProcessGraphNode|string} process \r\n\t * @param {?string} [namespace=null]\r\n\t * @returns {object|null}\r\n\t * @throws {ProcessGraphError} - ProcessUnsupported\r\n\t */\r\n\tgetProcess(process, namespace = null) {\r\n\t\tif (this.processRegistry === null) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tlet id;\r\n\t\tif (process instanceof ProcessGraphNode) {\r\n\t\t\tid = process.process_id;\r\n\t\t\tnamespace = process.namespace;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tid = process;\r\n\t\t}\r\n\t\tlet spec = this.processRegistry.get(id, namespace);\r\n\t\tif (spec === null) {\r\n\t\t\tthrow new ProcessGraphError('ProcessUnsupported', {process: id, namespace: namespace || 'n/a'});\r\n\t\t}\r\n\t\treturn this.createProcessInstance(spec);\r\n\t}\r\n\r\n\tgetParentProcessId() {\r\n\t\tif(this.getParentNode()) {\r\n\t\t\treturn this.getParentNode().process_id;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tgetParentProcess() {\r\n\t\tif (this.processRegistry === null) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this.processRegistry.get(this.getParentProcessId());\r\n\t}\r\n\r\n}\r\n\r\nmodule.exports = ProcessGraph;","const Utils = require('./utils');\r\n\r\nconst MESSAGES = {\r\n\t\"MultipleResultNodes\": \"Multiple result nodes specified for the process.\",\r\n\t\"StartNodeMissing\": \"No start nodes found for the process.\",\r\n\t\"ResultNodeMissing\": \"No result node found for the process.\",\r\n\t\"ReferencedNodeMissing\": \"Referenced process node '{node_id}' doesn't exist.\",\r\n\t\"NodeIdInvalid\": \"Invalid node id specified in the process.\",\r\n\t\"NodeInvalid\": \"Process node '{node_id}' is not a valid object.\",\r\n\t\"ProcessIdMissing\": \"Process node '{node_id}' doesn't contain a process id.\",\r\n\t\"ProcessGraphParameterMissing\": \"Invalid parameter '{argument}' referenced in process node '{node_id}' (process: {process_id}, namespace: {namespace}).\",\r\n\t\"ProcessUnsupported\": \"Process '{process}' (namespace: {namespace}) is not supported.\",\r\n\t\"ProcessArgumentUnsupported\": \"Process '{process}' (namespace: {namespace}) does not support the following arguments: {arguments}\",\r\n\t\"ProcessArgumentRequired\": \"Process '{process}' (namespace: {namespace}) requires argument '{argument}'.\",\r\n\t\"ProcessArgumentInvalid\": \"The argument '{argument}' in process '{process}' (namespace: {namespace}) is invalid: {reason}\",\r\n\t\"ProcessGraphMissing\": \"No process graph specified\",\r\n\t\"ProcessMissing\": \"No process specified\"\r\n};\r\n\r\n/**\r\n * An error class for this library.\r\n * \r\n * @class\r\n */\r\nclass ProcessGraphError extends Error {\r\n\r\n\tconstructor(codeOrMsg, variables = {}) {\r\n\t\tsuper();\r\n\t\tthis.variables = variables;\r\n\t\tif (typeof MESSAGES[codeOrMsg] === 'string') {\r\n\t\t\tthis.code = codeOrMsg;\r\n\t\t\tthis.message = Utils.replacePlaceholders(MESSAGES[codeOrMsg], variables);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.code = codeOrMsg.replace(/[^\\w\\d]+/g, '');\r\n\t\t\tthis.message = codeOrMsg;\r\n\t\t}\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\treturn {\r\n\t\t\tcode: this.code,\r\n\t\t\tmessage: this.message\r\n\t\t};\r\n\t}\r\n\r\n}\r\n\r\nmodule.exports = ProcessGraphError;","'use strict';\nmodule.exports = function generate_oneOf(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $currentBaseId = $it.baseId,\n    $prevValid = 'prevValid' + $lvl,\n    $passingSchemas = 'passingSchemas' + $lvl;\n  out += 'var ' + ($errs) + ' = errors , ' + ($prevValid) + ' = false , ' + ($valid) + ' = false , ' + ($passingSchemas) + ' = null; ';\n  var $wasComposite = it.compositeRule;\n  it.compositeRule = $it.compositeRule = true;\n  var arr1 = $schema;\n  if (arr1) {\n    var $sch, $i = -1,\n      l1 = arr1.length - 1;\n    while ($i < l1) {\n      $sch = arr1[$i += 1];\n      if ((it.opts.strictKeywords ? (typeof $sch == 'object' && Object.keys($sch).length > 0) || $sch === false : it.util.schemaHasRules($sch, it.RULES.all))) {\n        $it.schema = $sch;\n        $it.schemaPath = $schemaPath + '[' + $i + ']';\n        $it.errSchemaPath = $errSchemaPath + '/' + $i;\n        out += '  ' + (it.validate($it)) + ' ';\n        $it.baseId = $currentBaseId;\n      } else {\n        out += ' var ' + ($nextValid) + ' = true; ';\n      }\n      if ($i) {\n        out += ' if (' + ($nextValid) + ' && ' + ($prevValid) + ') { ' + ($valid) + ' = false; ' + ($passingSchemas) + ' = [' + ($passingSchemas) + ', ' + ($i) + ']; } else { ';\n        $closingBraces += '}';\n      }\n      out += ' if (' + ($nextValid) + ') { ' + ($valid) + ' = ' + ($prevValid) + ' = true; ' + ($passingSchemas) + ' = ' + ($i) + '; }';\n    }\n  }\n  it.compositeRule = $it.compositeRule = $wasComposite;\n  out += '' + ($closingBraces) + 'if (!' + ($valid) + ') {   var err =   '; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ('oneOf') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { passingSchemas: ' + ($passingSchemas) + ' } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should match exactly one schema in oneOf\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError(vErrors); ';\n    } else {\n      out += ' validate.errors = vErrors; return false; ';\n    }\n  }\n  out += '} else {  errors = ' + ($errs) + '; if (vErrors !== null) { if (' + ($errs) + ') vErrors.length = ' + ($errs) + '; else vErrors = null; }';\n  if (it.opts.allErrors) {\n    out += ' } ';\n  }\n  return out;\n}\n","/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.URI = global.URI || {})));\n}(this, (function (exports) { 'use strict';\n\nfunction merge() {\n    for (var _len = arguments.length, sets = Array(_len), _key = 0; _key < _len; _key++) {\n        sets[_key] = arguments[_key];\n    }\n\n    if (sets.length > 1) {\n        sets[0] = sets[0].slice(0, -1);\n        var xl = sets.length - 1;\n        for (var x = 1; x < xl; ++x) {\n            sets[x] = sets[x].slice(1, -1);\n        }\n        sets[xl] = sets[xl].slice(1);\n        return sets.join('');\n    } else {\n        return sets[0];\n    }\n}\nfunction subexp(str) {\n    return \"(?:\" + str + \")\";\n}\nfunction typeOf(o) {\n    return o === undefined ? \"undefined\" : o === null ? \"null\" : Object.prototype.toString.call(o).split(\" \").pop().split(\"]\").shift().toLowerCase();\n}\nfunction toUpperCase(str) {\n    return str.toUpperCase();\n}\nfunction toArray(obj) {\n    return obj !== undefined && obj !== null ? obj instanceof Array ? obj : typeof obj.length !== \"number\" || obj.split || obj.setInterval || obj.call ? [obj] : Array.prototype.slice.call(obj) : [];\n}\nfunction assign(target, source) {\n    var obj = target;\n    if (source) {\n        for (var key in source) {\n            obj[key] = source[key];\n        }\n    }\n    return obj;\n}\n\nfunction buildExps(isIRI) {\n    var ALPHA$$ = \"[A-Za-z]\",\n        CR$ = \"[\\\\x0D]\",\n        DIGIT$$ = \"[0-9]\",\n        DQUOTE$$ = \"[\\\\x22]\",\n        HEXDIG$$ = merge(DIGIT$$, \"[A-Fa-f]\"),\n        //case-insensitive\n    LF$$ = \"[\\\\x0A]\",\n        SP$$ = \"[\\\\x20]\",\n        PCT_ENCODED$ = subexp(subexp(\"%[EFef]\" + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$) + \"|\" + subexp(\"%[89A-Fa-f]\" + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$) + \"|\" + subexp(\"%\" + HEXDIG$$ + HEXDIG$$)),\n        //expanded\n    GEN_DELIMS$$ = \"[\\\\:\\\\/\\\\?\\\\#\\\\[\\\\]\\\\@]\",\n        SUB_DELIMS$$ = \"[\\\\!\\\\$\\\\&\\\\'\\\\(\\\\)\\\\*\\\\+\\\\,\\\\;\\\\=]\",\n        RESERVED$$ = merge(GEN_DELIMS$$, SUB_DELIMS$$),\n        UCSCHAR$$ = isIRI ? \"[\\\\xA0-\\\\u200D\\\\u2010-\\\\u2029\\\\u202F-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF]\" : \"[]\",\n        //subset, excludes bidi control characters\n    IPRIVATE$$ = isIRI ? \"[\\\\uE000-\\\\uF8FF]\" : \"[]\",\n        //subset\n    UNRESERVED$$ = merge(ALPHA$$, DIGIT$$, \"[\\\\-\\\\.\\\\_\\\\~]\", UCSCHAR$$),\n        SCHEME$ = subexp(ALPHA$$ + merge(ALPHA$$, DIGIT$$, \"[\\\\+\\\\-\\\\.]\") + \"*\"),\n        USERINFO$ = subexp(subexp(PCT_ENCODED$ + \"|\" + merge(UNRESERVED$$, SUB_DELIMS$$, \"[\\\\:]\")) + \"*\"),\n        DEC_OCTET$ = subexp(subexp(\"25[0-5]\") + \"|\" + subexp(\"2[0-4]\" + DIGIT$$) + \"|\" + subexp(\"1\" + DIGIT$$ + DIGIT$$) + \"|\" + subexp(\"[1-9]\" + DIGIT$$) + \"|\" + DIGIT$$),\n        DEC_OCTET_RELAXED$ = subexp(subexp(\"25[0-5]\") + \"|\" + subexp(\"2[0-4]\" + DIGIT$$) + \"|\" + subexp(\"1\" + DIGIT$$ + DIGIT$$) + \"|\" + subexp(\"0?[1-9]\" + DIGIT$$) + \"|0?0?\" + DIGIT$$),\n        //relaxed parsing rules\n    IPV4ADDRESS$ = subexp(DEC_OCTET_RELAXED$ + \"\\\\.\" + DEC_OCTET_RELAXED$ + \"\\\\.\" + DEC_OCTET_RELAXED$ + \"\\\\.\" + DEC_OCTET_RELAXED$),\n        H16$ = subexp(HEXDIG$$ + \"{1,4}\"),\n        LS32$ = subexp(subexp(H16$ + \"\\\\:\" + H16$) + \"|\" + IPV4ADDRESS$),\n        IPV6ADDRESS1$ = subexp(subexp(H16$ + \"\\\\:\") + \"{6}\" + LS32$),\n        //                           6( h16 \":\" ) ls32\n    IPV6ADDRESS2$ = subexp(\"\\\\:\\\\:\" + subexp(H16$ + \"\\\\:\") + \"{5}\" + LS32$),\n        //                      \"::\" 5( h16 \":\" ) ls32\n    IPV6ADDRESS3$ = subexp(subexp(H16$) + \"?\\\\:\\\\:\" + subexp(H16$ + \"\\\\:\") + \"{4}\" + LS32$),\n        //[               h16 ] \"::\" 4( h16 \":\" ) ls32\n    IPV6ADDRESS4$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,1}\" + H16$) + \"?\\\\:\\\\:\" + subexp(H16$ + \"\\\\:\") + \"{3}\" + LS32$),\n        //[ *1( h16 \":\" ) h16 ] \"::\" 3( h16 \":\" ) ls32\n    IPV6ADDRESS5$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,2}\" + H16$) + \"?\\\\:\\\\:\" + subexp(H16$ + \"\\\\:\") + \"{2}\" + LS32$),\n        //[ *2( h16 \":\" ) h16 ] \"::\" 2( h16 \":\" ) ls32\n    IPV6ADDRESS6$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,3}\" + H16$) + \"?\\\\:\\\\:\" + H16$ + \"\\\\:\" + LS32$),\n        //[ *3( h16 \":\" ) h16 ] \"::\"    h16 \":\"   ls32\n    IPV6ADDRESS7$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,4}\" + H16$) + \"?\\\\:\\\\:\" + LS32$),\n        //[ *4( h16 \":\" ) h16 ] \"::\"              ls32\n    IPV6ADDRESS8$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,5}\" + H16$) + \"?\\\\:\\\\:\" + H16$),\n        //[ *5( h16 \":\" ) h16 ] \"::\"              h16\n    IPV6ADDRESS9$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,6}\" + H16$) + \"?\\\\:\\\\:\"),\n        //[ *6( h16 \":\" ) h16 ] \"::\"\n    IPV6ADDRESS$ = subexp([IPV6ADDRESS1$, IPV6ADDRESS2$, IPV6ADDRESS3$, IPV6ADDRESS4$, IPV6ADDRESS5$, IPV6ADDRESS6$, IPV6ADDRESS7$, IPV6ADDRESS8$, IPV6ADDRESS9$].join(\"|\")),\n        ZONEID$ = subexp(subexp(UNRESERVED$$ + \"|\" + PCT_ENCODED$) + \"+\"),\n        //RFC 6874\n    IPV6ADDRZ$ = subexp(IPV6ADDRESS$ + \"\\\\%25\" + ZONEID$),\n        //RFC 6874\n    IPV6ADDRZ_RELAXED$ = subexp(IPV6ADDRESS$ + subexp(\"\\\\%25|\\\\%(?!\" + HEXDIG$$ + \"{2})\") + ZONEID$),\n        //RFC 6874, with relaxed parsing rules\n    IPVFUTURE$ = subexp(\"[vV]\" + HEXDIG$$ + \"+\\\\.\" + merge(UNRESERVED$$, SUB_DELIMS$$, \"[\\\\:]\") + \"+\"),\n        IP_LITERAL$ = subexp(\"\\\\[\" + subexp(IPV6ADDRZ_RELAXED$ + \"|\" + IPV6ADDRESS$ + \"|\" + IPVFUTURE$) + \"\\\\]\"),\n        //RFC 6874\n    REG_NAME$ = subexp(subexp(PCT_ENCODED$ + \"|\" + merge(UNRESERVED$$, SUB_DELIMS$$)) + \"*\"),\n        HOST$ = subexp(IP_LITERAL$ + \"|\" + IPV4ADDRESS$ + \"(?!\" + REG_NAME$ + \")\" + \"|\" + REG_NAME$),\n        PORT$ = subexp(DIGIT$$ + \"*\"),\n        AUTHORITY$ = subexp(subexp(USERINFO$ + \"@\") + \"?\" + HOST$ + subexp(\"\\\\:\" + PORT$) + \"?\"),\n        PCHAR$ = subexp(PCT_ENCODED$ + \"|\" + merge(UNRESERVED$$, SUB_DELIMS$$, \"[\\\\:\\\\@]\")),\n        SEGMENT$ = subexp(PCHAR$ + \"*\"),\n        SEGMENT_NZ$ = subexp(PCHAR$ + \"+\"),\n        SEGMENT_NZ_NC$ = subexp(subexp(PCT_ENCODED$ + \"|\" + merge(UNRESERVED$$, SUB_DELIMS$$, \"[\\\\@]\")) + \"+\"),\n        PATH_ABEMPTY$ = subexp(subexp(\"\\\\/\" + SEGMENT$) + \"*\"),\n        PATH_ABSOLUTE$ = subexp(\"\\\\/\" + subexp(SEGMENT_NZ$ + PATH_ABEMPTY$) + \"?\"),\n        //simplified\n    PATH_NOSCHEME$ = subexp(SEGMENT_NZ_NC$ + PATH_ABEMPTY$),\n        //simplified\n    PATH_ROOTLESS$ = subexp(SEGMENT_NZ$ + PATH_ABEMPTY$),\n        //simplified\n    PATH_EMPTY$ = \"(?!\" + PCHAR$ + \")\",\n        PATH$ = subexp(PATH_ABEMPTY$ + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_NOSCHEME$ + \"|\" + PATH_ROOTLESS$ + \"|\" + PATH_EMPTY$),\n        QUERY$ = subexp(subexp(PCHAR$ + \"|\" + merge(\"[\\\\/\\\\?]\", IPRIVATE$$)) + \"*\"),\n        FRAGMENT$ = subexp(subexp(PCHAR$ + \"|[\\\\/\\\\?]\") + \"*\"),\n        HIER_PART$ = subexp(subexp(\"\\\\/\\\\/\" + AUTHORITY$ + PATH_ABEMPTY$) + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_ROOTLESS$ + \"|\" + PATH_EMPTY$),\n        URI$ = subexp(SCHEME$ + \"\\\\:\" + HIER_PART$ + subexp(\"\\\\?\" + QUERY$) + \"?\" + subexp(\"\\\\#\" + FRAGMENT$) + \"?\"),\n        RELATIVE_PART$ = subexp(subexp(\"\\\\/\\\\/\" + AUTHORITY$ + PATH_ABEMPTY$) + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_NOSCHEME$ + \"|\" + PATH_EMPTY$),\n        RELATIVE$ = subexp(RELATIVE_PART$ + subexp(\"\\\\?\" + QUERY$) + \"?\" + subexp(\"\\\\#\" + FRAGMENT$) + \"?\"),\n        URI_REFERENCE$ = subexp(URI$ + \"|\" + RELATIVE$),\n        ABSOLUTE_URI$ = subexp(SCHEME$ + \"\\\\:\" + HIER_PART$ + subexp(\"\\\\?\" + QUERY$) + \"?\"),\n        GENERIC_REF$ = \"^(\" + SCHEME$ + \")\\\\:\" + subexp(subexp(\"\\\\/\\\\/(\" + subexp(\"(\" + USERINFO$ + \")@\") + \"?(\" + HOST$ + \")\" + subexp(\"\\\\:(\" + PORT$ + \")\") + \"?)\") + \"?(\" + PATH_ABEMPTY$ + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_ROOTLESS$ + \"|\" + PATH_EMPTY$ + \")\") + subexp(\"\\\\?(\" + QUERY$ + \")\") + \"?\" + subexp(\"\\\\#(\" + FRAGMENT$ + \")\") + \"?$\",\n        RELATIVE_REF$ = \"^(){0}\" + subexp(subexp(\"\\\\/\\\\/(\" + subexp(\"(\" + USERINFO$ + \")@\") + \"?(\" + HOST$ + \")\" + subexp(\"\\\\:(\" + PORT$ + \")\") + \"?)\") + \"?(\" + PATH_ABEMPTY$ + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_NOSCHEME$ + \"|\" + PATH_EMPTY$ + \")\") + subexp(\"\\\\?(\" + QUERY$ + \")\") + \"?\" + subexp(\"\\\\#(\" + FRAGMENT$ + \")\") + \"?$\",\n        ABSOLUTE_REF$ = \"^(\" + SCHEME$ + \")\\\\:\" + subexp(subexp(\"\\\\/\\\\/(\" + subexp(\"(\" + USERINFO$ + \")@\") + \"?(\" + HOST$ + \")\" + subexp(\"\\\\:(\" + PORT$ + \")\") + \"?)\") + \"?(\" + PATH_ABEMPTY$ + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_ROOTLESS$ + \"|\" + PATH_EMPTY$ + \")\") + subexp(\"\\\\?(\" + QUERY$ + \")\") + \"?$\",\n        SAMEDOC_REF$ = \"^\" + subexp(\"\\\\#(\" + FRAGMENT$ + \")\") + \"?$\",\n        AUTHORITY_REF$ = \"^\" + subexp(\"(\" + USERINFO$ + \")@\") + \"?(\" + HOST$ + \")\" + subexp(\"\\\\:(\" + PORT$ + \")\") + \"?$\";\n    return {\n        NOT_SCHEME: new RegExp(merge(\"[^]\", ALPHA$$, DIGIT$$, \"[\\\\+\\\\-\\\\.]\"), \"g\"),\n        NOT_USERINFO: new RegExp(merge(\"[^\\\\%\\\\:]\", UNRESERVED$$, SUB_DELIMS$$), \"g\"),\n        NOT_HOST: new RegExp(merge(\"[^\\\\%\\\\[\\\\]\\\\:]\", UNRESERVED$$, SUB_DELIMS$$), \"g\"),\n        NOT_PATH: new RegExp(merge(\"[^\\\\%\\\\/\\\\:\\\\@]\", UNRESERVED$$, SUB_DELIMS$$), \"g\"),\n        NOT_PATH_NOSCHEME: new RegExp(merge(\"[^\\\\%\\\\/\\\\@]\", UNRESERVED$$, SUB_DELIMS$$), \"g\"),\n        NOT_QUERY: new RegExp(merge(\"[^\\\\%]\", UNRESERVED$$, SUB_DELIMS$$, \"[\\\\:\\\\@\\\\/\\\\?]\", IPRIVATE$$), \"g\"),\n        NOT_FRAGMENT: new RegExp(merge(\"[^\\\\%]\", UNRESERVED$$, SUB_DELIMS$$, \"[\\\\:\\\\@\\\\/\\\\?]\"), \"g\"),\n        ESCAPE: new RegExp(merge(\"[^]\", UNRESERVED$$, SUB_DELIMS$$), \"g\"),\n        UNRESERVED: new RegExp(UNRESERVED$$, \"g\"),\n        OTHER_CHARS: new RegExp(merge(\"[^\\\\%]\", UNRESERVED$$, RESERVED$$), \"g\"),\n        PCT_ENCODED: new RegExp(PCT_ENCODED$, \"g\"),\n        IPV4ADDRESS: new RegExp(\"^(\" + IPV4ADDRESS$ + \")$\"),\n        IPV6ADDRESS: new RegExp(\"^\\\\[?(\" + IPV6ADDRESS$ + \")\" + subexp(subexp(\"\\\\%25|\\\\%(?!\" + HEXDIG$$ + \"{2})\") + \"(\" + ZONEID$ + \")\") + \"?\\\\]?$\") //RFC 6874, with relaxed parsing rules\n    };\n}\nvar URI_PROTOCOL = buildExps(false);\n\nvar IRI_PROTOCOL = buildExps(true);\n\nvar slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar toConsumableArray = function (arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n};\n\n/** Highest positive signed 32-bit float value */\n\nvar maxInt = 2147483647; // aka. 0x7FFFFFFF or 2^31-1\n\n/** Bootstring parameters */\nvar base = 36;\nvar tMin = 1;\nvar tMax = 26;\nvar skew = 38;\nvar damp = 700;\nvar initialBias = 72;\nvar initialN = 128; // 0x80\nvar delimiter = '-'; // '\\x2D'\n\n/** Regular expressions */\nvar regexPunycode = /^xn--/;\nvar regexNonASCII = /[^\\0-\\x7E]/; // non-ASCII chars\nvar regexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g; // RFC 3490 separators\n\n/** Error messages */\nvar errors = {\n\t'overflow': 'Overflow: input needs wider integers to process',\n\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t'invalid-input': 'Invalid input'\n};\n\n/** Convenience shortcuts */\nvar baseMinusTMin = base - tMin;\nvar floor = Math.floor;\nvar stringFromCharCode = String.fromCharCode;\n\n/*--------------------------------------------------------------------------*/\n\n/**\n * A generic error utility function.\n * @private\n * @param {String} type The error type.\n * @returns {Error} Throws a `RangeError` with the applicable error message.\n */\nfunction error$1(type) {\n\tthrow new RangeError(errors[type]);\n}\n\n/**\n * A generic `Array#map` utility function.\n * @private\n * @param {Array} array The array to iterate over.\n * @param {Function} callback The function that gets called for every array\n * item.\n * @returns {Array} A new array of values returned by the callback function.\n */\nfunction map(array, fn) {\n\tvar result = [];\n\tvar length = array.length;\n\twhile (length--) {\n\t\tresult[length] = fn(array[length]);\n\t}\n\treturn result;\n}\n\n/**\n * A simple `Array#map`-like wrapper to work with domain name strings or email\n * addresses.\n * @private\n * @param {String} domain The domain name or email address.\n * @param {Function} callback The function that gets called for every\n * character.\n * @returns {Array} A new string of characters returned by the callback\n * function.\n */\nfunction mapDomain(string, fn) {\n\tvar parts = string.split('@');\n\tvar result = '';\n\tif (parts.length > 1) {\n\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t// the local part (i.e. everything up to `@`) intact.\n\t\tresult = parts[0] + '@';\n\t\tstring = parts[1];\n\t}\n\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\tstring = string.replace(regexSeparators, '\\x2E');\n\tvar labels = string.split('.');\n\tvar encoded = map(labels, fn).join('.');\n\treturn result + encoded;\n}\n\n/**\n * Creates an array containing the numeric code points of each Unicode\n * character in the string. While JavaScript uses UCS-2 internally,\n * this function will convert a pair of surrogate halves (each of which\n * UCS-2 exposes as separate characters) into a single code point,\n * matching UTF-16.\n * @see `punycode.ucs2.encode`\n * @see <https://mathiasbynens.be/notes/javascript-encoding>\n * @memberOf punycode.ucs2\n * @name decode\n * @param {String} string The Unicode input string (UCS-2).\n * @returns {Array} The new array of code points.\n */\nfunction ucs2decode(string) {\n\tvar output = [];\n\tvar counter = 0;\n\tvar length = string.length;\n\twhile (counter < length) {\n\t\tvar value = string.charCodeAt(counter++);\n\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t// It's a high surrogate, and there is a next character.\n\t\t\tvar extra = string.charCodeAt(counter++);\n\t\t\tif ((extra & 0xFC00) == 0xDC00) {\n\t\t\t\t// Low surrogate.\n\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t} else {\n\t\t\t\t// It's an unmatched surrogate; only append this code unit, in case the\n\t\t\t\t// next code unit is the high surrogate of a surrogate pair.\n\t\t\t\toutput.push(value);\n\t\t\t\tcounter--;\n\t\t\t}\n\t\t} else {\n\t\t\toutput.push(value);\n\t\t}\n\t}\n\treturn output;\n}\n\n/**\n * Creates a string based on an array of numeric code points.\n * @see `punycode.ucs2.decode`\n * @memberOf punycode.ucs2\n * @name encode\n * @param {Array} codePoints The array of numeric code points.\n * @returns {String} The new Unicode string (UCS-2).\n */\nvar ucs2encode = function ucs2encode(array) {\n\treturn String.fromCodePoint.apply(String, toConsumableArray(array));\n};\n\n/**\n * Converts a basic code point into a digit/integer.\n * @see `digitToBasic()`\n * @private\n * @param {Number} codePoint The basic numeric code point value.\n * @returns {Number} The numeric value of a basic code point (for use in\n * representing integers) in the range `0` to `base - 1`, or `base` if\n * the code point does not represent a value.\n */\nvar basicToDigit = function basicToDigit(codePoint) {\n\tif (codePoint - 0x30 < 0x0A) {\n\t\treturn codePoint - 0x16;\n\t}\n\tif (codePoint - 0x41 < 0x1A) {\n\t\treturn codePoint - 0x41;\n\t}\n\tif (codePoint - 0x61 < 0x1A) {\n\t\treturn codePoint - 0x61;\n\t}\n\treturn base;\n};\n\n/**\n * Converts a digit/integer into a basic code point.\n * @see `basicToDigit()`\n * @private\n * @param {Number} digit The numeric value of a basic code point.\n * @returns {Number} The basic code point whose value (when used for\n * representing integers) is `digit`, which needs to be in the range\n * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n * used; else, the lowercase form is used. The behavior is undefined\n * if `flag` is non-zero and `digit` has no uppercase form.\n */\nvar digitToBasic = function digitToBasic(digit, flag) {\n\t//  0..25 map to ASCII a..z or A..Z\n\t// 26..35 map to ASCII 0..9\n\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n};\n\n/**\n * Bias adaptation function as per section 3.4 of RFC 3492.\n * https://tools.ietf.org/html/rfc3492#section-3.4\n * @private\n */\nvar adapt = function adapt(delta, numPoints, firstTime) {\n\tvar k = 0;\n\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\tdelta += floor(delta / numPoints);\n\tfor (; /* no initialization */delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\tdelta = floor(delta / baseMinusTMin);\n\t}\n\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n};\n\n/**\n * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n * symbols.\n * @memberOf punycode\n * @param {String} input The Punycode string of ASCII-only symbols.\n * @returns {String} The resulting string of Unicode symbols.\n */\nvar decode = function decode(input) {\n\t// Don't use UCS-2.\n\tvar output = [];\n\tvar inputLength = input.length;\n\tvar i = 0;\n\tvar n = initialN;\n\tvar bias = initialBias;\n\n\t// Handle the basic code points: let `basic` be the number of input code\n\t// points before the last delimiter, or `0` if there is none, then copy\n\t// the first basic code points to the output.\n\n\tvar basic = input.lastIndexOf(delimiter);\n\tif (basic < 0) {\n\t\tbasic = 0;\n\t}\n\n\tfor (var j = 0; j < basic; ++j) {\n\t\t// if it's not a basic code point\n\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\terror$1('not-basic');\n\t\t}\n\t\toutput.push(input.charCodeAt(j));\n\t}\n\n\t// Main decoding loop: start just after the last delimiter if any basic code\n\t// points were copied; start at the beginning otherwise.\n\n\tfor (var index = basic > 0 ? basic + 1 : 0; index < inputLength;) /* no final expression */{\n\n\t\t// `index` is the index of the next character to be consumed.\n\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t// which gets added to `i`. The overflow checking is easier\n\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t// value at the end to obtain `delta`.\n\t\tvar oldi = i;\n\t\tfor (var w = 1, k = base;; /* no condition */k += base) {\n\n\t\t\tif (index >= inputLength) {\n\t\t\t\terror$1('invalid-input');\n\t\t\t}\n\n\t\t\tvar digit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\terror$1('overflow');\n\t\t\t}\n\n\t\t\ti += digit * w;\n\t\t\tvar t = k <= bias ? tMin : k >= bias + tMax ? tMax : k - bias;\n\n\t\t\tif (digit < t) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tvar baseMinusT = base - t;\n\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\terror$1('overflow');\n\t\t\t}\n\n\t\t\tw *= baseMinusT;\n\t\t}\n\n\t\tvar out = output.length + 1;\n\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t// incrementing `n` each time, so we'll fix that now:\n\t\tif (floor(i / out) > maxInt - n) {\n\t\t\terror$1('overflow');\n\t\t}\n\n\t\tn += floor(i / out);\n\t\ti %= out;\n\n\t\t// Insert `n` at position `i` of the output.\n\t\toutput.splice(i++, 0, n);\n\t}\n\n\treturn String.fromCodePoint.apply(String, output);\n};\n\n/**\n * Converts a string of Unicode symbols (e.g. a domain name label) to a\n * Punycode string of ASCII-only symbols.\n * @memberOf punycode\n * @param {String} input The string of Unicode symbols.\n * @returns {String} The resulting Punycode string of ASCII-only symbols.\n */\nvar encode = function encode(input) {\n\tvar output = [];\n\n\t// Convert the input in UCS-2 to an array of Unicode code points.\n\tinput = ucs2decode(input);\n\n\t// Cache the length.\n\tvar inputLength = input.length;\n\n\t// Initialize the state.\n\tvar n = initialN;\n\tvar delta = 0;\n\tvar bias = initialBias;\n\n\t// Handle the basic code points.\n\tvar _iteratorNormalCompletion = true;\n\tvar _didIteratorError = false;\n\tvar _iteratorError = undefined;\n\n\ttry {\n\t\tfor (var _iterator = input[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t\t\tvar _currentValue2 = _step.value;\n\n\t\t\tif (_currentValue2 < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(_currentValue2));\n\t\t\t}\n\t\t}\n\t} catch (err) {\n\t\t_didIteratorError = true;\n\t\t_iteratorError = err;\n\t} finally {\n\t\ttry {\n\t\t\tif (!_iteratorNormalCompletion && _iterator.return) {\n\t\t\t\t_iterator.return();\n\t\t\t}\n\t\t} finally {\n\t\t\tif (_didIteratorError) {\n\t\t\t\tthrow _iteratorError;\n\t\t\t}\n\t\t}\n\t}\n\n\tvar basicLength = output.length;\n\tvar handledCPCount = basicLength;\n\n\t// `handledCPCount` is the number of code points that have been handled;\n\t// `basicLength` is the number of basic code points.\n\n\t// Finish the basic string with a delimiter unless it's empty.\n\tif (basicLength) {\n\t\toutput.push(delimiter);\n\t}\n\n\t// Main encoding loop:\n\twhile (handledCPCount < inputLength) {\n\n\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t// larger one:\n\t\tvar m = maxInt;\n\t\tvar _iteratorNormalCompletion2 = true;\n\t\tvar _didIteratorError2 = false;\n\t\tvar _iteratorError2 = undefined;\n\n\t\ttry {\n\t\t\tfor (var _iterator2 = input[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t\t\t\tvar currentValue = _step2.value;\n\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow.\n\t\t} catch (err) {\n\t\t\t_didIteratorError2 = true;\n\t\t\t_iteratorError2 = err;\n\t\t} finally {\n\t\t\ttry {\n\t\t\t\tif (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t\t\t\t\t_iterator2.return();\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tif (_didIteratorError2) {\n\t\t\t\t\tthrow _iteratorError2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar handledCPCountPlusOne = handledCPCount + 1;\n\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\terror$1('overflow');\n\t\t}\n\n\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\tn = m;\n\n\t\tvar _iteratorNormalCompletion3 = true;\n\t\tvar _didIteratorError3 = false;\n\t\tvar _iteratorError3 = undefined;\n\n\t\ttry {\n\t\t\tfor (var _iterator3 = input[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n\t\t\t\tvar _currentValue = _step3.value;\n\n\t\t\t\tif (_currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror$1('overflow');\n\t\t\t\t}\n\t\t\t\tif (_currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer.\n\t\t\t\t\tvar q = delta;\n\t\t\t\t\tfor (var k = base;; /* no condition */k += base) {\n\t\t\t\t\t\tvar t = k <= bias ? tMin : k >= bias + tMax ? tMax : k - bias;\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar qMinusT = q - t;\n\t\t\t\t\t\tvar baseMinusT = base - t;\n\t\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0)));\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (err) {\n\t\t\t_didIteratorError3 = true;\n\t\t\t_iteratorError3 = err;\n\t\t} finally {\n\t\t\ttry {\n\t\t\t\tif (!_iteratorNormalCompletion3 && _iterator3.return) {\n\t\t\t\t\t_iterator3.return();\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tif (_didIteratorError3) {\n\t\t\t\t\tthrow _iteratorError3;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t++delta;\n\t\t++n;\n\t}\n\treturn output.join('');\n};\n\n/**\n * Converts a Punycode string representing a domain name or an email address\n * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n * it doesn't matter if you call it on a string that has already been\n * converted to Unicode.\n * @memberOf punycode\n * @param {String} input The Punycoded domain name or email address to\n * convert to Unicode.\n * @returns {String} The Unicode representation of the given Punycode\n * string.\n */\nvar toUnicode = function toUnicode(input) {\n\treturn mapDomain(input, function (string) {\n\t\treturn regexPunycode.test(string) ? decode(string.slice(4).toLowerCase()) : string;\n\t});\n};\n\n/**\n * Converts a Unicode string representing a domain name or an email address to\n * Punycode. Only the non-ASCII parts of the domain name will be converted,\n * i.e. it doesn't matter if you call it with a domain that's already in\n * ASCII.\n * @memberOf punycode\n * @param {String} input The domain name or email address to convert, as a\n * Unicode string.\n * @returns {String} The Punycode representation of the given domain name or\n * email address.\n */\nvar toASCII = function toASCII(input) {\n\treturn mapDomain(input, function (string) {\n\t\treturn regexNonASCII.test(string) ? 'xn--' + encode(string) : string;\n\t});\n};\n\n/*--------------------------------------------------------------------------*/\n\n/** Define the public API */\nvar punycode = {\n\t/**\n  * A string representing the current Punycode.js version number.\n  * @memberOf punycode\n  * @type String\n  */\n\t'version': '2.1.0',\n\t/**\n  * An object of methods to convert from JavaScript's internal character\n  * representation (UCS-2) to Unicode code points, and back.\n  * @see <https://mathiasbynens.be/notes/javascript-encoding>\n  * @memberOf punycode\n  * @type Object\n  */\n\t'ucs2': {\n\t\t'decode': ucs2decode,\n\t\t'encode': ucs2encode\n\t},\n\t'decode': decode,\n\t'encode': encode,\n\t'toASCII': toASCII,\n\t'toUnicode': toUnicode\n};\n\n/**\n * URI.js\n *\n * @fileoverview An RFC 3986 compliant, scheme extendable URI parsing/validating/resolving library for JavaScript.\n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/uri-js\n */\n/**\n * Copyright 2011 Gary Court. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification, are\n * permitted provided that the following conditions are met:\n *\n *    1. Redistributions of source code must retain the above copyright notice, this list of\n *       conditions and the following disclaimer.\n *\n *    2. Redistributions in binary form must reproduce the above copyright notice, this list\n *       of conditions and the following disclaimer in the documentation and/or other materials\n *       provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY GARY COURT ``AS IS'' AND ANY EXPRESS OR IMPLIED\n * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL GARY COURT OR\n * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n * ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * The views and conclusions contained in the software and documentation are those of the\n * authors and should not be interpreted as representing official policies, either expressed\n * or implied, of Gary Court.\n */\nvar SCHEMES = {};\nfunction pctEncChar(chr) {\n    var c = chr.charCodeAt(0);\n    var e = void 0;\n    if (c < 16) e = \"%0\" + c.toString(16).toUpperCase();else if (c < 128) e = \"%\" + c.toString(16).toUpperCase();else if (c < 2048) e = \"%\" + (c >> 6 | 192).toString(16).toUpperCase() + \"%\" + (c & 63 | 128).toString(16).toUpperCase();else e = \"%\" + (c >> 12 | 224).toString(16).toUpperCase() + \"%\" + (c >> 6 & 63 | 128).toString(16).toUpperCase() + \"%\" + (c & 63 | 128).toString(16).toUpperCase();\n    return e;\n}\nfunction pctDecChars(str) {\n    var newStr = \"\";\n    var i = 0;\n    var il = str.length;\n    while (i < il) {\n        var c = parseInt(str.substr(i + 1, 2), 16);\n        if (c < 128) {\n            newStr += String.fromCharCode(c);\n            i += 3;\n        } else if (c >= 194 && c < 224) {\n            if (il - i >= 6) {\n                var c2 = parseInt(str.substr(i + 4, 2), 16);\n                newStr += String.fromCharCode((c & 31) << 6 | c2 & 63);\n            } else {\n                newStr += str.substr(i, 6);\n            }\n            i += 6;\n        } else if (c >= 224) {\n            if (il - i >= 9) {\n                var _c = parseInt(str.substr(i + 4, 2), 16);\n                var c3 = parseInt(str.substr(i + 7, 2), 16);\n                newStr += String.fromCharCode((c & 15) << 12 | (_c & 63) << 6 | c3 & 63);\n            } else {\n                newStr += str.substr(i, 9);\n            }\n            i += 9;\n        } else {\n            newStr += str.substr(i, 3);\n            i += 3;\n        }\n    }\n    return newStr;\n}\nfunction _normalizeComponentEncoding(components, protocol) {\n    function decodeUnreserved(str) {\n        var decStr = pctDecChars(str);\n        return !decStr.match(protocol.UNRESERVED) ? str : decStr;\n    }\n    if (components.scheme) components.scheme = String(components.scheme).replace(protocol.PCT_ENCODED, decodeUnreserved).toLowerCase().replace(protocol.NOT_SCHEME, \"\");\n    if (components.userinfo !== undefined) components.userinfo = String(components.userinfo).replace(protocol.PCT_ENCODED, decodeUnreserved).replace(protocol.NOT_USERINFO, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);\n    if (components.host !== undefined) components.host = String(components.host).replace(protocol.PCT_ENCODED, decodeUnreserved).toLowerCase().replace(protocol.NOT_HOST, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);\n    if (components.path !== undefined) components.path = String(components.path).replace(protocol.PCT_ENCODED, decodeUnreserved).replace(components.scheme ? protocol.NOT_PATH : protocol.NOT_PATH_NOSCHEME, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);\n    if (components.query !== undefined) components.query = String(components.query).replace(protocol.PCT_ENCODED, decodeUnreserved).replace(protocol.NOT_QUERY, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);\n    if (components.fragment !== undefined) components.fragment = String(components.fragment).replace(protocol.PCT_ENCODED, decodeUnreserved).replace(protocol.NOT_FRAGMENT, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);\n    return components;\n}\n\nfunction _stripLeadingZeros(str) {\n    return str.replace(/^0*(.*)/, \"$1\") || \"0\";\n}\nfunction _normalizeIPv4(host, protocol) {\n    var matches = host.match(protocol.IPV4ADDRESS) || [];\n\n    var _matches = slicedToArray(matches, 2),\n        address = _matches[1];\n\n    if (address) {\n        return address.split(\".\").map(_stripLeadingZeros).join(\".\");\n    } else {\n        return host;\n    }\n}\nfunction _normalizeIPv6(host, protocol) {\n    var matches = host.match(protocol.IPV6ADDRESS) || [];\n\n    var _matches2 = slicedToArray(matches, 3),\n        address = _matches2[1],\n        zone = _matches2[2];\n\n    if (address) {\n        var _address$toLowerCase$ = address.toLowerCase().split('::').reverse(),\n            _address$toLowerCase$2 = slicedToArray(_address$toLowerCase$, 2),\n            last = _address$toLowerCase$2[0],\n            first = _address$toLowerCase$2[1];\n\n        var firstFields = first ? first.split(\":\").map(_stripLeadingZeros) : [];\n        var lastFields = last.split(\":\").map(_stripLeadingZeros);\n        var isLastFieldIPv4Address = protocol.IPV4ADDRESS.test(lastFields[lastFields.length - 1]);\n        var fieldCount = isLastFieldIPv4Address ? 7 : 8;\n        var lastFieldsStart = lastFields.length - fieldCount;\n        var fields = Array(fieldCount);\n        for (var x = 0; x < fieldCount; ++x) {\n            fields[x] = firstFields[x] || lastFields[lastFieldsStart + x] || '';\n        }\n        if (isLastFieldIPv4Address) {\n            fields[fieldCount - 1] = _normalizeIPv4(fields[fieldCount - 1], protocol);\n        }\n        var allZeroFields = fields.reduce(function (acc, field, index) {\n            if (!field || field === \"0\") {\n                var lastLongest = acc[acc.length - 1];\n                if (lastLongest && lastLongest.index + lastLongest.length === index) {\n                    lastLongest.length++;\n                } else {\n                    acc.push({ index: index, length: 1 });\n                }\n            }\n            return acc;\n        }, []);\n        var longestZeroFields = allZeroFields.sort(function (a, b) {\n            return b.length - a.length;\n        })[0];\n        var newHost = void 0;\n        if (longestZeroFields && longestZeroFields.length > 1) {\n            var newFirst = fields.slice(0, longestZeroFields.index);\n            var newLast = fields.slice(longestZeroFields.index + longestZeroFields.length);\n            newHost = newFirst.join(\":\") + \"::\" + newLast.join(\":\");\n        } else {\n            newHost = fields.join(\":\");\n        }\n        if (zone) {\n            newHost += \"%\" + zone;\n        }\n        return newHost;\n    } else {\n        return host;\n    }\n}\nvar URI_PARSE = /^(?:([^:\\/?#]+):)?(?:\\/\\/((?:([^\\/?#@]*)@)?(\\[[^\\/?#\\]]+\\]|[^\\/?#:]*)(?:\\:(\\d*))?))?([^?#]*)(?:\\?([^#]*))?(?:#((?:.|\\n|\\r)*))?/i;\nvar NO_MATCH_IS_UNDEFINED = \"\".match(/(){0}/)[1] === undefined;\nfunction parse(uriString) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var components = {};\n    var protocol = options.iri !== false ? IRI_PROTOCOL : URI_PROTOCOL;\n    if (options.reference === \"suffix\") uriString = (options.scheme ? options.scheme + \":\" : \"\") + \"//\" + uriString;\n    var matches = uriString.match(URI_PARSE);\n    if (matches) {\n        if (NO_MATCH_IS_UNDEFINED) {\n            //store each component\n            components.scheme = matches[1];\n            components.userinfo = matches[3];\n            components.host = matches[4];\n            components.port = parseInt(matches[5], 10);\n            components.path = matches[6] || \"\";\n            components.query = matches[7];\n            components.fragment = matches[8];\n            //fix port number\n            if (isNaN(components.port)) {\n                components.port = matches[5];\n            }\n        } else {\n            //IE FIX for improper RegExp matching\n            //store each component\n            components.scheme = matches[1] || undefined;\n            components.userinfo = uriString.indexOf(\"@\") !== -1 ? matches[3] : undefined;\n            components.host = uriString.indexOf(\"//\") !== -1 ? matches[4] : undefined;\n            components.port = parseInt(matches[5], 10);\n            components.path = matches[6] || \"\";\n            components.query = uriString.indexOf(\"?\") !== -1 ? matches[7] : undefined;\n            components.fragment = uriString.indexOf(\"#\") !== -1 ? matches[8] : undefined;\n            //fix port number\n            if (isNaN(components.port)) {\n                components.port = uriString.match(/\\/\\/(?:.|\\n)*\\:(?:\\/|\\?|\\#|$)/) ? matches[4] : undefined;\n            }\n        }\n        if (components.host) {\n            //normalize IP hosts\n            components.host = _normalizeIPv6(_normalizeIPv4(components.host, protocol), protocol);\n        }\n        //determine reference type\n        if (components.scheme === undefined && components.userinfo === undefined && components.host === undefined && components.port === undefined && !components.path && components.query === undefined) {\n            components.reference = \"same-document\";\n        } else if (components.scheme === undefined) {\n            components.reference = \"relative\";\n        } else if (components.fragment === undefined) {\n            components.reference = \"absolute\";\n        } else {\n            components.reference = \"uri\";\n        }\n        //check for reference errors\n        if (options.reference && options.reference !== \"suffix\" && options.reference !== components.reference) {\n            components.error = components.error || \"URI is not a \" + options.reference + \" reference.\";\n        }\n        //find scheme handler\n        var schemeHandler = SCHEMES[(options.scheme || components.scheme || \"\").toLowerCase()];\n        //check if scheme can't handle IRIs\n        if (!options.unicodeSupport && (!schemeHandler || !schemeHandler.unicodeSupport)) {\n            //if host component is a domain name\n            if (components.host && (options.domainHost || schemeHandler && schemeHandler.domainHost)) {\n                //convert Unicode IDN -> ASCII IDN\n                try {\n                    components.host = punycode.toASCII(components.host.replace(protocol.PCT_ENCODED, pctDecChars).toLowerCase());\n                } catch (e) {\n                    components.error = components.error || \"Host's domain name can not be converted to ASCII via punycode: \" + e;\n                }\n            }\n            //convert IRI -> URI\n            _normalizeComponentEncoding(components, URI_PROTOCOL);\n        } else {\n            //normalize encodings\n            _normalizeComponentEncoding(components, protocol);\n        }\n        //perform scheme specific parsing\n        if (schemeHandler && schemeHandler.parse) {\n            schemeHandler.parse(components, options);\n        }\n    } else {\n        components.error = components.error || \"URI can not be parsed.\";\n    }\n    return components;\n}\n\nfunction _recomposeAuthority(components, options) {\n    var protocol = options.iri !== false ? IRI_PROTOCOL : URI_PROTOCOL;\n    var uriTokens = [];\n    if (components.userinfo !== undefined) {\n        uriTokens.push(components.userinfo);\n        uriTokens.push(\"@\");\n    }\n    if (components.host !== undefined) {\n        //normalize IP hosts, add brackets and escape zone separator for IPv6\n        uriTokens.push(_normalizeIPv6(_normalizeIPv4(String(components.host), protocol), protocol).replace(protocol.IPV6ADDRESS, function (_, $1, $2) {\n            return \"[\" + $1 + ($2 ? \"%25\" + $2 : \"\") + \"]\";\n        }));\n    }\n    if (typeof components.port === \"number\" || typeof components.port === \"string\") {\n        uriTokens.push(\":\");\n        uriTokens.push(String(components.port));\n    }\n    return uriTokens.length ? uriTokens.join(\"\") : undefined;\n}\n\nvar RDS1 = /^\\.\\.?\\//;\nvar RDS2 = /^\\/\\.(\\/|$)/;\nvar RDS3 = /^\\/\\.\\.(\\/|$)/;\nvar RDS5 = /^\\/?(?:.|\\n)*?(?=\\/|$)/;\nfunction removeDotSegments(input) {\n    var output = [];\n    while (input.length) {\n        if (input.match(RDS1)) {\n            input = input.replace(RDS1, \"\");\n        } else if (input.match(RDS2)) {\n            input = input.replace(RDS2, \"/\");\n        } else if (input.match(RDS3)) {\n            input = input.replace(RDS3, \"/\");\n            output.pop();\n        } else if (input === \".\" || input === \"..\") {\n            input = \"\";\n        } else {\n            var im = input.match(RDS5);\n            if (im) {\n                var s = im[0];\n                input = input.slice(s.length);\n                output.push(s);\n            } else {\n                throw new Error(\"Unexpected dot segment condition\");\n            }\n        }\n    }\n    return output.join(\"\");\n}\n\nfunction serialize(components) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var protocol = options.iri ? IRI_PROTOCOL : URI_PROTOCOL;\n    var uriTokens = [];\n    //find scheme handler\n    var schemeHandler = SCHEMES[(options.scheme || components.scheme || \"\").toLowerCase()];\n    //perform scheme specific serialization\n    if (schemeHandler && schemeHandler.serialize) schemeHandler.serialize(components, options);\n    if (components.host) {\n        //if host component is an IPv6 address\n        if (protocol.IPV6ADDRESS.test(components.host)) {}\n        //TODO: normalize IPv6 address as per RFC 5952\n\n        //if host component is a domain name\n        else if (options.domainHost || schemeHandler && schemeHandler.domainHost) {\n                //convert IDN via punycode\n                try {\n                    components.host = !options.iri ? punycode.toASCII(components.host.replace(protocol.PCT_ENCODED, pctDecChars).toLowerCase()) : punycode.toUnicode(components.host);\n                } catch (e) {\n                    components.error = components.error || \"Host's domain name can not be converted to \" + (!options.iri ? \"ASCII\" : \"Unicode\") + \" via punycode: \" + e;\n                }\n            }\n    }\n    //normalize encoding\n    _normalizeComponentEncoding(components, protocol);\n    if (options.reference !== \"suffix\" && components.scheme) {\n        uriTokens.push(components.scheme);\n        uriTokens.push(\":\");\n    }\n    var authority = _recomposeAuthority(components, options);\n    if (authority !== undefined) {\n        if (options.reference !== \"suffix\") {\n            uriTokens.push(\"//\");\n        }\n        uriTokens.push(authority);\n        if (components.path && components.path.charAt(0) !== \"/\") {\n            uriTokens.push(\"/\");\n        }\n    }\n    if (components.path !== undefined) {\n        var s = components.path;\n        if (!options.absolutePath && (!schemeHandler || !schemeHandler.absolutePath)) {\n            s = removeDotSegments(s);\n        }\n        if (authority === undefined) {\n            s = s.replace(/^\\/\\//, \"/%2F\"); //don't allow the path to start with \"//\"\n        }\n        uriTokens.push(s);\n    }\n    if (components.query !== undefined) {\n        uriTokens.push(\"?\");\n        uriTokens.push(components.query);\n    }\n    if (components.fragment !== undefined) {\n        uriTokens.push(\"#\");\n        uriTokens.push(components.fragment);\n    }\n    return uriTokens.join(\"\"); //merge tokens into a string\n}\n\nfunction resolveComponents(base, relative) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var skipNormalization = arguments[3];\n\n    var target = {};\n    if (!skipNormalization) {\n        base = parse(serialize(base, options), options); //normalize base components\n        relative = parse(serialize(relative, options), options); //normalize relative components\n    }\n    options = options || {};\n    if (!options.tolerant && relative.scheme) {\n        target.scheme = relative.scheme;\n        //target.authority = relative.authority;\n        target.userinfo = relative.userinfo;\n        target.host = relative.host;\n        target.port = relative.port;\n        target.path = removeDotSegments(relative.path || \"\");\n        target.query = relative.query;\n    } else {\n        if (relative.userinfo !== undefined || relative.host !== undefined || relative.port !== undefined) {\n            //target.authority = relative.authority;\n            target.userinfo = relative.userinfo;\n            target.host = relative.host;\n            target.port = relative.port;\n            target.path = removeDotSegments(relative.path || \"\");\n            target.query = relative.query;\n        } else {\n            if (!relative.path) {\n                target.path = base.path;\n                if (relative.query !== undefined) {\n                    target.query = relative.query;\n                } else {\n                    target.query = base.query;\n                }\n            } else {\n                if (relative.path.charAt(0) === \"/\") {\n                    target.path = removeDotSegments(relative.path);\n                } else {\n                    if ((base.userinfo !== undefined || base.host !== undefined || base.port !== undefined) && !base.path) {\n                        target.path = \"/\" + relative.path;\n                    } else if (!base.path) {\n                        target.path = relative.path;\n                    } else {\n                        target.path = base.path.slice(0, base.path.lastIndexOf(\"/\") + 1) + relative.path;\n                    }\n                    target.path = removeDotSegments(target.path);\n                }\n                target.query = relative.query;\n            }\n            //target.authority = base.authority;\n            target.userinfo = base.userinfo;\n            target.host = base.host;\n            target.port = base.port;\n        }\n        target.scheme = base.scheme;\n    }\n    target.fragment = relative.fragment;\n    return target;\n}\n\nfunction resolve(baseURI, relativeURI, options) {\n    var schemelessOptions = assign({ scheme: 'null' }, options);\n    return serialize(resolveComponents(parse(baseURI, schemelessOptions), parse(relativeURI, schemelessOptions), schemelessOptions, true), schemelessOptions);\n}\n\nfunction normalize(uri, options) {\n    if (typeof uri === \"string\") {\n        uri = serialize(parse(uri, options), options);\n    } else if (typeOf(uri) === \"object\") {\n        uri = parse(serialize(uri, options), options);\n    }\n    return uri;\n}\n\nfunction equal(uriA, uriB, options) {\n    if (typeof uriA === \"string\") {\n        uriA = serialize(parse(uriA, options), options);\n    } else if (typeOf(uriA) === \"object\") {\n        uriA = serialize(uriA, options);\n    }\n    if (typeof uriB === \"string\") {\n        uriB = serialize(parse(uriB, options), options);\n    } else if (typeOf(uriB) === \"object\") {\n        uriB = serialize(uriB, options);\n    }\n    return uriA === uriB;\n}\n\nfunction escapeComponent(str, options) {\n    return str && str.toString().replace(!options || !options.iri ? URI_PROTOCOL.ESCAPE : IRI_PROTOCOL.ESCAPE, pctEncChar);\n}\n\nfunction unescapeComponent(str, options) {\n    return str && str.toString().replace(!options || !options.iri ? URI_PROTOCOL.PCT_ENCODED : IRI_PROTOCOL.PCT_ENCODED, pctDecChars);\n}\n\nvar handler = {\n    scheme: \"http\",\n    domainHost: true,\n    parse: function parse(components, options) {\n        //report missing host\n        if (!components.host) {\n            components.error = components.error || \"HTTP URIs must have a host.\";\n        }\n        return components;\n    },\n    serialize: function serialize(components, options) {\n        var secure = String(components.scheme).toLowerCase() === \"https\";\n        //normalize the default port\n        if (components.port === (secure ? 443 : 80) || components.port === \"\") {\n            components.port = undefined;\n        }\n        //normalize the empty path\n        if (!components.path) {\n            components.path = \"/\";\n        }\n        //NOTE: We do not parse query strings for HTTP URIs\n        //as WWW Form Url Encoded query strings are part of the HTML4+ spec,\n        //and not the HTTP spec.\n        return components;\n    }\n};\n\nvar handler$1 = {\n    scheme: \"https\",\n    domainHost: handler.domainHost,\n    parse: handler.parse,\n    serialize: handler.serialize\n};\n\nfunction isSecure(wsComponents) {\n    return typeof wsComponents.secure === 'boolean' ? wsComponents.secure : String(wsComponents.scheme).toLowerCase() === \"wss\";\n}\n//RFC 6455\nvar handler$2 = {\n    scheme: \"ws\",\n    domainHost: true,\n    parse: function parse(components, options) {\n        var wsComponents = components;\n        //indicate if the secure flag is set\n        wsComponents.secure = isSecure(wsComponents);\n        //construct resouce name\n        wsComponents.resourceName = (wsComponents.path || '/') + (wsComponents.query ? '?' + wsComponents.query : '');\n        wsComponents.path = undefined;\n        wsComponents.query = undefined;\n        return wsComponents;\n    },\n    serialize: function serialize(wsComponents, options) {\n        //normalize the default port\n        if (wsComponents.port === (isSecure(wsComponents) ? 443 : 80) || wsComponents.port === \"\") {\n            wsComponents.port = undefined;\n        }\n        //ensure scheme matches secure flag\n        if (typeof wsComponents.secure === 'boolean') {\n            wsComponents.scheme = wsComponents.secure ? 'wss' : 'ws';\n            wsComponents.secure = undefined;\n        }\n        //reconstruct path from resource name\n        if (wsComponents.resourceName) {\n            var _wsComponents$resourc = wsComponents.resourceName.split('?'),\n                _wsComponents$resourc2 = slicedToArray(_wsComponents$resourc, 2),\n                path = _wsComponents$resourc2[0],\n                query = _wsComponents$resourc2[1];\n\n            wsComponents.path = path && path !== '/' ? path : undefined;\n            wsComponents.query = query;\n            wsComponents.resourceName = undefined;\n        }\n        //forbid fragment component\n        wsComponents.fragment = undefined;\n        return wsComponents;\n    }\n};\n\nvar handler$3 = {\n    scheme: \"wss\",\n    domainHost: handler$2.domainHost,\n    parse: handler$2.parse,\n    serialize: handler$2.serialize\n};\n\nvar O = {};\nvar isIRI = true;\n//RFC 3986\nvar UNRESERVED$$ = \"[A-Za-z0-9\\\\-\\\\.\\\\_\\\\~\" + (isIRI ? \"\\\\xA0-\\\\u200D\\\\u2010-\\\\u2029\\\\u202F-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF\" : \"\") + \"]\";\nvar HEXDIG$$ = \"[0-9A-Fa-f]\"; //case-insensitive\nvar PCT_ENCODED$ = subexp(subexp(\"%[EFef]\" + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$) + \"|\" + subexp(\"%[89A-Fa-f]\" + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$) + \"|\" + subexp(\"%\" + HEXDIG$$ + HEXDIG$$)); //expanded\n//RFC 5322, except these symbols as per RFC 6068: @ : / ? # [ ] & ; =\n//const ATEXT$$ = \"[A-Za-z0-9\\\\!\\\\#\\\\$\\\\%\\\\&\\\\'\\\\*\\\\+\\\\-\\\\/\\\\=\\\\?\\\\^\\\\_\\\\`\\\\{\\\\|\\\\}\\\\~]\";\n//const WSP$$ = \"[\\\\x20\\\\x09]\";\n//const OBS_QTEXT$$ = \"[\\\\x01-\\\\x08\\\\x0B\\\\x0C\\\\x0E-\\\\x1F\\\\x7F]\";  //(%d1-8 / %d11-12 / %d14-31 / %d127)\n//const QTEXT$$ = merge(\"[\\\\x21\\\\x23-\\\\x5B\\\\x5D-\\\\x7E]\", OBS_QTEXT$$);  //%d33 / %d35-91 / %d93-126 / obs-qtext\n//const VCHAR$$ = \"[\\\\x21-\\\\x7E]\";\n//const WSP$$ = \"[\\\\x20\\\\x09]\";\n//const OBS_QP$ = subexp(\"\\\\\\\\\" + merge(\"[\\\\x00\\\\x0D\\\\x0A]\", OBS_QTEXT$$));  //%d0 / CR / LF / obs-qtext\n//const FWS$ = subexp(subexp(WSP$$ + \"*\" + \"\\\\x0D\\\\x0A\") + \"?\" + WSP$$ + \"+\");\n//const QUOTED_PAIR$ = subexp(subexp(\"\\\\\\\\\" + subexp(VCHAR$$ + \"|\" + WSP$$)) + \"|\" + OBS_QP$);\n//const QUOTED_STRING$ = subexp('\\\\\"' + subexp(FWS$ + \"?\" + QCONTENT$) + \"*\" + FWS$ + \"?\" + '\\\\\"');\nvar ATEXT$$ = \"[A-Za-z0-9\\\\!\\\\$\\\\%\\\\'\\\\*\\\\+\\\\-\\\\^\\\\_\\\\`\\\\{\\\\|\\\\}\\\\~]\";\nvar QTEXT$$ = \"[\\\\!\\\\$\\\\%\\\\'\\\\(\\\\)\\\\*\\\\+\\\\,\\\\-\\\\.0-9\\\\<\\\\>A-Z\\\\x5E-\\\\x7E]\";\nvar VCHAR$$ = merge(QTEXT$$, \"[\\\\\\\"\\\\\\\\]\");\nvar SOME_DELIMS$$ = \"[\\\\!\\\\$\\\\'\\\\(\\\\)\\\\*\\\\+\\\\,\\\\;\\\\:\\\\@]\";\nvar UNRESERVED = new RegExp(UNRESERVED$$, \"g\");\nvar PCT_ENCODED = new RegExp(PCT_ENCODED$, \"g\");\nvar NOT_LOCAL_PART = new RegExp(merge(\"[^]\", ATEXT$$, \"[\\\\.]\", '[\\\\\"]', VCHAR$$), \"g\");\nvar NOT_HFNAME = new RegExp(merge(\"[^]\", UNRESERVED$$, SOME_DELIMS$$), \"g\");\nvar NOT_HFVALUE = NOT_HFNAME;\nfunction decodeUnreserved(str) {\n    var decStr = pctDecChars(str);\n    return !decStr.match(UNRESERVED) ? str : decStr;\n}\nvar handler$4 = {\n    scheme: \"mailto\",\n    parse: function parse$$1(components, options) {\n        var mailtoComponents = components;\n        var to = mailtoComponents.to = mailtoComponents.path ? mailtoComponents.path.split(\",\") : [];\n        mailtoComponents.path = undefined;\n        if (mailtoComponents.query) {\n            var unknownHeaders = false;\n            var headers = {};\n            var hfields = mailtoComponents.query.split(\"&\");\n            for (var x = 0, xl = hfields.length; x < xl; ++x) {\n                var hfield = hfields[x].split(\"=\");\n                switch (hfield[0]) {\n                    case \"to\":\n                        var toAddrs = hfield[1].split(\",\");\n                        for (var _x = 0, _xl = toAddrs.length; _x < _xl; ++_x) {\n                            to.push(toAddrs[_x]);\n                        }\n                        break;\n                    case \"subject\":\n                        mailtoComponents.subject = unescapeComponent(hfield[1], options);\n                        break;\n                    case \"body\":\n                        mailtoComponents.body = unescapeComponent(hfield[1], options);\n                        break;\n                    default:\n                        unknownHeaders = true;\n                        headers[unescapeComponent(hfield[0], options)] = unescapeComponent(hfield[1], options);\n                        break;\n                }\n            }\n            if (unknownHeaders) mailtoComponents.headers = headers;\n        }\n        mailtoComponents.query = undefined;\n        for (var _x2 = 0, _xl2 = to.length; _x2 < _xl2; ++_x2) {\n            var addr = to[_x2].split(\"@\");\n            addr[0] = unescapeComponent(addr[0]);\n            if (!options.unicodeSupport) {\n                //convert Unicode IDN -> ASCII IDN\n                try {\n                    addr[1] = punycode.toASCII(unescapeComponent(addr[1], options).toLowerCase());\n                } catch (e) {\n                    mailtoComponents.error = mailtoComponents.error || \"Email address's domain name can not be converted to ASCII via punycode: \" + e;\n                }\n            } else {\n                addr[1] = unescapeComponent(addr[1], options).toLowerCase();\n            }\n            to[_x2] = addr.join(\"@\");\n        }\n        return mailtoComponents;\n    },\n    serialize: function serialize$$1(mailtoComponents, options) {\n        var components = mailtoComponents;\n        var to = toArray(mailtoComponents.to);\n        if (to) {\n            for (var x = 0, xl = to.length; x < xl; ++x) {\n                var toAddr = String(to[x]);\n                var atIdx = toAddr.lastIndexOf(\"@\");\n                var localPart = toAddr.slice(0, atIdx).replace(PCT_ENCODED, decodeUnreserved).replace(PCT_ENCODED, toUpperCase).replace(NOT_LOCAL_PART, pctEncChar);\n                var domain = toAddr.slice(atIdx + 1);\n                //convert IDN via punycode\n                try {\n                    domain = !options.iri ? punycode.toASCII(unescapeComponent(domain, options).toLowerCase()) : punycode.toUnicode(domain);\n                } catch (e) {\n                    components.error = components.error || \"Email address's domain name can not be converted to \" + (!options.iri ? \"ASCII\" : \"Unicode\") + \" via punycode: \" + e;\n                }\n                to[x] = localPart + \"@\" + domain;\n            }\n            components.path = to.join(\",\");\n        }\n        var headers = mailtoComponents.headers = mailtoComponents.headers || {};\n        if (mailtoComponents.subject) headers[\"subject\"] = mailtoComponents.subject;\n        if (mailtoComponents.body) headers[\"body\"] = mailtoComponents.body;\n        var fields = [];\n        for (var name in headers) {\n            if (headers[name] !== O[name]) {\n                fields.push(name.replace(PCT_ENCODED, decodeUnreserved).replace(PCT_ENCODED, toUpperCase).replace(NOT_HFNAME, pctEncChar) + \"=\" + headers[name].replace(PCT_ENCODED, decodeUnreserved).replace(PCT_ENCODED, toUpperCase).replace(NOT_HFVALUE, pctEncChar));\n            }\n        }\n        if (fields.length) {\n            components.query = fields.join(\"&\");\n        }\n        return components;\n    }\n};\n\nvar URN_PARSE = /^([^\\:]+)\\:(.*)/;\n//RFC 2141\nvar handler$5 = {\n    scheme: \"urn\",\n    parse: function parse$$1(components, options) {\n        var matches = components.path && components.path.match(URN_PARSE);\n        var urnComponents = components;\n        if (matches) {\n            var scheme = options.scheme || urnComponents.scheme || \"urn\";\n            var nid = matches[1].toLowerCase();\n            var nss = matches[2];\n            var urnScheme = scheme + \":\" + (options.nid || nid);\n            var schemeHandler = SCHEMES[urnScheme];\n            urnComponents.nid = nid;\n            urnComponents.nss = nss;\n            urnComponents.path = undefined;\n            if (schemeHandler) {\n                urnComponents = schemeHandler.parse(urnComponents, options);\n            }\n        } else {\n            urnComponents.error = urnComponents.error || \"URN can not be parsed.\";\n        }\n        return urnComponents;\n    },\n    serialize: function serialize$$1(urnComponents, options) {\n        var scheme = options.scheme || urnComponents.scheme || \"urn\";\n        var nid = urnComponents.nid;\n        var urnScheme = scheme + \":\" + (options.nid || nid);\n        var schemeHandler = SCHEMES[urnScheme];\n        if (schemeHandler) {\n            urnComponents = schemeHandler.serialize(urnComponents, options);\n        }\n        var uriComponents = urnComponents;\n        var nss = urnComponents.nss;\n        uriComponents.path = (nid || options.nid) + \":\" + nss;\n        return uriComponents;\n    }\n};\n\nvar UUID = /^[0-9A-Fa-f]{8}(?:\\-[0-9A-Fa-f]{4}){3}\\-[0-9A-Fa-f]{12}$/;\n//RFC 4122\nvar handler$6 = {\n    scheme: \"urn:uuid\",\n    parse: function parse(urnComponents, options) {\n        var uuidComponents = urnComponents;\n        uuidComponents.uuid = uuidComponents.nss;\n        uuidComponents.nss = undefined;\n        if (!options.tolerant && (!uuidComponents.uuid || !uuidComponents.uuid.match(UUID))) {\n            uuidComponents.error = uuidComponents.error || \"UUID is not valid.\";\n        }\n        return uuidComponents;\n    },\n    serialize: function serialize(uuidComponents, options) {\n        var urnComponents = uuidComponents;\n        //normalize UUID\n        urnComponents.nss = (uuidComponents.uuid || \"\").toLowerCase();\n        return urnComponents;\n    }\n};\n\nSCHEMES[handler.scheme] = handler;\nSCHEMES[handler$1.scheme] = handler$1;\nSCHEMES[handler$2.scheme] = handler$2;\nSCHEMES[handler$3.scheme] = handler$3;\nSCHEMES[handler$4.scheme] = handler$4;\nSCHEMES[handler$5.scheme] = handler$5;\nSCHEMES[handler$6.scheme] = handler$6;\n\nexports.SCHEMES = SCHEMES;\nexports.pctEncChar = pctEncChar;\nexports.pctDecChars = pctDecChars;\nexports.parse = parse;\nexports.removeDotSegments = removeDotSegments;\nexports.serialize = serialize;\nexports.resolveComponents = resolveComponents;\nexports.resolve = resolve;\nexports.normalize = normalize;\nexports.equal = equal;\nexports.escapeComponent = escapeComponent;\nexports.unescapeComponent = unescapeComponent;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=uri.all.js.map\n","export * from \"-!../../../../mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../vue-loader/lib/loaders/stylePostLoader.js!../../../../postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!./Block.vue?vue&type=style&index=0&id=be4946b6&prod&lang=scss&\"","export * from \"-!../../../mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../vue-loader/lib/loaders/stylePostLoader.js!../../../postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../cache-loader/dist/cjs.js??ref--1-0!../../../vue-loader/lib/index.js??vue-loader-options!./ModelBuilder.vue?vue&type=style&index=0&id=46a53729&prod&lang=scss&\"","'use strict'\n\n/**\n * turns a line into a polygon using thickness\n * @param {number} x1 first point of line\n * @param {number} y1 first point of line\n * @param {number} x2 second point of line\n * @param {number} y2 second point of line\n * @param {number} thickness of line\n */\nmodule.exports = function lineToPolygon(x1, y1, x2, y2, thickness)\n{\n    const angle = Math.atan2(y2 - y1, x2 - x1) - Math.PI / 2\n    const half = thickness / 2\n    const cos = Math.cos(angle) * half\n    const sin = Math.sin(angle) * half\n    return [\n        x1 - cos, y1 - sin,\n        x2 - cos, y2 - sin,\n        x2 + cos, y2 + sin,\n        x1 + cos, y1 + sin\n    ]\n}","'use strict';\nmodule.exports = function generate_comment(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $schema = it.schema[$keyword];\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $comment = it.util.toQuotedString($schema);\n  if (it.opts.$comment === true) {\n    out += ' console.log(' + ($comment) + ');';\n  } else if (typeof it.opts.$comment == 'function') {\n    out += ' self._opts.$comment(' + ($comment) + ', ' + (it.util.toQuotedString($errSchemaPath)) + ', validate.root.schema);';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_contains(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $idx = 'i' + $lvl,\n    $dataNxt = $it.dataLevel = it.dataLevel + 1,\n    $nextData = 'data' + $dataNxt,\n    $currentBaseId = it.baseId,\n    $nonEmptySchema = (it.opts.strictKeywords ? (typeof $schema == 'object' && Object.keys($schema).length > 0) || $schema === false : it.util.schemaHasRules($schema, it.RULES.all));\n  out += 'var ' + ($errs) + ' = errors;var ' + ($valid) + ';';\n  if ($nonEmptySchema) {\n    var $wasComposite = it.compositeRule;\n    it.compositeRule = $it.compositeRule = true;\n    $it.schema = $schema;\n    $it.schemaPath = $schemaPath;\n    $it.errSchemaPath = $errSchemaPath;\n    out += ' var ' + ($nextValid) + ' = false; for (var ' + ($idx) + ' = 0; ' + ($idx) + ' < ' + ($data) + '.length; ' + ($idx) + '++) { ';\n    $it.errorPath = it.util.getPathExpr(it.errorPath, $idx, it.opts.jsonPointers, true);\n    var $passData = $data + '[' + $idx + ']';\n    $it.dataPathArr[$dataNxt] = $idx;\n    var $code = it.validate($it);\n    $it.baseId = $currentBaseId;\n    if (it.util.varOccurences($code, $nextData) < 2) {\n      out += ' ' + (it.util.varReplace($code, $nextData, $passData)) + ' ';\n    } else {\n      out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ' + ($code) + ' ';\n    }\n    out += ' if (' + ($nextValid) + ') break; }  ';\n    it.compositeRule = $it.compositeRule = $wasComposite;\n    out += ' ' + ($closingBraces) + ' if (!' + ($nextValid) + ') {';\n  } else {\n    out += ' if (' + ($data) + '.length == 0) {';\n  }\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ('contains') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: {} ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should contain a valid item\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += ' } else { ';\n  if ($nonEmptySchema) {\n    out += '  errors = ' + ($errs) + '; if (vErrors !== null) { if (' + ($errs) + ') vErrors.length = ' + ($errs) + '; else vErrors = null; } ';\n  }\n  if (it.opts.allErrors) {\n    out += ' } ';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_anyOf(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $noEmptySchema = $schema.every(function($sch) {\n    return (it.opts.strictKeywords ? (typeof $sch == 'object' && Object.keys($sch).length > 0) || $sch === false : it.util.schemaHasRules($sch, it.RULES.all));\n  });\n  if ($noEmptySchema) {\n    var $currentBaseId = $it.baseId;\n    out += ' var ' + ($errs) + ' = errors; var ' + ($valid) + ' = false;  ';\n    var $wasComposite = it.compositeRule;\n    it.compositeRule = $it.compositeRule = true;\n    var arr1 = $schema;\n    if (arr1) {\n      var $sch, $i = -1,\n        l1 = arr1.length - 1;\n      while ($i < l1) {\n        $sch = arr1[$i += 1];\n        $it.schema = $sch;\n        $it.schemaPath = $schemaPath + '[' + $i + ']';\n        $it.errSchemaPath = $errSchemaPath + '/' + $i;\n        out += '  ' + (it.validate($it)) + ' ';\n        $it.baseId = $currentBaseId;\n        out += ' ' + ($valid) + ' = ' + ($valid) + ' || ' + ($nextValid) + '; if (!' + ($valid) + ') { ';\n        $closingBraces += '}';\n      }\n    }\n    it.compositeRule = $it.compositeRule = $wasComposite;\n    out += ' ' + ($closingBraces) + ' if (!' + ($valid) + ') {   var err =   '; /* istanbul ignore else */\n    if (it.createErrors !== false) {\n      out += ' { keyword: \\'' + ('anyOf') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: {} ';\n      if (it.opts.messages !== false) {\n        out += ' , message: \\'should match some schema in anyOf\\' ';\n      }\n      if (it.opts.verbose) {\n        out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n      }\n      out += ' } ';\n    } else {\n      out += ' {} ';\n    }\n    out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n    if (!it.compositeRule && $breakOnError) {\n      /* istanbul ignore if */\n      if (it.async) {\n        out += ' throw new ValidationError(vErrors); ';\n      } else {\n        out += ' validate.errors = vErrors; return false; ';\n      }\n    }\n    out += ' } else {  errors = ' + ($errs) + '; if (vErrors !== null) { if (' + ($errs) + ') vErrors.length = ' + ($errs) + '; else vErrors = null; } ';\n    if (it.opts.allErrors) {\n      out += ' } ';\n    }\n  } else {\n    if ($breakOnError) {\n      out += ' if (true) { ';\n    }\n  }\n  return out;\n}\n","'use strict';\n\n//all requires must be explicit because browserify won't work with dynamic requires\nmodule.exports = {\n  '$ref': require('./ref'),\n  allOf: require('./allOf'),\n  anyOf: require('./anyOf'),\n  '$comment': require('./comment'),\n  const: require('./const'),\n  contains: require('./contains'),\n  dependencies: require('./dependencies'),\n  'enum': require('./enum'),\n  format: require('./format'),\n  'if': require('./if'),\n  items: require('./items'),\n  maximum: require('./_limit'),\n  minimum: require('./_limit'),\n  maxItems: require('./_limitItems'),\n  minItems: require('./_limitItems'),\n  maxLength: require('./_limitLength'),\n  minLength: require('./_limitLength'),\n  maxProperties: require('./_limitProperties'),\n  minProperties: require('./_limitProperties'),\n  multipleOf: require('./multipleOf'),\n  not: require('./not'),\n  oneOf: require('./oneOf'),\n  pattern: require('./pattern'),\n  properties: require('./properties'),\n  propertyNames: require('./propertyNames'),\n  required: require('./required'),\n  uniqueItems: require('./uniqueItems'),\n  validate: require('./validate')\n};\n","'use strict'\n\nvar boxPoint = require('./box-point')\nvar lineLine = require('./line-line')\n\n/**\n * line-box collision\n number @param {number} x1 point 1 of line\n number @param {number} y1 point 1 of line\n number @param {number} x2 point 2 of line\n number @param {number} y2 point 2 of line\n number @param {number} xb top-left of box\n number @param {number} yb top-left of box\n number @param {number} wb width of box\n number @param {number} hb height of box\n */\nmodule.exports = function lineBox(x1, y1, x2, y2, xb, yb, wb, hb)\n{\n    if (boxPoint(xb, yb, wb, hb, x1, y1) || boxPoint(xb, yb, wb, hb, x2, y2))\n    {\n        return true\n    }\n    return lineLine(x1, y1, x2, y2, xb, yb, xb + wb, yb) ||\n        lineLine(x1, y1, x2, y2, xb + wb, yb, xb + wb, yb + hb) ||\n        lineLine(x1, y1, x2, y2, xb, yb + hb, xb + wb, yb + hb) ||\n        lineLine(x1, y1, x2, y2, xb, yb, xb, yb + hb)\n}\n","'use strict';\n\nvar KEYWORDS = [\n  'multipleOf',\n  'maximum',\n  'exclusiveMaximum',\n  'minimum',\n  'exclusiveMinimum',\n  'maxLength',\n  'minLength',\n  'pattern',\n  'additionalItems',\n  'maxItems',\n  'minItems',\n  'uniqueItems',\n  'maxProperties',\n  'minProperties',\n  'required',\n  'additionalProperties',\n  'enum',\n  'format',\n  'const'\n];\n\nmodule.exports = function (metaSchema, keywordsJsonPointers) {\n  for (var i=0; i<keywordsJsonPointers.length; i++) {\n    metaSchema = JSON.parse(JSON.stringify(metaSchema));\n    var segments = keywordsJsonPointers[i].split('/');\n    var keywords = metaSchema;\n    var j;\n    for (j=1; j<segments.length; j++)\n      keywords = keywords[segments[j]];\n\n    for (j=0; j<KEYWORDS.length; j++) {\n      var key = KEYWORDS[j];\n      var schema = keywords[key];\n      if (schema) {\n        keywords[key] = {\n          anyOf: [\n            schema,\n            { $ref: 'https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#' }\n          ]\n        };\n      }\n    }\n  }\n\n  return metaSchema;\n};\n","/**\r\n * A list of errors.\r\n * \r\n * @class\r\n */\r\nclass ErrorList {\r\n\r\n\tconstructor() {\r\n\t\tthis.errors = [];\r\n\t}\r\n\r\n\tfirst() {\r\n\t\treturn this.errors[0] || null;\r\n\t}\r\n\r\n\tlast() {\r\n\t\treturn this.errors[this.errors.length-1] || null;\r\n\t}\r\n\r\n\tmerge(errorList) {\r\n\t\tthis.errors = this.errors.concat(errorList.getAll());\r\n\t}\r\n\t\r\n\tadd(error) {\r\n\t\tthis.errors.push(error);\r\n\t}\r\n\r\n\tcount() {\r\n\t\treturn this.errors.length;\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\treturn this.errors.map(e => {\r\n\t\t\tif (typeof e.toJSON === 'function') {\r\n\t\t\t\treturn e.toJSON();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tcode: 'InternalError',\r\n\t\t\t\t\tmessage: e.message\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tgetMessage() {\r\n\t\tvar msg = '';\r\n\t\tfor (var i in this.errors) {\r\n\t\t\tmsg += (parseInt(i, 10)+1) + \". \" + this.errors[i].message + \"\\r\\n\";\r\n\t\t}\r\n\t\treturn msg.trim();\r\n\t}\r\n\r\n\tgetAll() {\r\n\t\treturn this.errors;\r\n\t}\r\n\r\n}\r\n\r\nmodule.exports = ErrorList;","'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n","'use strict';\nmodule.exports = function generate_propertyNames(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  out += 'var ' + ($errs) + ' = errors;';\n  if ((it.opts.strictKeywords ? (typeof $schema == 'object' && Object.keys($schema).length > 0) || $schema === false : it.util.schemaHasRules($schema, it.RULES.all))) {\n    $it.schema = $schema;\n    $it.schemaPath = $schemaPath;\n    $it.errSchemaPath = $errSchemaPath;\n    var $key = 'key' + $lvl,\n      $idx = 'idx' + $lvl,\n      $i = 'i' + $lvl,\n      $invalidName = '\\' + ' + $key + ' + \\'',\n      $dataNxt = $it.dataLevel = it.dataLevel + 1,\n      $nextData = 'data' + $dataNxt,\n      $dataProperties = 'dataProperties' + $lvl,\n      $ownProperties = it.opts.ownProperties,\n      $currentBaseId = it.baseId;\n    if ($ownProperties) {\n      out += ' var ' + ($dataProperties) + ' = undefined; ';\n    }\n    if ($ownProperties) {\n      out += ' ' + ($dataProperties) + ' = ' + ($dataProperties) + ' || Object.keys(' + ($data) + '); for (var ' + ($idx) + '=0; ' + ($idx) + '<' + ($dataProperties) + '.length; ' + ($idx) + '++) { var ' + ($key) + ' = ' + ($dataProperties) + '[' + ($idx) + ']; ';\n    } else {\n      out += ' for (var ' + ($key) + ' in ' + ($data) + ') { ';\n    }\n    out += ' var startErrs' + ($lvl) + ' = errors; ';\n    var $passData = $key;\n    var $wasComposite = it.compositeRule;\n    it.compositeRule = $it.compositeRule = true;\n    var $code = it.validate($it);\n    $it.baseId = $currentBaseId;\n    if (it.util.varOccurences($code, $nextData) < 2) {\n      out += ' ' + (it.util.varReplace($code, $nextData, $passData)) + ' ';\n    } else {\n      out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ' + ($code) + ' ';\n    }\n    it.compositeRule = $it.compositeRule = $wasComposite;\n    out += ' if (!' + ($nextValid) + ') { for (var ' + ($i) + '=startErrs' + ($lvl) + '; ' + ($i) + '<errors; ' + ($i) + '++) { vErrors[' + ($i) + '].propertyName = ' + ($key) + '; }   var err =   '; /* istanbul ignore else */\n    if (it.createErrors !== false) {\n      out += ' { keyword: \\'' + ('propertyNames') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { propertyName: \\'' + ($invalidName) + '\\' } ';\n      if (it.opts.messages !== false) {\n        out += ' , message: \\'property name \\\\\\'' + ($invalidName) + '\\\\\\' is invalid\\' ';\n      }\n      if (it.opts.verbose) {\n        out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n      }\n      out += ' } ';\n    } else {\n      out += ' {} ';\n    }\n    out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n    if (!it.compositeRule && $breakOnError) {\n      /* istanbul ignore if */\n      if (it.async) {\n        out += ' throw new ValidationError(vErrors); ';\n      } else {\n        out += ' validate.errors = vErrors; return false; ';\n      }\n    }\n    if ($breakOnError) {\n      out += ' break; ';\n    }\n    out += ' } }';\n  }\n  if ($breakOnError) {\n    out += ' ' + ($closingBraces) + ' if (' + ($errs) + ' == errors) {';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_ref(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $async, $refCode;\n  if ($schema == '#' || $schema == '#/') {\n    if (it.isRoot) {\n      $async = it.async;\n      $refCode = 'validate';\n    } else {\n      $async = it.root.schema.$async === true;\n      $refCode = 'root.refVal[0]';\n    }\n  } else {\n    var $refVal = it.resolveRef(it.baseId, $schema, it.isRoot);\n    if ($refVal === undefined) {\n      var $message = it.MissingRefError.message(it.baseId, $schema);\n      if (it.opts.missingRefs == 'fail') {\n        it.logger.error($message);\n        var $$outStack = $$outStack || [];\n        $$outStack.push(out);\n        out = ''; /* istanbul ignore else */\n        if (it.createErrors !== false) {\n          out += ' { keyword: \\'' + ('$ref') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { ref: \\'' + (it.util.escapeQuotes($schema)) + '\\' } ';\n          if (it.opts.messages !== false) {\n            out += ' , message: \\'can\\\\\\'t resolve reference ' + (it.util.escapeQuotes($schema)) + '\\' ';\n          }\n          if (it.opts.verbose) {\n            out += ' , schema: ' + (it.util.toQuotedString($schema)) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n          }\n          out += ' } ';\n        } else {\n          out += ' {} ';\n        }\n        var __err = out;\n        out = $$outStack.pop();\n        if (!it.compositeRule && $breakOnError) {\n          /* istanbul ignore if */\n          if (it.async) {\n            out += ' throw new ValidationError([' + (__err) + ']); ';\n          } else {\n            out += ' validate.errors = [' + (__err) + ']; return false; ';\n          }\n        } else {\n          out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n        }\n        if ($breakOnError) {\n          out += ' if (false) { ';\n        }\n      } else if (it.opts.missingRefs == 'ignore') {\n        it.logger.warn($message);\n        if ($breakOnError) {\n          out += ' if (true) { ';\n        }\n      } else {\n        throw new it.MissingRefError(it.baseId, $schema, $message);\n      }\n    } else if ($refVal.inline) {\n      var $it = it.util.copy(it);\n      $it.level++;\n      var $nextValid = 'valid' + $it.level;\n      $it.schema = $refVal.schema;\n      $it.schemaPath = '';\n      $it.errSchemaPath = $schema;\n      var $code = it.validate($it).replace(/validate\\.schema/g, $refVal.code);\n      out += ' ' + ($code) + ' ';\n      if ($breakOnError) {\n        out += ' if (' + ($nextValid) + ') { ';\n      }\n    } else {\n      $async = $refVal.$async === true || (it.async && $refVal.$async !== false);\n      $refCode = $refVal.code;\n    }\n  }\n  if ($refCode) {\n    var $$outStack = $$outStack || [];\n    $$outStack.push(out);\n    out = '';\n    if (it.opts.passContext) {\n      out += ' ' + ($refCode) + '.call(this, ';\n    } else {\n      out += ' ' + ($refCode) + '( ';\n    }\n    out += ' ' + ($data) + ', (dataPath || \\'\\')';\n    if (it.errorPath != '\"\"') {\n      out += ' + ' + (it.errorPath);\n    }\n    var $parentData = $dataLvl ? 'data' + (($dataLvl - 1) || '') : 'parentData',\n      $parentDataProperty = $dataLvl ? it.dataPathArr[$dataLvl] : 'parentDataProperty';\n    out += ' , ' + ($parentData) + ' , ' + ($parentDataProperty) + ', rootData)  ';\n    var __callValidate = out;\n    out = $$outStack.pop();\n    if ($async) {\n      if (!it.async) throw new Error('async schema referenced by sync schema');\n      if ($breakOnError) {\n        out += ' var ' + ($valid) + '; ';\n      }\n      out += ' try { await ' + (__callValidate) + '; ';\n      if ($breakOnError) {\n        out += ' ' + ($valid) + ' = true; ';\n      }\n      out += ' } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ';\n      if ($breakOnError) {\n        out += ' ' + ($valid) + ' = false; ';\n      }\n      out += ' } ';\n      if ($breakOnError) {\n        out += ' if (' + ($valid) + ') { ';\n      }\n    } else {\n      out += ' if (!' + (__callValidate) + ') { if (vErrors === null) vErrors = ' + ($refCode) + '.errors; else vErrors = vErrors.concat(' + ($refCode) + '.errors); errors = vErrors.length; } ';\n      if ($breakOnError) {\n        out += ' else { ';\n      }\n    }\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_pattern(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  var $regexp = $isData ? '(new RegExp(' + $schemaValue + '))' : it.usePattern($schema);\n  out += 'if ( ';\n  if ($isData) {\n    out += ' (' + ($schemaValue) + ' !== undefined && typeof ' + ($schemaValue) + ' != \\'string\\') || ';\n  }\n  out += ' !' + ($regexp) + '.test(' + ($data) + ') ) {   ';\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ('pattern') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { pattern:  ';\n    if ($isData) {\n      out += '' + ($schemaValue);\n    } else {\n      out += '' + (it.util.toQuotedString($schema));\n    }\n    out += '  } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should match pattern \"';\n      if ($isData) {\n        out += '\\' + ' + ($schemaValue) + ' + \\'';\n      } else {\n        out += '' + (it.util.escapeQuotes($schema));\n      }\n      out += '\"\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema:  ';\n      if ($isData) {\n        out += 'validate.schema' + ($schemaPath);\n      } else {\n        out += '' + (it.util.toQuotedString($schema));\n      }\n      out += '         , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += '} ';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_custom(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $errorKeyword;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $errs = 'errs__' + $lvl;\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  var $rule = this,\n    $definition = 'definition' + $lvl,\n    $rDef = $rule.definition,\n    $closingBraces = '';\n  var $compile, $inline, $macro, $ruleValidate, $validateCode;\n  if ($isData && $rDef.$data) {\n    $validateCode = 'keywordValidate' + $lvl;\n    var $validateSchema = $rDef.validateSchema;\n    out += ' var ' + ($definition) + ' = RULES.custom[\\'' + ($keyword) + '\\'].definition; var ' + ($validateCode) + ' = ' + ($definition) + '.validate;';\n  } else {\n    $ruleValidate = it.useCustomRule($rule, $schema, it.schema, it);\n    if (!$ruleValidate) return;\n    $schemaValue = 'validate.schema' + $schemaPath;\n    $validateCode = $ruleValidate.code;\n    $compile = $rDef.compile;\n    $inline = $rDef.inline;\n    $macro = $rDef.macro;\n  }\n  var $ruleErrs = $validateCode + '.errors',\n    $i = 'i' + $lvl,\n    $ruleErr = 'ruleErr' + $lvl,\n    $asyncKeyword = $rDef.async;\n  if ($asyncKeyword && !it.async) throw new Error('async keyword in sync schema');\n  if (!($inline || $macro)) {\n    out += '' + ($ruleErrs) + ' = null;';\n  }\n  out += 'var ' + ($errs) + ' = errors;var ' + ($valid) + ';';\n  if ($isData && $rDef.$data) {\n    $closingBraces += '}';\n    out += ' if (' + ($schemaValue) + ' === undefined) { ' + ($valid) + ' = true; } else { ';\n    if ($validateSchema) {\n      $closingBraces += '}';\n      out += ' ' + ($valid) + ' = ' + ($definition) + '.validateSchema(' + ($schemaValue) + '); if (' + ($valid) + ') { ';\n    }\n  }\n  if ($inline) {\n    if ($rDef.statements) {\n      out += ' ' + ($ruleValidate.validate) + ' ';\n    } else {\n      out += ' ' + ($valid) + ' = ' + ($ruleValidate.validate) + '; ';\n    }\n  } else if ($macro) {\n    var $it = it.util.copy(it);\n    var $closingBraces = '';\n    $it.level++;\n    var $nextValid = 'valid' + $it.level;\n    $it.schema = $ruleValidate.validate;\n    $it.schemaPath = '';\n    var $wasComposite = it.compositeRule;\n    it.compositeRule = $it.compositeRule = true;\n    var $code = it.validate($it).replace(/validate\\.schema/g, $validateCode);\n    it.compositeRule = $it.compositeRule = $wasComposite;\n    out += ' ' + ($code);\n  } else {\n    var $$outStack = $$outStack || [];\n    $$outStack.push(out);\n    out = '';\n    out += '  ' + ($validateCode) + '.call( ';\n    if (it.opts.passContext) {\n      out += 'this';\n    } else {\n      out += 'self';\n    }\n    if ($compile || $rDef.schema === false) {\n      out += ' , ' + ($data) + ' ';\n    } else {\n      out += ' , ' + ($schemaValue) + ' , ' + ($data) + ' , validate.schema' + (it.schemaPath) + ' ';\n    }\n    out += ' , (dataPath || \\'\\')';\n    if (it.errorPath != '\"\"') {\n      out += ' + ' + (it.errorPath);\n    }\n    var $parentData = $dataLvl ? 'data' + (($dataLvl - 1) || '') : 'parentData',\n      $parentDataProperty = $dataLvl ? it.dataPathArr[$dataLvl] : 'parentDataProperty';\n    out += ' , ' + ($parentData) + ' , ' + ($parentDataProperty) + ' , rootData )  ';\n    var def_callRuleValidate = out;\n    out = $$outStack.pop();\n    if ($rDef.errors === false) {\n      out += ' ' + ($valid) + ' = ';\n      if ($asyncKeyword) {\n        out += 'await ';\n      }\n      out += '' + (def_callRuleValidate) + '; ';\n    } else {\n      if ($asyncKeyword) {\n        $ruleErrs = 'customErrors' + $lvl;\n        out += ' var ' + ($ruleErrs) + ' = null; try { ' + ($valid) + ' = await ' + (def_callRuleValidate) + '; } catch (e) { ' + ($valid) + ' = false; if (e instanceof ValidationError) ' + ($ruleErrs) + ' = e.errors; else throw e; } ';\n      } else {\n        out += ' ' + ($ruleErrs) + ' = null; ' + ($valid) + ' = ' + (def_callRuleValidate) + '; ';\n      }\n    }\n  }\n  if ($rDef.modifying) {\n    out += ' if (' + ($parentData) + ') ' + ($data) + ' = ' + ($parentData) + '[' + ($parentDataProperty) + '];';\n  }\n  out += '' + ($closingBraces);\n  if ($rDef.valid) {\n    if ($breakOnError) {\n      out += ' if (true) { ';\n    }\n  } else {\n    out += ' if ( ';\n    if ($rDef.valid === undefined) {\n      out += ' !';\n      if ($macro) {\n        out += '' + ($nextValid);\n      } else {\n        out += '' + ($valid);\n      }\n    } else {\n      out += ' ' + (!$rDef.valid) + ' ';\n    }\n    out += ') { ';\n    $errorKeyword = $rule.keyword;\n    var $$outStack = $$outStack || [];\n    $$outStack.push(out);\n    out = '';\n    var $$outStack = $$outStack || [];\n    $$outStack.push(out);\n    out = ''; /* istanbul ignore else */\n    if (it.createErrors !== false) {\n      out += ' { keyword: \\'' + ($errorKeyword || 'custom') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { keyword: \\'' + ($rule.keyword) + '\\' } ';\n      if (it.opts.messages !== false) {\n        out += ' , message: \\'should pass \"' + ($rule.keyword) + '\" keyword validation\\' ';\n      }\n      if (it.opts.verbose) {\n        out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n      }\n      out += ' } ';\n    } else {\n      out += ' {} ';\n    }\n    var __err = out;\n    out = $$outStack.pop();\n    if (!it.compositeRule && $breakOnError) {\n      /* istanbul ignore if */\n      if (it.async) {\n        out += ' throw new ValidationError([' + (__err) + ']); ';\n      } else {\n        out += ' validate.errors = [' + (__err) + ']; return false; ';\n      }\n    } else {\n      out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n    }\n    var def_customError = out;\n    out = $$outStack.pop();\n    if ($inline) {\n      if ($rDef.errors) {\n        if ($rDef.errors != 'full') {\n          out += '  for (var ' + ($i) + '=' + ($errs) + '; ' + ($i) + '<errors; ' + ($i) + '++) { var ' + ($ruleErr) + ' = vErrors[' + ($i) + ']; if (' + ($ruleErr) + '.dataPath === undefined) ' + ($ruleErr) + '.dataPath = (dataPath || \\'\\') + ' + (it.errorPath) + '; if (' + ($ruleErr) + '.schemaPath === undefined) { ' + ($ruleErr) + '.schemaPath = \"' + ($errSchemaPath) + '\"; } ';\n          if (it.opts.verbose) {\n            out += ' ' + ($ruleErr) + '.schema = ' + ($schemaValue) + '; ' + ($ruleErr) + '.data = ' + ($data) + '; ';\n          }\n          out += ' } ';\n        }\n      } else {\n        if ($rDef.errors === false) {\n          out += ' ' + (def_customError) + ' ';\n        } else {\n          out += ' if (' + ($errs) + ' == errors) { ' + (def_customError) + ' } else {  for (var ' + ($i) + '=' + ($errs) + '; ' + ($i) + '<errors; ' + ($i) + '++) { var ' + ($ruleErr) + ' = vErrors[' + ($i) + ']; if (' + ($ruleErr) + '.dataPath === undefined) ' + ($ruleErr) + '.dataPath = (dataPath || \\'\\') + ' + (it.errorPath) + '; if (' + ($ruleErr) + '.schemaPath === undefined) { ' + ($ruleErr) + '.schemaPath = \"' + ($errSchemaPath) + '\"; } ';\n          if (it.opts.verbose) {\n            out += ' ' + ($ruleErr) + '.schema = ' + ($schemaValue) + '; ' + ($ruleErr) + '.data = ' + ($data) + '; ';\n          }\n          out += ' } } ';\n        }\n      }\n    } else if ($macro) {\n      out += '   var err =   '; /* istanbul ignore else */\n      if (it.createErrors !== false) {\n        out += ' { keyword: \\'' + ($errorKeyword || 'custom') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { keyword: \\'' + ($rule.keyword) + '\\' } ';\n        if (it.opts.messages !== false) {\n          out += ' , message: \\'should pass \"' + ($rule.keyword) + '\" keyword validation\\' ';\n        }\n        if (it.opts.verbose) {\n          out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n        }\n        out += ' } ';\n      } else {\n        out += ' {} ';\n      }\n      out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n      if (!it.compositeRule && $breakOnError) {\n        /* istanbul ignore if */\n        if (it.async) {\n          out += ' throw new ValidationError(vErrors); ';\n        } else {\n          out += ' validate.errors = vErrors; return false; ';\n        }\n      }\n    } else {\n      if ($rDef.errors === false) {\n        out += ' ' + (def_customError) + ' ';\n      } else {\n        out += ' if (Array.isArray(' + ($ruleErrs) + ')) { if (vErrors === null) vErrors = ' + ($ruleErrs) + '; else vErrors = vErrors.concat(' + ($ruleErrs) + '); errors = vErrors.length;  for (var ' + ($i) + '=' + ($errs) + '; ' + ($i) + '<errors; ' + ($i) + '++) { var ' + ($ruleErr) + ' = vErrors[' + ($i) + ']; if (' + ($ruleErr) + '.dataPath === undefined) ' + ($ruleErr) + '.dataPath = (dataPath || \\'\\') + ' + (it.errorPath) + ';  ' + ($ruleErr) + '.schemaPath = \"' + ($errSchemaPath) + '\";  ';\n        if (it.opts.verbose) {\n          out += ' ' + ($ruleErr) + '.schema = ' + ($schemaValue) + '; ' + ($ruleErr) + '.data = ' + ($data) + '; ';\n        }\n        out += ' } } else { ' + (def_customError) + ' } ';\n      }\n    }\n    out += ' } ';\n    if ($breakOnError) {\n      out += ' else { ';\n    }\n  }\n  return out;\n}\n","'use strict';\n\n// https://mathiasbynens.be/notes/javascript-encoding\n// https://github.com/bestiejs/punycode.js - punycode.ucs2.decode\nmodule.exports = function ucs2length(str) {\n  var length = 0\n    , len = str.length\n    , pos = 0\n    , value;\n  while (pos < len) {\n    length++;\n    value = str.charCodeAt(pos++);\n    if (value >= 0xD800 && value <= 0xDBFF && pos < len) {\n      // high surrogate, and there is a next character\n      value = str.charCodeAt(pos);\n      if ((value & 0xFC00) == 0xDC00) pos++; // low surrogate\n    }\n  }\n  return length;\n};\n","'use strict';\nmodule.exports = function generate__limitProperties(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $errorKeyword;\n  var $data = 'data' + ($dataLvl || '');\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  if (!($isData || typeof $schema == 'number')) {\n    throw new Error($keyword + ' must be number');\n  }\n  var $op = $keyword == 'maxProperties' ? '>' : '<';\n  out += 'if ( ';\n  if ($isData) {\n    out += ' (' + ($schemaValue) + ' !== undefined && typeof ' + ($schemaValue) + ' != \\'number\\') || ';\n  }\n  out += ' Object.keys(' + ($data) + ').length ' + ($op) + ' ' + ($schemaValue) + ') { ';\n  var $errorKeyword = $keyword;\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ($errorKeyword || '_limitProperties') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { limit: ' + ($schemaValue) + ' } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should NOT have ';\n      if ($keyword == 'maxProperties') {\n        out += 'more';\n      } else {\n        out += 'fewer';\n      }\n      out += ' than ';\n      if ($isData) {\n        out += '\\' + ' + ($schemaValue) + ' + \\'';\n      } else {\n        out += '' + ($schema);\n      }\n      out += ' properties\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema:  ';\n      if ($isData) {\n        out += 'validate.schema' + ($schemaPath);\n      } else {\n        out += '' + ($schema);\n      }\n      out += '         , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += '} ';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict';\n\nvar compileSchema = require('./compile')\n  , resolve = require('./compile/resolve')\n  , Cache = require('./cache')\n  , SchemaObject = require('./compile/schema_obj')\n  , stableStringify = require('fast-json-stable-stringify')\n  , formats = require('./compile/formats')\n  , rules = require('./compile/rules')\n  , $dataMetaSchema = require('./data')\n  , util = require('./compile/util');\n\nmodule.exports = Ajv;\n\nAjv.prototype.validate = validate;\nAjv.prototype.compile = compile;\nAjv.prototype.addSchema = addSchema;\nAjv.prototype.addMetaSchema = addMetaSchema;\nAjv.prototype.validateSchema = validateSchema;\nAjv.prototype.getSchema = getSchema;\nAjv.prototype.removeSchema = removeSchema;\nAjv.prototype.addFormat = addFormat;\nAjv.prototype.errorsText = errorsText;\n\nAjv.prototype._addSchema = _addSchema;\nAjv.prototype._compile = _compile;\n\nAjv.prototype.compileAsync = require('./compile/async');\nvar customKeyword = require('./keyword');\nAjv.prototype.addKeyword = customKeyword.add;\nAjv.prototype.getKeyword = customKeyword.get;\nAjv.prototype.removeKeyword = customKeyword.remove;\nAjv.prototype.validateKeyword = customKeyword.validate;\n\nvar errorClasses = require('./compile/error_classes');\nAjv.ValidationError = errorClasses.Validation;\nAjv.MissingRefError = errorClasses.MissingRef;\nAjv.$dataMetaSchema = $dataMetaSchema;\n\nvar META_SCHEMA_ID = 'http://json-schema.org/draft-07/schema';\n\nvar META_IGNORE_OPTIONS = [ 'removeAdditional', 'useDefaults', 'coerceTypes', 'strictDefaults' ];\nvar META_SUPPORT_DATA = ['/properties'];\n\n/**\n * Creates validator instance.\n * Usage: `Ajv(opts)`\n * @param {Object} opts optional options\n * @return {Object} ajv instance\n */\nfunction Ajv(opts) {\n  if (!(this instanceof Ajv)) return new Ajv(opts);\n  opts = this._opts = util.copy(opts) || {};\n  setLogger(this);\n  this._schemas = {};\n  this._refs = {};\n  this._fragments = {};\n  this._formats = formats(opts.format);\n\n  this._cache = opts.cache || new Cache;\n  this._loadingSchemas = {};\n  this._compilations = [];\n  this.RULES = rules();\n  this._getId = chooseGetId(opts);\n\n  opts.loopRequired = opts.loopRequired || Infinity;\n  if (opts.errorDataPath == 'property') opts._errorDataPathProperty = true;\n  if (opts.serialize === undefined) opts.serialize = stableStringify;\n  this._metaOpts = getMetaSchemaOptions(this);\n\n  if (opts.formats) addInitialFormats(this);\n  if (opts.keywords) addInitialKeywords(this);\n  addDefaultMetaSchema(this);\n  if (typeof opts.meta == 'object') this.addMetaSchema(opts.meta);\n  if (opts.nullable) this.addKeyword('nullable', {metaSchema: {type: 'boolean'}});\n  addInitialSchemas(this);\n}\n\n\n\n/**\n * Validate data using schema\n * Schema will be compiled and cached (using serialized JSON as key. [fast-json-stable-stringify](https://github.com/epoberezkin/fast-json-stable-stringify) is used to serialize.\n * @this   Ajv\n * @param  {String|Object} schemaKeyRef key, ref or schema object\n * @param  {Any} data to be validated\n * @return {Boolean} validation result. Errors from the last validation will be available in `ajv.errors` (and also in compiled schema: `schema.errors`).\n */\nfunction validate(schemaKeyRef, data) {\n  var v;\n  if (typeof schemaKeyRef == 'string') {\n    v = this.getSchema(schemaKeyRef);\n    if (!v) throw new Error('no schema with key or ref \"' + schemaKeyRef + '\"');\n  } else {\n    var schemaObj = this._addSchema(schemaKeyRef);\n    v = schemaObj.validate || this._compile(schemaObj);\n  }\n\n  var valid = v(data);\n  if (v.$async !== true) this.errors = v.errors;\n  return valid;\n}\n\n\n/**\n * Create validating function for passed schema.\n * @this   Ajv\n * @param  {Object} schema schema object\n * @param  {Boolean} _meta true if schema is a meta-schema. Used internally to compile meta schemas of custom keywords.\n * @return {Function} validating function\n */\nfunction compile(schema, _meta) {\n  var schemaObj = this._addSchema(schema, undefined, _meta);\n  return schemaObj.validate || this._compile(schemaObj);\n}\n\n\n/**\n * Adds schema to the instance.\n * @this   Ajv\n * @param {Object|Array} schema schema or array of schemas. If array is passed, `key` and other parameters will be ignored.\n * @param {String} key Optional schema key. Can be passed to `validate` method instead of schema object or id/ref. One schema per instance can have empty `id` and `key`.\n * @param {Boolean} _skipValidation true to skip schema validation. Used internally, option validateSchema should be used instead.\n * @param {Boolean} _meta true if schema is a meta-schema. Used internally, addMetaSchema should be used instead.\n * @return {Ajv} this for method chaining\n */\nfunction addSchema(schema, key, _skipValidation, _meta) {\n  if (Array.isArray(schema)){\n    for (var i=0; i<schema.length; i++) this.addSchema(schema[i], undefined, _skipValidation, _meta);\n    return this;\n  }\n  var id = this._getId(schema);\n  if (id !== undefined && typeof id != 'string')\n    throw new Error('schema id must be string');\n  key = resolve.normalizeId(key || id);\n  checkUnique(this, key);\n  this._schemas[key] = this._addSchema(schema, _skipValidation, _meta, true);\n  return this;\n}\n\n\n/**\n * Add schema that will be used to validate other schemas\n * options in META_IGNORE_OPTIONS are alway set to false\n * @this   Ajv\n * @param {Object} schema schema object\n * @param {String} key optional schema key\n * @param {Boolean} skipValidation true to skip schema validation, can be used to override validateSchema option for meta-schema\n * @return {Ajv} this for method chaining\n */\nfunction addMetaSchema(schema, key, skipValidation) {\n  this.addSchema(schema, key, skipValidation, true);\n  return this;\n}\n\n\n/**\n * Validate schema\n * @this   Ajv\n * @param {Object} schema schema to validate\n * @param {Boolean} throwOrLogError pass true to throw (or log) an error if invalid\n * @return {Boolean} true if schema is valid\n */\nfunction validateSchema(schema, throwOrLogError) {\n  var $schema = schema.$schema;\n  if ($schema !== undefined && typeof $schema != 'string')\n    throw new Error('$schema must be a string');\n  $schema = $schema || this._opts.defaultMeta || defaultMeta(this);\n  if (!$schema) {\n    this.logger.warn('meta-schema not available');\n    this.errors = null;\n    return true;\n  }\n  var valid = this.validate($schema, schema);\n  if (!valid && throwOrLogError) {\n    var message = 'schema is invalid: ' + this.errorsText();\n    if (this._opts.validateSchema == 'log') this.logger.error(message);\n    else throw new Error(message);\n  }\n  return valid;\n}\n\n\nfunction defaultMeta(self) {\n  var meta = self._opts.meta;\n  self._opts.defaultMeta = typeof meta == 'object'\n                            ? self._getId(meta) || meta\n                            : self.getSchema(META_SCHEMA_ID)\n                              ? META_SCHEMA_ID\n                              : undefined;\n  return self._opts.defaultMeta;\n}\n\n\n/**\n * Get compiled schema from the instance by `key` or `ref`.\n * @this   Ajv\n * @param  {String} keyRef `key` that was passed to `addSchema` or full schema reference (`schema.id` or resolved id).\n * @return {Function} schema validating function (with property `schema`).\n */\nfunction getSchema(keyRef) {\n  var schemaObj = _getSchemaObj(this, keyRef);\n  switch (typeof schemaObj) {\n    case 'object': return schemaObj.validate || this._compile(schemaObj);\n    case 'string': return this.getSchema(schemaObj);\n    case 'undefined': return _getSchemaFragment(this, keyRef);\n  }\n}\n\n\nfunction _getSchemaFragment(self, ref) {\n  var res = resolve.schema.call(self, { schema: {} }, ref);\n  if (res) {\n    var schema = res.schema\n      , root = res.root\n      , baseId = res.baseId;\n    var v = compileSchema.call(self, schema, root, undefined, baseId);\n    self._fragments[ref] = new SchemaObject({\n      ref: ref,\n      fragment: true,\n      schema: schema,\n      root: root,\n      baseId: baseId,\n      validate: v\n    });\n    return v;\n  }\n}\n\n\nfunction _getSchemaObj(self, keyRef) {\n  keyRef = resolve.normalizeId(keyRef);\n  return self._schemas[keyRef] || self._refs[keyRef] || self._fragments[keyRef];\n}\n\n\n/**\n * Remove cached schema(s).\n * If no parameter is passed all schemas but meta-schemas are removed.\n * If RegExp is passed all schemas with key/id matching pattern but meta-schemas are removed.\n * Even if schema is referenced by other schemas it still can be removed as other schemas have local references.\n * @this   Ajv\n * @param  {String|Object|RegExp} schemaKeyRef key, ref, pattern to match key/ref or schema object\n * @return {Ajv} this for method chaining\n */\nfunction removeSchema(schemaKeyRef) {\n  if (schemaKeyRef instanceof RegExp) {\n    _removeAllSchemas(this, this._schemas, schemaKeyRef);\n    _removeAllSchemas(this, this._refs, schemaKeyRef);\n    return this;\n  }\n  switch (typeof schemaKeyRef) {\n    case 'undefined':\n      _removeAllSchemas(this, this._schemas);\n      _removeAllSchemas(this, this._refs);\n      this._cache.clear();\n      return this;\n    case 'string':\n      var schemaObj = _getSchemaObj(this, schemaKeyRef);\n      if (schemaObj) this._cache.del(schemaObj.cacheKey);\n      delete this._schemas[schemaKeyRef];\n      delete this._refs[schemaKeyRef];\n      return this;\n    case 'object':\n      var serialize = this._opts.serialize;\n      var cacheKey = serialize ? serialize(schemaKeyRef) : schemaKeyRef;\n      this._cache.del(cacheKey);\n      var id = this._getId(schemaKeyRef);\n      if (id) {\n        id = resolve.normalizeId(id);\n        delete this._schemas[id];\n        delete this._refs[id];\n      }\n  }\n  return this;\n}\n\n\nfunction _removeAllSchemas(self, schemas, regex) {\n  for (var keyRef in schemas) {\n    var schemaObj = schemas[keyRef];\n    if (!schemaObj.meta && (!regex || regex.test(keyRef))) {\n      self._cache.del(schemaObj.cacheKey);\n      delete schemas[keyRef];\n    }\n  }\n}\n\n\n/* @this   Ajv */\nfunction _addSchema(schema, skipValidation, meta, shouldAddSchema) {\n  if (typeof schema != 'object' && typeof schema != 'boolean')\n    throw new Error('schema should be object or boolean');\n  var serialize = this._opts.serialize;\n  var cacheKey = serialize ? serialize(schema) : schema;\n  var cached = this._cache.get(cacheKey);\n  if (cached) return cached;\n\n  shouldAddSchema = shouldAddSchema || this._opts.addUsedSchema !== false;\n\n  var id = resolve.normalizeId(this._getId(schema));\n  if (id && shouldAddSchema) checkUnique(this, id);\n\n  var willValidate = this._opts.validateSchema !== false && !skipValidation;\n  var recursiveMeta;\n  if (willValidate && !(recursiveMeta = id && id == resolve.normalizeId(schema.$schema)))\n    this.validateSchema(schema, true);\n\n  var localRefs = resolve.ids.call(this, schema);\n\n  var schemaObj = new SchemaObject({\n    id: id,\n    schema: schema,\n    localRefs: localRefs,\n    cacheKey: cacheKey,\n    meta: meta\n  });\n\n  if (id[0] != '#' && shouldAddSchema) this._refs[id] = schemaObj;\n  this._cache.put(cacheKey, schemaObj);\n\n  if (willValidate && recursiveMeta) this.validateSchema(schema, true);\n\n  return schemaObj;\n}\n\n\n/* @this   Ajv */\nfunction _compile(schemaObj, root) {\n  if (schemaObj.compiling) {\n    schemaObj.validate = callValidate;\n    callValidate.schema = schemaObj.schema;\n    callValidate.errors = null;\n    callValidate.root = root ? root : callValidate;\n    if (schemaObj.schema.$async === true)\n      callValidate.$async = true;\n    return callValidate;\n  }\n  schemaObj.compiling = true;\n\n  var currentOpts;\n  if (schemaObj.meta) {\n    currentOpts = this._opts;\n    this._opts = this._metaOpts;\n  }\n\n  var v;\n  try { v = compileSchema.call(this, schemaObj.schema, root, schemaObj.localRefs); }\n  catch(e) {\n    delete schemaObj.validate;\n    throw e;\n  }\n  finally {\n    schemaObj.compiling = false;\n    if (schemaObj.meta) this._opts = currentOpts;\n  }\n\n  schemaObj.validate = v;\n  schemaObj.refs = v.refs;\n  schemaObj.refVal = v.refVal;\n  schemaObj.root = v.root;\n  return v;\n\n\n  /* @this   {*} - custom context, see passContext option */\n  function callValidate() {\n    /* jshint validthis: true */\n    var _validate = schemaObj.validate;\n    var result = _validate.apply(this, arguments);\n    callValidate.errors = _validate.errors;\n    return result;\n  }\n}\n\n\nfunction chooseGetId(opts) {\n  switch (opts.schemaId) {\n    case 'auto': return _get$IdOrId;\n    case 'id': return _getId;\n    default: return _get$Id;\n  }\n}\n\n/* @this   Ajv */\nfunction _getId(schema) {\n  if (schema.$id) this.logger.warn('schema $id ignored', schema.$id);\n  return schema.id;\n}\n\n/* @this   Ajv */\nfunction _get$Id(schema) {\n  if (schema.id) this.logger.warn('schema id ignored', schema.id);\n  return schema.$id;\n}\n\n\nfunction _get$IdOrId(schema) {\n  if (schema.$id && schema.id && schema.$id != schema.id)\n    throw new Error('schema $id is different from id');\n  return schema.$id || schema.id;\n}\n\n\n/**\n * Convert array of error message objects to string\n * @this   Ajv\n * @param  {Array<Object>} errors optional array of validation errors, if not passed errors from the instance are used.\n * @param  {Object} options optional options with properties `separator` and `dataVar`.\n * @return {String} human readable string with all errors descriptions\n */\nfunction errorsText(errors, options) {\n  errors = errors || this.errors;\n  if (!errors) return 'No errors';\n  options = options || {};\n  var separator = options.separator === undefined ? ', ' : options.separator;\n  var dataVar = options.dataVar === undefined ? 'data' : options.dataVar;\n\n  var text = '';\n  for (var i=0; i<errors.length; i++) {\n    var e = errors[i];\n    if (e) text += dataVar + e.dataPath + ' ' + e.message + separator;\n  }\n  return text.slice(0, -separator.length);\n}\n\n\n/**\n * Add custom format\n * @this   Ajv\n * @param {String} name format name\n * @param {String|RegExp|Function} format string is converted to RegExp; function should return boolean (true when valid)\n * @return {Ajv} this for method chaining\n */\nfunction addFormat(name, format) {\n  if (typeof format == 'string') format = new RegExp(format);\n  this._formats[name] = format;\n  return this;\n}\n\n\nfunction addDefaultMetaSchema(self) {\n  var $dataSchema;\n  if (self._opts.$data) {\n    $dataSchema = require('./refs/data.json');\n    self.addMetaSchema($dataSchema, $dataSchema.$id, true);\n  }\n  if (self._opts.meta === false) return;\n  var metaSchema = require('./refs/json-schema-draft-07.json');\n  if (self._opts.$data) metaSchema = $dataMetaSchema(metaSchema, META_SUPPORT_DATA);\n  self.addMetaSchema(metaSchema, META_SCHEMA_ID, true);\n  self._refs['http://json-schema.org/schema'] = META_SCHEMA_ID;\n}\n\n\nfunction addInitialSchemas(self) {\n  var optsSchemas = self._opts.schemas;\n  if (!optsSchemas) return;\n  if (Array.isArray(optsSchemas)) self.addSchema(optsSchemas);\n  else for (var key in optsSchemas) self.addSchema(optsSchemas[key], key);\n}\n\n\nfunction addInitialFormats(self) {\n  for (var name in self._opts.formats) {\n    var format = self._opts.formats[name];\n    self.addFormat(name, format);\n  }\n}\n\n\nfunction addInitialKeywords(self) {\n  for (var name in self._opts.keywords) {\n    var keyword = self._opts.keywords[name];\n    self.addKeyword(name, keyword);\n  }\n}\n\n\nfunction checkUnique(self, id) {\n  if (self._schemas[id] || self._refs[id])\n    throw new Error('schema with key or id \"' + id + '\" already exists');\n}\n\n\nfunction getMetaSchemaOptions(self) {\n  var metaOpts = util.copy(self._opts);\n  for (var i=0; i<META_IGNORE_OPTIONS.length; i++)\n    delete metaOpts[META_IGNORE_OPTIONS[i]];\n  return metaOpts;\n}\n\n\nfunction setLogger(self) {\n  var logger = self._opts.logger;\n  if (logger === false) {\n    self.logger = {log: noop, warn: noop, error: noop};\n  } else {\n    if (logger === undefined) logger = console;\n    if (!(typeof logger == 'object' && logger.log && logger.warn && logger.error))\n      throw new Error('logger must implement log, warn and error methods');\n    self.logger = logger;\n  }\n}\n\n\nfunction noop() {}\n","'use strict';\n\nvar metaSchema = require('./refs/json-schema-draft-07.json');\n\nmodule.exports = {\n  $id: 'https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js',\n  definitions: {\n    simpleTypes: metaSchema.definitions.simpleTypes\n  },\n  type: 'object',\n  dependencies: {\n    schema: ['validate'],\n    $data: ['validate'],\n    statements: ['inline'],\n    valid: {not: {required: ['macro']}}\n  },\n  properties: {\n    type: metaSchema.properties.type,\n    schema: {type: 'boolean'},\n    statements: {type: 'boolean'},\n    dependencies: {\n      type: 'array',\n      items: {type: 'string'}\n    },\n    metaSchema: {type: 'object'},\n    modifying: {type: 'boolean'},\n    valid: {type: 'boolean'},\n    $data: {type: 'boolean'},\n    async: {type: 'boolean'},\n    errors: {\n      anyOf: [\n        {type: 'boolean'},\n        {const: 'full'}\n      ]\n    }\n  }\n};\n","'use strict';\nmodule.exports = function generate_items(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $idx = 'i' + $lvl,\n    $dataNxt = $it.dataLevel = it.dataLevel + 1,\n    $nextData = 'data' + $dataNxt,\n    $currentBaseId = it.baseId;\n  out += 'var ' + ($errs) + ' = errors;var ' + ($valid) + ';';\n  if (Array.isArray($schema)) {\n    var $additionalItems = it.schema.additionalItems;\n    if ($additionalItems === false) {\n      out += ' ' + ($valid) + ' = ' + ($data) + '.length <= ' + ($schema.length) + '; ';\n      var $currErrSchemaPath = $errSchemaPath;\n      $errSchemaPath = it.errSchemaPath + '/additionalItems';\n      out += '  if (!' + ($valid) + ') {   ';\n      var $$outStack = $$outStack || [];\n      $$outStack.push(out);\n      out = ''; /* istanbul ignore else */\n      if (it.createErrors !== false) {\n        out += ' { keyword: \\'' + ('additionalItems') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { limit: ' + ($schema.length) + ' } ';\n        if (it.opts.messages !== false) {\n          out += ' , message: \\'should NOT have more than ' + ($schema.length) + ' items\\' ';\n        }\n        if (it.opts.verbose) {\n          out += ' , schema: false , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n        }\n        out += ' } ';\n      } else {\n        out += ' {} ';\n      }\n      var __err = out;\n      out = $$outStack.pop();\n      if (!it.compositeRule && $breakOnError) {\n        /* istanbul ignore if */\n        if (it.async) {\n          out += ' throw new ValidationError([' + (__err) + ']); ';\n        } else {\n          out += ' validate.errors = [' + (__err) + ']; return false; ';\n        }\n      } else {\n        out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n      }\n      out += ' } ';\n      $errSchemaPath = $currErrSchemaPath;\n      if ($breakOnError) {\n        $closingBraces += '}';\n        out += ' else { ';\n      }\n    }\n    var arr1 = $schema;\n    if (arr1) {\n      var $sch, $i = -1,\n        l1 = arr1.length - 1;\n      while ($i < l1) {\n        $sch = arr1[$i += 1];\n        if ((it.opts.strictKeywords ? (typeof $sch == 'object' && Object.keys($sch).length > 0) || $sch === false : it.util.schemaHasRules($sch, it.RULES.all))) {\n          out += ' ' + ($nextValid) + ' = true; if (' + ($data) + '.length > ' + ($i) + ') { ';\n          var $passData = $data + '[' + $i + ']';\n          $it.schema = $sch;\n          $it.schemaPath = $schemaPath + '[' + $i + ']';\n          $it.errSchemaPath = $errSchemaPath + '/' + $i;\n          $it.errorPath = it.util.getPathExpr(it.errorPath, $i, it.opts.jsonPointers, true);\n          $it.dataPathArr[$dataNxt] = $i;\n          var $code = it.validate($it);\n          $it.baseId = $currentBaseId;\n          if (it.util.varOccurences($code, $nextData) < 2) {\n            out += ' ' + (it.util.varReplace($code, $nextData, $passData)) + ' ';\n          } else {\n            out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ' + ($code) + ' ';\n          }\n          out += ' }  ';\n          if ($breakOnError) {\n            out += ' if (' + ($nextValid) + ') { ';\n            $closingBraces += '}';\n          }\n        }\n      }\n    }\n    if (typeof $additionalItems == 'object' && (it.opts.strictKeywords ? (typeof $additionalItems == 'object' && Object.keys($additionalItems).length > 0) || $additionalItems === false : it.util.schemaHasRules($additionalItems, it.RULES.all))) {\n      $it.schema = $additionalItems;\n      $it.schemaPath = it.schemaPath + '.additionalItems';\n      $it.errSchemaPath = it.errSchemaPath + '/additionalItems';\n      out += ' ' + ($nextValid) + ' = true; if (' + ($data) + '.length > ' + ($schema.length) + ') {  for (var ' + ($idx) + ' = ' + ($schema.length) + '; ' + ($idx) + ' < ' + ($data) + '.length; ' + ($idx) + '++) { ';\n      $it.errorPath = it.util.getPathExpr(it.errorPath, $idx, it.opts.jsonPointers, true);\n      var $passData = $data + '[' + $idx + ']';\n      $it.dataPathArr[$dataNxt] = $idx;\n      var $code = it.validate($it);\n      $it.baseId = $currentBaseId;\n      if (it.util.varOccurences($code, $nextData) < 2) {\n        out += ' ' + (it.util.varReplace($code, $nextData, $passData)) + ' ';\n      } else {\n        out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ' + ($code) + ' ';\n      }\n      if ($breakOnError) {\n        out += ' if (!' + ($nextValid) + ') break; ';\n      }\n      out += ' } }  ';\n      if ($breakOnError) {\n        out += ' if (' + ($nextValid) + ') { ';\n        $closingBraces += '}';\n      }\n    }\n  } else if ((it.opts.strictKeywords ? (typeof $schema == 'object' && Object.keys($schema).length > 0) || $schema === false : it.util.schemaHasRules($schema, it.RULES.all))) {\n    $it.schema = $schema;\n    $it.schemaPath = $schemaPath;\n    $it.errSchemaPath = $errSchemaPath;\n    out += '  for (var ' + ($idx) + ' = ' + (0) + '; ' + ($idx) + ' < ' + ($data) + '.length; ' + ($idx) + '++) { ';\n    $it.errorPath = it.util.getPathExpr(it.errorPath, $idx, it.opts.jsonPointers, true);\n    var $passData = $data + '[' + $idx + ']';\n    $it.dataPathArr[$dataNxt] = $idx;\n    var $code = it.validate($it);\n    $it.baseId = $currentBaseId;\n    if (it.util.varOccurences($code, $nextData) < 2) {\n      out += ' ' + (it.util.varReplace($code, $nextData, $passData)) + ' ';\n    } else {\n      out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ' + ($code) + ' ';\n    }\n    if ($breakOnError) {\n      out += ' if (!' + ($nextValid) + ') break; ';\n    }\n    out += ' }';\n  }\n  if ($breakOnError) {\n    out += ' ' + ($closingBraces) + ' if (' + ($errs) + ' == errors) {';\n  }\n  return out;\n}\n","'use strict'\n\n/**\n * polygon-polygon collision\n * based on http://stackoverflow.com/questions/10962379/how-to-check-intersection-between-2-rotated-rectangles\n * @param {number[]} points1 [x1, y1, x2, y2, ... xn, yn] of first polygon\n * @param {number[]} points2 [x1, y1, x2, y2, ... xn, yn] of second polygon\n * @return {boolean}\n */\nmodule.exports = function polygonPolygon(points1, points2)\n{\n    var a = points1\n    var b = points2\n    var polygons = [a, b]\n    var minA, maxA, projected, minB, maxB, j\n    for (var i = 0; i < polygons.length; i++)\n    {\n        var polygon = polygons[i]\n        for (var i1 = 0; i1 < polygon.length; i1 += 2)\n        {\n            var i2 = (i1 + 2) % polygon.length\n            var normal = { x: polygon[i2 + 1] - polygon[i1 + 1], y: polygon[i1] - polygon[i2] }\n            minA = maxA = null\n            for (j = 0; j < a.length; j += 2)\n            {\n                projected = normal.x * a[j] + normal.y * a[j + 1]\n                if (minA === null || projected < minA)\n                {\n                    minA = projected\n                }\n                if (maxA === null || projected > maxA)\n                {\n                    maxA = projected\n                }\n            }\n            minB = maxB = null\n            for (j = 0; j < b.length; j += 2)\n            {\n                projected = normal.x * b[j] + normal.y * b[j + 1]\n                if (minB === null || projected < minB)\n                {\n                    minB = projected\n                }\n                if (maxB === null || projected > maxB)\n                {\n                    maxB = projected\n                }\n            }\n            if (maxA < minB || maxB < minA)\n            {\n                return false\n            }\n        }\n    }\n    return true\n}\n","'use strict';\n\nvar resolve = require('./resolve');\n\nmodule.exports = {\n  Validation: errorSubclass(ValidationError),\n  MissingRef: errorSubclass(MissingRefError)\n};\n\n\nfunction ValidationError(errors) {\n  this.message = 'validation failed';\n  this.errors = errors;\n  this.ajv = this.validation = true;\n}\n\n\nMissingRefError.message = function (baseId, ref) {\n  return 'can\\'t resolve reference ' + ref + ' from id ' + baseId;\n};\n\n\nfunction MissingRefError(baseId, ref, message) {\n  this.message = message || MissingRefError.message(baseId, ref);\n  this.missingRef = resolve.url(baseId, ref);\n  this.missingSchema = resolve.normalizeId(resolve.fullPath(this.missingRef));\n}\n\n\nfunction errorSubclass(Subclass) {\n  Subclass.prototype = Object.create(Error.prototype);\n  Subclass.prototype.constructor = Subclass;\n  return Subclass;\n}\n","'use strict';\n\nvar traverse = module.exports = function (schema, opts, cb) {\n  // Legacy support for v0.3.1 and earlier.\n  if (typeof opts == 'function') {\n    cb = opts;\n    opts = {};\n  }\n\n  cb = opts.cb || cb;\n  var pre = (typeof cb == 'function') ? cb : cb.pre || function() {};\n  var post = cb.post || function() {};\n\n  _traverse(opts, pre, post, schema, '', schema);\n};\n\n\ntraverse.keywords = {\n  additionalItems: true,\n  items: true,\n  contains: true,\n  additionalProperties: true,\n  propertyNames: true,\n  not: true\n};\n\ntraverse.arrayKeywords = {\n  items: true,\n  allOf: true,\n  anyOf: true,\n  oneOf: true\n};\n\ntraverse.propsKeywords = {\n  definitions: true,\n  properties: true,\n  patternProperties: true,\n  dependencies: true\n};\n\ntraverse.skipKeywords = {\n  default: true,\n  enum: true,\n  const: true,\n  required: true,\n  maximum: true,\n  minimum: true,\n  exclusiveMaximum: true,\n  exclusiveMinimum: true,\n  multipleOf: true,\n  maxLength: true,\n  minLength: true,\n  pattern: true,\n  format: true,\n  maxItems: true,\n  minItems: true,\n  uniqueItems: true,\n  maxProperties: true,\n  minProperties: true\n};\n\n\nfunction _traverse(opts, pre, post, schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex) {\n  if (schema && typeof schema == 'object' && !Array.isArray(schema)) {\n    pre(schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex);\n    for (var key in schema) {\n      var sch = schema[key];\n      if (Array.isArray(sch)) {\n        if (key in traverse.arrayKeywords) {\n          for (var i=0; i<sch.length; i++)\n            _traverse(opts, pre, post, sch[i], jsonPtr + '/' + key + '/' + i, rootSchema, jsonPtr, key, schema, i);\n        }\n      } else if (key in traverse.propsKeywords) {\n        if (sch && typeof sch == 'object') {\n          for (var prop in sch)\n            _traverse(opts, pre, post, sch[prop], jsonPtr + '/' + key + '/' + escapeJsonPtr(prop), rootSchema, jsonPtr, key, schema, prop);\n        }\n      } else if (key in traverse.keywords || (opts.allKeys && !(key in traverse.skipKeywords))) {\n        _traverse(opts, pre, post, sch, jsonPtr + '/' + key, rootSchema, jsonPtr, key, schema);\n      }\n    }\n    post(schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex);\n  }\n}\n\n\nfunction escapeJsonPtr(str) {\n  return str.replace(/~/g, '~0').replace(/\\//g, '~1');\n}\n","'use strict';\n\nvar resolve = require('./resolve')\n  , util = require('./util')\n  , errorClasses = require('./error_classes')\n  , stableStringify = require('fast-json-stable-stringify');\n\nvar validateGenerator = require('../dotjs/validate');\n\n/**\n * Functions below are used inside compiled validations function\n */\n\nvar ucs2length = util.ucs2length;\nvar equal = require('fast-deep-equal');\n\n// this error is thrown by async schemas to return validation errors via exception\nvar ValidationError = errorClasses.Validation;\n\nmodule.exports = compile;\n\n\n/**\n * Compiles schema to validation function\n * @this   Ajv\n * @param  {Object} schema schema object\n * @param  {Object} root object with information about the root schema for this schema\n * @param  {Object} localRefs the hash of local references inside the schema (created by resolve.id), used for inline resolution\n * @param  {String} baseId base ID for IDs in the schema\n * @return {Function} validation function\n */\nfunction compile(schema, root, localRefs, baseId) {\n  /* jshint validthis: true, evil: true */\n  /* eslint no-shadow: 0 */\n  var self = this\n    , opts = this._opts\n    , refVal = [ undefined ]\n    , refs = {}\n    , patterns = []\n    , patternsHash = {}\n    , defaults = []\n    , defaultsHash = {}\n    , customRules = [];\n\n  root = root || { schema: schema, refVal: refVal, refs: refs };\n\n  var c = checkCompiling.call(this, schema, root, baseId);\n  var compilation = this._compilations[c.index];\n  if (c.compiling) return (compilation.callValidate = callValidate);\n\n  var formats = this._formats;\n  var RULES = this.RULES;\n\n  try {\n    var v = localCompile(schema, root, localRefs, baseId);\n    compilation.validate = v;\n    var cv = compilation.callValidate;\n    if (cv) {\n      cv.schema = v.schema;\n      cv.errors = null;\n      cv.refs = v.refs;\n      cv.refVal = v.refVal;\n      cv.root = v.root;\n      cv.$async = v.$async;\n      if (opts.sourceCode) cv.source = v.source;\n    }\n    return v;\n  } finally {\n    endCompiling.call(this, schema, root, baseId);\n  }\n\n  /* @this   {*} - custom context, see passContext option */\n  function callValidate() {\n    /* jshint validthis: true */\n    var validate = compilation.validate;\n    var result = validate.apply(this, arguments);\n    callValidate.errors = validate.errors;\n    return result;\n  }\n\n  function localCompile(_schema, _root, localRefs, baseId) {\n    var isRoot = !_root || (_root && _root.schema == _schema);\n    if (_root.schema != root.schema)\n      return compile.call(self, _schema, _root, localRefs, baseId);\n\n    var $async = _schema.$async === true;\n\n    var sourceCode = validateGenerator({\n      isTop: true,\n      schema: _schema,\n      isRoot: isRoot,\n      baseId: baseId,\n      root: _root,\n      schemaPath: '',\n      errSchemaPath: '#',\n      errorPath: '\"\"',\n      MissingRefError: errorClasses.MissingRef,\n      RULES: RULES,\n      validate: validateGenerator,\n      util: util,\n      resolve: resolve,\n      resolveRef: resolveRef,\n      usePattern: usePattern,\n      useDefault: useDefault,\n      useCustomRule: useCustomRule,\n      opts: opts,\n      formats: formats,\n      logger: self.logger,\n      self: self\n    });\n\n    sourceCode = vars(refVal, refValCode) + vars(patterns, patternCode)\n                   + vars(defaults, defaultCode) + vars(customRules, customRuleCode)\n                   + sourceCode;\n\n    if (opts.processCode) sourceCode = opts.processCode(sourceCode, _schema);\n    // console.log('\\n\\n\\n *** \\n', JSON.stringify(sourceCode));\n    var validate;\n    try {\n      var makeValidate = new Function(\n        'self',\n        'RULES',\n        'formats',\n        'root',\n        'refVal',\n        'defaults',\n        'customRules',\n        'equal',\n        'ucs2length',\n        'ValidationError',\n        sourceCode\n      );\n\n      validate = makeValidate(\n        self,\n        RULES,\n        formats,\n        root,\n        refVal,\n        defaults,\n        customRules,\n        equal,\n        ucs2length,\n        ValidationError\n      );\n\n      refVal[0] = validate;\n    } catch(e) {\n      self.logger.error('Error compiling schema, function code:', sourceCode);\n      throw e;\n    }\n\n    validate.schema = _schema;\n    validate.errors = null;\n    validate.refs = refs;\n    validate.refVal = refVal;\n    validate.root = isRoot ? validate : _root;\n    if ($async) validate.$async = true;\n    if (opts.sourceCode === true) {\n      validate.source = {\n        code: sourceCode,\n        patterns: patterns,\n        defaults: defaults\n      };\n    }\n\n    return validate;\n  }\n\n  function resolveRef(baseId, ref, isRoot) {\n    ref = resolve.url(baseId, ref);\n    var refIndex = refs[ref];\n    var _refVal, refCode;\n    if (refIndex !== undefined) {\n      _refVal = refVal[refIndex];\n      refCode = 'refVal[' + refIndex + ']';\n      return resolvedRef(_refVal, refCode);\n    }\n    if (!isRoot && root.refs) {\n      var rootRefId = root.refs[ref];\n      if (rootRefId !== undefined) {\n        _refVal = root.refVal[rootRefId];\n        refCode = addLocalRef(ref, _refVal);\n        return resolvedRef(_refVal, refCode);\n      }\n    }\n\n    refCode = addLocalRef(ref);\n    var v = resolve.call(self, localCompile, root, ref);\n    if (v === undefined) {\n      var localSchema = localRefs && localRefs[ref];\n      if (localSchema) {\n        v = resolve.inlineRef(localSchema, opts.inlineRefs)\n            ? localSchema\n            : compile.call(self, localSchema, root, localRefs, baseId);\n      }\n    }\n\n    if (v === undefined) {\n      removeLocalRef(ref);\n    } else {\n      replaceLocalRef(ref, v);\n      return resolvedRef(v, refCode);\n    }\n  }\n\n  function addLocalRef(ref, v) {\n    var refId = refVal.length;\n    refVal[refId] = v;\n    refs[ref] = refId;\n    return 'refVal' + refId;\n  }\n\n  function removeLocalRef(ref) {\n    delete refs[ref];\n  }\n\n  function replaceLocalRef(ref, v) {\n    var refId = refs[ref];\n    refVal[refId] = v;\n  }\n\n  function resolvedRef(refVal, code) {\n    return typeof refVal == 'object' || typeof refVal == 'boolean'\n            ? { code: code, schema: refVal, inline: true }\n            : { code: code, $async: refVal && !!refVal.$async };\n  }\n\n  function usePattern(regexStr) {\n    var index = patternsHash[regexStr];\n    if (index === undefined) {\n      index = patternsHash[regexStr] = patterns.length;\n      patterns[index] = regexStr;\n    }\n    return 'pattern' + index;\n  }\n\n  function useDefault(value) {\n    switch (typeof value) {\n      case 'boolean':\n      case 'number':\n        return '' + value;\n      case 'string':\n        return util.toQuotedString(value);\n      case 'object':\n        if (value === null) return 'null';\n        var valueStr = stableStringify(value);\n        var index = defaultsHash[valueStr];\n        if (index === undefined) {\n          index = defaultsHash[valueStr] = defaults.length;\n          defaults[index] = value;\n        }\n        return 'default' + index;\n    }\n  }\n\n  function useCustomRule(rule, schema, parentSchema, it) {\n    if (self._opts.validateSchema !== false) {\n      var deps = rule.definition.dependencies;\n      if (deps && !deps.every(function(keyword) {\n        return Object.prototype.hasOwnProperty.call(parentSchema, keyword);\n      }))\n        throw new Error('parent schema must have all required keywords: ' + deps.join(','));\n\n      var validateSchema = rule.definition.validateSchema;\n      if (validateSchema) {\n        var valid = validateSchema(schema);\n        if (!valid) {\n          var message = 'keyword schema is invalid: ' + self.errorsText(validateSchema.errors);\n          if (self._opts.validateSchema == 'log') self.logger.error(message);\n          else throw new Error(message);\n        }\n      }\n    }\n\n    var compile = rule.definition.compile\n      , inline = rule.definition.inline\n      , macro = rule.definition.macro;\n\n    var validate;\n    if (compile) {\n      validate = compile.call(self, schema, parentSchema, it);\n    } else if (macro) {\n      validate = macro.call(self, schema, parentSchema, it);\n      if (opts.validateSchema !== false) self.validateSchema(validate, true);\n    } else if (inline) {\n      validate = inline.call(self, it, rule.keyword, schema, parentSchema);\n    } else {\n      validate = rule.definition.validate;\n      if (!validate) return;\n    }\n\n    if (validate === undefined)\n      throw new Error('custom keyword \"' + rule.keyword + '\"failed to compile');\n\n    var index = customRules.length;\n    customRules[index] = validate;\n\n    return {\n      code: 'customRule' + index,\n      validate: validate\n    };\n  }\n}\n\n\n/**\n * Checks if the schema is currently compiled\n * @this   Ajv\n * @param  {Object} schema schema to compile\n * @param  {Object} root root object\n * @param  {String} baseId base schema ID\n * @return {Object} object with properties \"index\" (compilation index) and \"compiling\" (boolean)\n */\nfunction checkCompiling(schema, root, baseId) {\n  /* jshint validthis: true */\n  var index = compIndex.call(this, schema, root, baseId);\n  if (index >= 0) return { index: index, compiling: true };\n  index = this._compilations.length;\n  this._compilations[index] = {\n    schema: schema,\n    root: root,\n    baseId: baseId\n  };\n  return { index: index, compiling: false };\n}\n\n\n/**\n * Removes the schema from the currently compiled list\n * @this   Ajv\n * @param  {Object} schema schema to compile\n * @param  {Object} root root object\n * @param  {String} baseId base schema ID\n */\nfunction endCompiling(schema, root, baseId) {\n  /* jshint validthis: true */\n  var i = compIndex.call(this, schema, root, baseId);\n  if (i >= 0) this._compilations.splice(i, 1);\n}\n\n\n/**\n * Index of schema compilation in the currently compiled list\n * @this   Ajv\n * @param  {Object} schema schema to compile\n * @param  {Object} root root object\n * @param  {String} baseId base schema ID\n * @return {Integer} compilation index\n */\nfunction compIndex(schema, root, baseId) {\n  /* jshint validthis: true */\n  for (var i=0; i<this._compilations.length; i++) {\n    var c = this._compilations[i];\n    if (c.schema == schema && c.root == root && c.baseId == baseId) return i;\n  }\n  return -1;\n}\n\n\nfunction patternCode(i, patterns) {\n  return 'var pattern' + i + ' = new RegExp(' + util.toQuotedString(patterns[i]) + ');';\n}\n\n\nfunction defaultCode(i) {\n  return 'var default' + i + ' = defaults[' + i + '];';\n}\n\n\nfunction refValCode(i, refVal) {\n  return refVal[i] === undefined ? '' : 'var refVal' + i + ' = refVal[' + i + '];';\n}\n\n\nfunction customRuleCode(i) {\n  return 'var customRule' + i + ' = customRules[' + i + '];';\n}\n\n\nfunction vars(arr, statement) {\n  if (!arr.length) return '';\n  var code = '';\n  for (var i=0; i<arr.length; i++)\n    code += statement(i, arr);\n  return code;\n}\n","'use strict'\n\nfunction distanceSquared(x1, y1, x2, y2)\n{\n    return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2))\n}\n\n/**\n * line-point collision\n * from https://stackoverflow.com/a/17693146/1955997\n * @param {number} x1 first point in line\n * @param {number} y1 first point in line\n * @param {number} x2 second point in line\n * @param {number} y2 second point in line\n * @param {number} xp point\n * @param {number} yp point\n * @param {number} [tolerance=1]\n * @return {boolean}\n */\nmodule.exports = function linePoint(x1, y1, x2, y2, xp, yp, tolerance)\n{\n    tolerance = tolerance || 1\n    return Math.abs(distanceSquared(x1, y1, x2, y2) - (distanceSquared(x1, y1, xp, yp) + distanceSquared(x2, y2, xp, yp))) <= tolerance\n}","'use strict';\nmodule.exports = function generate__limitLength(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $errorKeyword;\n  var $data = 'data' + ($dataLvl || '');\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  if (!($isData || typeof $schema == 'number')) {\n    throw new Error($keyword + ' must be number');\n  }\n  var $op = $keyword == 'maxLength' ? '>' : '<';\n  out += 'if ( ';\n  if ($isData) {\n    out += ' (' + ($schemaValue) + ' !== undefined && typeof ' + ($schemaValue) + ' != \\'number\\') || ';\n  }\n  if (it.opts.unicode === false) {\n    out += ' ' + ($data) + '.length ';\n  } else {\n    out += ' ucs2length(' + ($data) + ') ';\n  }\n  out += ' ' + ($op) + ' ' + ($schemaValue) + ') { ';\n  var $errorKeyword = $keyword;\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ($errorKeyword || '_limitLength') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { limit: ' + ($schemaValue) + ' } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should NOT be ';\n      if ($keyword == 'maxLength') {\n        out += 'longer';\n      } else {\n        out += 'shorter';\n      }\n      out += ' than ';\n      if ($isData) {\n        out += '\\' + ' + ($schemaValue) + ' + \\'';\n      } else {\n        out += '' + ($schema);\n      }\n      out += ' characters\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema:  ';\n      if ($isData) {\n        out += 'validate.schema' + ($schemaPath);\n      } else {\n        out += '' + ($schema);\n      }\n      out += '         , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += '} ';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict'\n\nconst linePoint = require('./line-point')\n\n/**\n * polygon-point collision\n * based on https://stackoverflow.com/a/17490923/1955997\n * @param {number[]} points [x1, y1, x2, y2, ... xn, yn] of polygon\n * @param {number} x of point\n * @param {number} y of point\n * @param {number} [tolerance=1] maximum distance of point to polygon's edges that triggers collision (see pointLine)\n */\nmodule.exports = function polygonPoint(points, x, y, tolerance)\n{\n    var length = points.length\n    var c = false\n    var i, j\n    for (i = 0, j = length - 2; i < length; i += 2)\n    {\n        if (((points[i + 1] > y) !== (points[j + 1] > y)) && (x < (points[j] - points[i]) * (y - points[i + 1]) / (points[j + 1] - points[i + 1]) + points[i]))\n        {\n            c = !c\n        }\n        j = i\n    }\n    if (c)\n    {\n        return true\n    }\n    for (i = 0; i < length; i += 2)\n    {\n        var p1x = points[i]\n        var p1y = points[i + 1]\n        var p2x, p2y\n        if (i === length - 2)\n        {\n            p2x = points[0]\n            p2y = points[1]\n        }\n        else\n        {\n            p2x = points[i + 2]\n            p2y = points[i + 3]\n        }\n        if (linePoint(p1x, p1y, p2x, p2y, x, y, tolerance))\n        {\n            return true\n        }\n    }\n    return false\n}\n","const ProcessGraphError = require('./error');\r\nconst Utils = require('./utils');\r\n\r\n/**\r\n * A Process graph node.\r\n * \r\n * @class\r\n */\r\nclass ProcessGraphNode {\r\n\r\n\tconstructor(node, id, parent = null) {\r\n\t\tif (typeof id !== 'string' || id.length === 0) {\r\n\t\t\tthrow new ProcessGraphError('NodeIdInvalid');\r\n\t\t}\r\n\t\tif (!Utils.isObject(node)) {\r\n\t\t\tthrow new ProcessGraphError('NodeInvalid', {node_id: id});\r\n\t\t}\r\n\t\tif (typeof node.process_id !== 'string') {\r\n\t\t\tthrow new ProcessGraphError('ProcessIdMissing', {node_id: id});\r\n\t\t}\r\n\r\n\t\tthis.id = id;\r\n\t\tthis.processGraph = parent;\r\n\t\tthis.source = node;\r\n\t\tthis.process_id = node.process_id;\r\n\t\tthis.namespace = node.namespace || null;\r\n\t\tthis.arguments = Utils.isObject(node.arguments) ? Utils.deepClone(node.arguments) : {};\r\n\t\tthis.description = node.description || null;\r\n\t\tthis.isResultNode = node.result || false;\r\n\t\tthis.expectsFrom = []; // From which node do we expect results from\r\n\t\tthis.receivedFrom = []; // From which node have received results from so far\r\n\t\tthis.passesTo = [];\r\n\t\tthis.computedResult = undefined;\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet args = Utils.mapObjectValues(this.arguments, arg => Utils.isObject(arg) && typeof arg.toJSON === 'function' ? arg.toJSON() : arg);\r\n\t\treturn Object.assign({}, this.source, {\r\n\t\t\tprocess_id: this.process_id,\r\n\t\t\tnamespace: this.namespace,\r\n\t\t\tdescription: this.description,\r\n\t\t\targuments: args,\r\n\t\t\tresult: this.isResultNode\r\n\t\t});\r\n\t}\r\n\r\n\tgetProcessGraph() {\r\n\t\treturn this.processGraph;\r\n\t}\r\n\r\n\tgetParent() {\r\n\t\tif (this.processGraph !== null) {\r\n\t\t\treturn this.processGraph.getParentNode();\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tgetArgumentNames() {\r\n\t\treturn Object.keys(this.arguments);\r\n\t}\r\n\r\n\thasArgument(name) {\r\n\t\treturn typeof this.arguments[name] !== 'undefined';\r\n\t}\r\n\r\n\tgetArgumentType(name) {\r\n\t\treturn Utils.getType(this.getRawArgument(name));\r\n\t}\r\n\r\n\tgetRawArgument(name) {\r\n\t\treturn Utils.isObject(this.source.arguments) ? this.source.arguments[name] : undefined;\r\n\t}\r\n\r\n\tgetParsedArgument(name) {\r\n\t\treturn this.arguments[name];\r\n\t}\r\n\r\n\tgetArgument(name, defaultValue = undefined) {\r\n\t\tif (typeof this.arguments[name] === 'undefined') {\r\n\t\t\treturn defaultValue;\r\n\t\t}\r\n\t\treturn this.evaluateArgument(this.arguments[name]);\r\n\t}\r\n\r\n\tgetArgumentRefs(name) {\r\n\t\treturn Utils.getRefs(this.getRawArgument(name), false);\r\n\t}\r\n\r\n\tgetRefs() {\r\n\t\treturn Utils.getRefs(this.source.arguments, false);\r\n\t}\r\n\r\n\tgetProcessGraphParameterValue(name) {\r\n\t\t// 1. Check local parameter, then check parents\r\n\t\t// 2. Check parents\r\n\t\t// 3. Try to get default value\r\n\t\t// 4. Fail if no value is available\r\n\t\tlet defaultValue;\r\n\t\tlet pg = this.processGraph;\r\n\t\tdo {\r\n\t\t\tif (pg.hasArgument(name)) {\r\n\t\t\t\treturn pg.getArgument(name);\r\n\t\t\t}\r\n\t\t\tif (pg.hasParameterDefault(name)) {\r\n\t\t\t\tdefaultValue = pg.getParameterDefault(name);\r\n\t\t\t}\r\n\t\t\tpg = pg.getParent();\r\n\t\t} while (pg !== null);\r\n\r\n\t\tif (typeof defaultValue !== 'undefined') {\r\n\t\t\treturn defaultValue;\r\n\t\t}\r\n\r\n\t\tif (!this.processGraph.allowUndefinedParameterRefs) {\r\n\t\t\tthrow new ProcessGraphError('ProcessGraphParameterMissing', {\r\n\t\t\t\targument: name,\r\n\t\t\t\tnode_id: this.id,\r\n\t\t\t\tprocess_id: this.process_id,\r\n\t\t\t\tnamespace: this.namespace || 'n/a'\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tevaluateArgument(arg) {\r\n\t\tvar type = Utils.getType(arg);\r\n\t\tswitch(type) {\r\n\t\t\tcase 'result':\r\n\t\t\t\treturn this.processGraph.getNode(arg.from_node).getResult();\r\n\t\t\tcase 'callback':\r\n\t\t\t\treturn arg;\r\n\t\t\tcase 'parameter':\r\n\t\t\t\treturn this.getProcessGraphParameterValue(arg.from_parameter);\r\n\t\t\tcase 'array':\r\n\t\t\tcase 'object':\r\n\t\t\t\tlet copy = type === 'array' ? [] : {};\r\n\t\t\t\tfor(var i in arg) {\r\n\t\t\t\t\tcopy[i] = this.evaluateArgument(arg[i]);\r\n\t\t\t\t}\r\n\t\t\t\treturn copy;\r\n\t\t\tdefault:\r\n\t\t\t\treturn arg;\r\n\t\t}\r\n\t}\r\n\r\n\tisStartNode() {\r\n\t\treturn (this.expectsFrom.length === 0);\r\n\t}\r\n\r\n\taddPreviousNode(node) {\r\n\t\tif (!this.expectsFrom.find(other => other.id === node.id)) {\r\n\t\t\tthis.expectsFrom.push(node);\r\n\t\t}\r\n\t}\r\n\r\n\tgetPreviousNodes() {\r\n\t\t// Sort nodes to ensure a consistent execution order\r\n\t\treturn this.expectsFrom.sort((a,b) => a.id.localeCompare(b.id));\r\n\t}\r\n\r\n\taddNextNode(node) {\r\n\t\tif (!this.passesTo.find(other => other.id === node.id)) {\r\n\t\t\tthis.passesTo.push(node);\r\n\t\t}\r\n\t}\r\n\r\n\tgetNextNodes() {\r\n\t\t// Sort nodes to ensure a consistent execution order\r\n\t\treturn this.passesTo.sort((a,b) => a.id.localeCompare(b.id));\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.computedResult = undefined;\r\n\t\tthis.receivedFrom = [];\r\n\t}\r\n\r\n\tgetDescription() {\r\n\t\treturn this.description;\r\n\t}\r\n\r\n\tsetDescription(description) {\r\n\t\tif (typeof description === 'string') {\r\n\t\t\tthis.description = description;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.description = null;\r\n\t\t}\r\n\t}\r\n\r\n\tsetResult(result) {\r\n\t\tthis.computedResult = result;\r\n\t}\r\n\r\n\tgetResult() {\r\n\t\treturn this.computedResult;\r\n\t}\r\n\r\n\tsolveDependency(dependencyNode) {\r\n\t\tif (dependencyNode !== null && this.expectsFrom.includes(dependencyNode)) {\r\n\t\t\tthis.receivedFrom.push(dependencyNode);\r\n\t\t}\r\n\t\treturn (this.expectsFrom.length === this.receivedFrom.length); // all dependencies solved?\r\n\t}\r\n\r\n}\r\n\r\nmodule.exports = ProcessGraphNode;","'use strict';\n\nvar util = require('./util');\n\nvar DATE = /^(\\d\\d\\d\\d)-(\\d\\d)-(\\d\\d)$/;\nvar DAYS = [0,31,28,31,30,31,30,31,31,30,31,30,31];\nvar TIME = /^(\\d\\d):(\\d\\d):(\\d\\d)(\\.\\d+)?(z|[+-]\\d\\d(?::?\\d\\d)?)?$/i;\nvar HOSTNAME = /^(?=.{1,253}\\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\\.?$/i;\nvar URI = /^(?:[a-z][a-z0-9+\\-.]*:)(?:\\/?\\/(?:(?:[a-z0-9\\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\\.[a-z0-9\\-._~!$&'()*+,;=:]+)\\]|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|(?:[a-z0-9\\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\\d*)?(?:\\/(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\\/(?:(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\\?(?:[a-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;\nvar URIREF = /^(?:[a-z][a-z0-9+\\-.]*:)?(?:\\/?\\/(?:(?:[a-z0-9\\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\\.[a-z0-9\\-._~!$&'()*+,;=:]+)\\]|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|(?:[a-z0-9\\-._~!$&'\"()*+,;=]|%[0-9a-f]{2})*)(?::\\d*)?(?:\\/(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})*)*|\\/(?:(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\\?(?:[a-z0-9\\-._~!$&'\"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\\-._~!$&'\"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;\n// uri-template: https://tools.ietf.org/html/rfc6570\nvar URITEMPLATE = /^(?:(?:[^\\x00-\\x20\"'<>%\\\\^`{|}]|%[0-9a-f]{2})|\\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\\*)?)*\\})*$/i;\n// For the source: https://gist.github.com/dperini/729294\n// For test cases: https://mathiasbynens.be/demo/url-regex\n// @todo Delete current URL in favour of the commented out URL rule when this issue is fixed https://github.com/eslint/eslint/issues/7983.\n// var URL = /^(?:(?:https?|ftp):\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!10(?:\\.\\d{1,3}){3})(?!127(?:\\.\\d{1,3}){3})(?!169\\.254(?:\\.\\d{1,3}){2})(?!192\\.168(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u{00a1}-\\u{ffff}0-9]+-)*[a-z\\u{00a1}-\\u{ffff}0-9]+)(?:\\.(?:[a-z\\u{00a1}-\\u{ffff}0-9]+-)*[a-z\\u{00a1}-\\u{ffff}0-9]+)*(?:\\.(?:[a-z\\u{00a1}-\\u{ffff}]{2,})))(?::\\d{2,5})?(?:\\/[^\\s]*)?$/iu;\nvar URL = /^(?:(?:http[s\\u017F]?|ftp):\\/\\/)(?:(?:[\\0-\\x08\\x0E-\\x1F!-\\x9F\\xA1-\\u167F\\u1681-\\u1FFF\\u200B-\\u2027\\u202A-\\u202E\\u2030-\\u205E\\u2060-\\u2FFF\\u3001-\\uD7FF\\uE000-\\uFEFE\\uFF00-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])+(?::(?:[\\0-\\x08\\x0E-\\x1F!-\\x9F\\xA1-\\u167F\\u1681-\\u1FFF\\u200B-\\u2027\\u202A-\\u202E\\u2030-\\u205E\\u2060-\\u2FFF\\u3001-\\uD7FF\\uE000-\\uFEFE\\uFF00-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*)?@)?(?:(?!10(?:\\.[0-9]{1,3}){3})(?!127(?:\\.[0-9]{1,3}){3})(?!169\\.254(?:\\.[0-9]{1,3}){2})(?!192\\.168(?:\\.[0-9]{1,3}){2})(?!172\\.(?:1[6-9]|2[0-9]|3[01])(?:\\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\\xA1-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])+-)*(?:[0-9a-z\\xA1-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])+)(?:\\.(?:(?:[0-9a-z\\xA1-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])+-)*(?:[0-9a-z\\xA1-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])+)*(?:\\.(?:(?:[a-z\\xA1-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\\/(?:[\\0-\\x08\\x0E-\\x1F!-\\x9F\\xA1-\\u167F\\u1681-\\u1FFF\\u200B-\\u2027\\u202A-\\u202E\\u2030-\\u205E\\u2060-\\u2FFF\\u3001-\\uD7FF\\uE000-\\uFEFE\\uFF00-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*)?$/i;\nvar UUID = /^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i;\nvar JSON_POINTER = /^(?:\\/(?:[^~/]|~0|~1)*)*$/;\nvar JSON_POINTER_URI_FRAGMENT = /^#(?:\\/(?:[a-z0-9_\\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i;\nvar RELATIVE_JSON_POINTER = /^(?:0|[1-9][0-9]*)(?:#|(?:\\/(?:[^~/]|~0|~1)*)*)$/;\n\n\nmodule.exports = formats;\n\nfunction formats(mode) {\n  mode = mode == 'full' ? 'full' : 'fast';\n  return util.copy(formats[mode]);\n}\n\n\nformats.fast = {\n  // date: http://tools.ietf.org/html/rfc3339#section-5.6\n  date: /^\\d\\d\\d\\d-[0-1]\\d-[0-3]\\d$/,\n  // date-time: http://tools.ietf.org/html/rfc3339#section-5.6\n  time: /^(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)(?:\\.\\d+)?(?:z|[+-]\\d\\d(?::?\\d\\d)?)?$/i,\n  'date-time': /^\\d\\d\\d\\d-[0-1]\\d-[0-3]\\d[t\\s](?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)(?:\\.\\d+)?(?:z|[+-]\\d\\d(?::?\\d\\d)?)$/i,\n  // uri: https://github.com/mafintosh/is-my-json-valid/blob/master/formats.js\n  uri: /^(?:[a-z][a-z0-9+\\-.]*:)(?:\\/?\\/)?[^\\s]*$/i,\n  'uri-reference': /^(?:(?:[a-z][a-z0-9+\\-.]*:)?\\/?\\/)?(?:[^\\\\\\s#][^\\s#]*)?(?:#[^\\\\\\s]*)?$/i,\n  'uri-template': URITEMPLATE,\n  url: URL,\n  // email (sources from jsen validator):\n  // http://stackoverflow.com/questions/201323/using-a-regular-expression-to-validate-an-email-address#answer-8829363\n  // http://www.w3.org/TR/html5/forms.html#valid-e-mail-address (search for 'willful violation')\n  email: /^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,\n  hostname: HOSTNAME,\n  // optimized https://www.safaribooksonline.com/library/view/regular-expressions-cookbook/9780596802837/ch07s16.html\n  ipv4: /^(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)$/,\n  // optimized http://stackoverflow.com/questions/53497/regular-expression-that-matches-valid-ipv6-addresses\n  ipv6: /^\\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(?:%.+)?\\s*$/i,\n  regex: regex,\n  // uuid: http://tools.ietf.org/html/rfc4122\n  uuid: UUID,\n  // JSON-pointer: https://tools.ietf.org/html/rfc6901\n  // uri fragment: https://tools.ietf.org/html/rfc3986#appendix-A\n  'json-pointer': JSON_POINTER,\n  'json-pointer-uri-fragment': JSON_POINTER_URI_FRAGMENT,\n  // relative JSON-pointer: http://tools.ietf.org/html/draft-luff-relative-json-pointer-00\n  'relative-json-pointer': RELATIVE_JSON_POINTER\n};\n\n\nformats.full = {\n  date: date,\n  time: time,\n  'date-time': date_time,\n  uri: uri,\n  'uri-reference': URIREF,\n  'uri-template': URITEMPLATE,\n  url: URL,\n  email: /^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,\n  hostname: HOSTNAME,\n  ipv4: /^(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)$/,\n  ipv6: /^\\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(?:%.+)?\\s*$/i,\n  regex: regex,\n  uuid: UUID,\n  'json-pointer': JSON_POINTER,\n  'json-pointer-uri-fragment': JSON_POINTER_URI_FRAGMENT,\n  'relative-json-pointer': RELATIVE_JSON_POINTER\n};\n\n\nfunction isLeapYear(year) {\n  // https://tools.ietf.org/html/rfc3339#appendix-C\n  return year % 4 === 0 && (year % 100 !== 0 || year % 400 === 0);\n}\n\n\nfunction date(str) {\n  // full-date from http://tools.ietf.org/html/rfc3339#section-5.6\n  var matches = str.match(DATE);\n  if (!matches) return false;\n\n  var year = +matches[1];\n  var month = +matches[2];\n  var day = +matches[3];\n\n  return month >= 1 && month <= 12 && day >= 1 &&\n          day <= (month == 2 && isLeapYear(year) ? 29 : DAYS[month]);\n}\n\n\nfunction time(str, full) {\n  var matches = str.match(TIME);\n  if (!matches) return false;\n\n  var hour = matches[1];\n  var minute = matches[2];\n  var second = matches[3];\n  var timeZone = matches[5];\n  return ((hour <= 23 && minute <= 59 && second <= 59) ||\n          (hour == 23 && minute == 59 && second == 60)) &&\n         (!full || timeZone);\n}\n\n\nvar DATE_TIME_SEPARATOR = /t|\\s/i;\nfunction date_time(str) {\n  // http://tools.ietf.org/html/rfc3339#section-5.6\n  var dateTime = str.split(DATE_TIME_SEPARATOR);\n  return dateTime.length == 2 && date(dateTime[0]) && time(dateTime[1], true);\n}\n\n\nvar NOT_URI_FRAGMENT = /\\/|:/;\nfunction uri(str) {\n  // http://jmrware.com/articles/2009/uri_regexp/URI_regex.html + optional protocol + required \".\"\n  return NOT_URI_FRAGMENT.test(str) && URI.test(str);\n}\n\n\nvar Z_ANCHOR = /[^\\\\]\\\\Z/;\nfunction regex(str) {\n  if (Z_ANCHOR.test(str)) return false;\n  try {\n    new RegExp(str);\n    return true;\n  } catch(e) {\n    return false;\n  }\n}\n","'use strict'\n\nvar lineBox = require('./line-box')\n\n/**\n * box-line collision\n * @param {number} xb top-left corner of box\n * @param {number} yb top-left corner of box\n * @param {number} wb width of box\n * @param {number} hb height of box\n * @param {number} x1 first point of line\n * @param {number} y1 first point of line\n * @param {number} x2 second point of line\n * @param {number} y2 second point of line\n */\nmodule.exports = function boxLine(xb, yb, wb, hb, x1, y1, x2, y2)\n{\n    return lineBox(x1, y1, x2, y2, xb, yb, wb, hb)\n}\n","const BaseProcess = require('./process');\r\nconst ErrorList = require('./errorlist');\r\nconst JsonSchemaValidator = require('./jsonschema');\r\nconst ProcessGraph = require('./processgraph');\r\nconst ProcessGraphError = require('./error');\r\nconst ProcessGraphNode = require('./node');\r\nconst ProcessRegistry = require('./registry');\r\nconst Utils = require('./utils');\r\n\r\nmodule.exports = {\r\n\tBaseProcess,\r\n\tErrorList,\r\n\tJsonSchemaValidator,\r\n\tProcessGraph,\r\n\tProcessGraphError,\r\n\tProcessGraphNode,\r\n\tProcessRegistry,\r\n\tUtils\r\n};","'use strict';\nmodule.exports = function generate_multipleOf(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  if (!($isData || typeof $schema == 'number')) {\n    throw new Error($keyword + ' must be number');\n  }\n  out += 'var division' + ($lvl) + ';if (';\n  if ($isData) {\n    out += ' ' + ($schemaValue) + ' !== undefined && ( typeof ' + ($schemaValue) + ' != \\'number\\' || ';\n  }\n  out += ' (division' + ($lvl) + ' = ' + ($data) + ' / ' + ($schemaValue) + ', ';\n  if (it.opts.multipleOfPrecision) {\n    out += ' Math.abs(Math.round(division' + ($lvl) + ') - division' + ($lvl) + ') > 1e-' + (it.opts.multipleOfPrecision) + ' ';\n  } else {\n    out += ' division' + ($lvl) + ' !== parseInt(division' + ($lvl) + ') ';\n  }\n  out += ' ) ';\n  if ($isData) {\n    out += '  )  ';\n  }\n  out += ' ) {   ';\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ('multipleOf') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { multipleOf: ' + ($schemaValue) + ' } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should be multiple of ';\n      if ($isData) {\n        out += '\\' + ' + ($schemaValue);\n      } else {\n        out += '' + ($schemaValue) + '\\'';\n      }\n    }\n    if (it.opts.verbose) {\n      out += ' , schema:  ';\n      if ($isData) {\n        out += 'validate.schema' + ($schemaPath);\n      } else {\n        out += '' + ($schema);\n      }\n      out += '         , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += '} ';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict';\n\nvar URI = require('uri-js')\n  , equal = require('fast-deep-equal')\n  , util = require('./util')\n  , SchemaObject = require('./schema_obj')\n  , traverse = require('json-schema-traverse');\n\nmodule.exports = resolve;\n\nresolve.normalizeId = normalizeId;\nresolve.fullPath = getFullPath;\nresolve.url = resolveUrl;\nresolve.ids = resolveIds;\nresolve.inlineRef = inlineRef;\nresolve.schema = resolveSchema;\n\n/**\n * [resolve and compile the references ($ref)]\n * @this   Ajv\n * @param  {Function} compile reference to schema compilation funciton (localCompile)\n * @param  {Object} root object with information about the root schema for the current schema\n * @param  {String} ref reference to resolve\n * @return {Object|Function} schema object (if the schema can be inlined) or validation function\n */\nfunction resolve(compile, root, ref) {\n  /* jshint validthis: true */\n  var refVal = this._refs[ref];\n  if (typeof refVal == 'string') {\n    if (this._refs[refVal]) refVal = this._refs[refVal];\n    else return resolve.call(this, compile, root, refVal);\n  }\n\n  refVal = refVal || this._schemas[ref];\n  if (refVal instanceof SchemaObject) {\n    return inlineRef(refVal.schema, this._opts.inlineRefs)\n            ? refVal.schema\n            : refVal.validate || this._compile(refVal);\n  }\n\n  var res = resolveSchema.call(this, root, ref);\n  var schema, v, baseId;\n  if (res) {\n    schema = res.schema;\n    root = res.root;\n    baseId = res.baseId;\n  }\n\n  if (schema instanceof SchemaObject) {\n    v = schema.validate || compile.call(this, schema.schema, root, undefined, baseId);\n  } else if (schema !== undefined) {\n    v = inlineRef(schema, this._opts.inlineRefs)\n        ? schema\n        : compile.call(this, schema, root, undefined, baseId);\n  }\n\n  return v;\n}\n\n\n/**\n * Resolve schema, its root and baseId\n * @this Ajv\n * @param  {Object} root root object with properties schema, refVal, refs\n * @param  {String} ref  reference to resolve\n * @return {Object} object with properties schema, root, baseId\n */\nfunction resolveSchema(root, ref) {\n  /* jshint validthis: true */\n  var p = URI.parse(ref)\n    , refPath = _getFullPath(p)\n    , baseId = getFullPath(this._getId(root.schema));\n  if (Object.keys(root.schema).length === 0 || refPath !== baseId) {\n    var id = normalizeId(refPath);\n    var refVal = this._refs[id];\n    if (typeof refVal == 'string') {\n      return resolveRecursive.call(this, root, refVal, p);\n    } else if (refVal instanceof SchemaObject) {\n      if (!refVal.validate) this._compile(refVal);\n      root = refVal;\n    } else {\n      refVal = this._schemas[id];\n      if (refVal instanceof SchemaObject) {\n        if (!refVal.validate) this._compile(refVal);\n        if (id == normalizeId(ref))\n          return { schema: refVal, root: root, baseId: baseId };\n        root = refVal;\n      } else {\n        return;\n      }\n    }\n    if (!root.schema) return;\n    baseId = getFullPath(this._getId(root.schema));\n  }\n  return getJsonPointer.call(this, p, baseId, root.schema, root);\n}\n\n\n/* @this Ajv */\nfunction resolveRecursive(root, ref, parsedRef) {\n  /* jshint validthis: true */\n  var res = resolveSchema.call(this, root, ref);\n  if (res) {\n    var schema = res.schema;\n    var baseId = res.baseId;\n    root = res.root;\n    var id = this._getId(schema);\n    if (id) baseId = resolveUrl(baseId, id);\n    return getJsonPointer.call(this, parsedRef, baseId, schema, root);\n  }\n}\n\n\nvar PREVENT_SCOPE_CHANGE = util.toHash(['properties', 'patternProperties', 'enum', 'dependencies', 'definitions']);\n/* @this Ajv */\nfunction getJsonPointer(parsedRef, baseId, schema, root) {\n  /* jshint validthis: true */\n  parsedRef.fragment = parsedRef.fragment || '';\n  if (parsedRef.fragment.slice(0,1) != '/') return;\n  var parts = parsedRef.fragment.split('/');\n\n  for (var i = 1; i < parts.length; i++) {\n    var part = parts[i];\n    if (part) {\n      part = util.unescapeFragment(part);\n      schema = schema[part];\n      if (schema === undefined) break;\n      var id;\n      if (!PREVENT_SCOPE_CHANGE[part]) {\n        id = this._getId(schema);\n        if (id) baseId = resolveUrl(baseId, id);\n        if (schema.$ref) {\n          var $ref = resolveUrl(baseId, schema.$ref);\n          var res = resolveSchema.call(this, root, $ref);\n          if (res) {\n            schema = res.schema;\n            root = res.root;\n            baseId = res.baseId;\n          }\n        }\n      }\n    }\n  }\n  if (schema !== undefined && schema !== root.schema)\n    return { schema: schema, root: root, baseId: baseId };\n}\n\n\nvar SIMPLE_INLINED = util.toHash([\n  'type', 'format', 'pattern',\n  'maxLength', 'minLength',\n  'maxProperties', 'minProperties',\n  'maxItems', 'minItems',\n  'maximum', 'minimum',\n  'uniqueItems', 'multipleOf',\n  'required', 'enum'\n]);\nfunction inlineRef(schema, limit) {\n  if (limit === false) return false;\n  if (limit === undefined || limit === true) return checkNoRef(schema);\n  else if (limit) return countKeys(schema) <= limit;\n}\n\n\nfunction checkNoRef(schema) {\n  var item;\n  if (Array.isArray(schema)) {\n    for (var i=0; i<schema.length; i++) {\n      item = schema[i];\n      if (typeof item == 'object' && !checkNoRef(item)) return false;\n    }\n  } else {\n    for (var key in schema) {\n      if (key == '$ref') return false;\n      item = schema[key];\n      if (typeof item == 'object' && !checkNoRef(item)) return false;\n    }\n  }\n  return true;\n}\n\n\nfunction countKeys(schema) {\n  var count = 0, item;\n  if (Array.isArray(schema)) {\n    for (var i=0; i<schema.length; i++) {\n      item = schema[i];\n      if (typeof item == 'object') count += countKeys(item);\n      if (count == Infinity) return Infinity;\n    }\n  } else {\n    for (var key in schema) {\n      if (key == '$ref') return Infinity;\n      if (SIMPLE_INLINED[key]) {\n        count++;\n      } else {\n        item = schema[key];\n        if (typeof item == 'object') count += countKeys(item) + 1;\n        if (count == Infinity) return Infinity;\n      }\n    }\n  }\n  return count;\n}\n\n\nfunction getFullPath(id, normalize) {\n  if (normalize !== false) id = normalizeId(id);\n  var p = URI.parse(id);\n  return _getFullPath(p);\n}\n\n\nfunction _getFullPath(p) {\n  return URI.serialize(p).split('#')[0] + '#';\n}\n\n\nvar TRAILING_SLASH_HASH = /#\\/?$/;\nfunction normalizeId(id) {\n  return id ? id.replace(TRAILING_SLASH_HASH, '') : '';\n}\n\n\nfunction resolveUrl(baseId, id) {\n  id = normalizeId(id);\n  return URI.resolve(baseId, id);\n}\n\n\n/* @this Ajv */\nfunction resolveIds(schema) {\n  var schemaId = normalizeId(this._getId(schema));\n  var baseIds = {'': schemaId};\n  var fullPaths = {'': getFullPath(schemaId, false)};\n  var localRefs = {};\n  var self = this;\n\n  traverse(schema, {allKeys: true}, function(sch, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex) {\n    if (jsonPtr === '') return;\n    var id = self._getId(sch);\n    var baseId = baseIds[parentJsonPtr];\n    var fullPath = fullPaths[parentJsonPtr] + '/' + parentKeyword;\n    if (keyIndex !== undefined)\n      fullPath += '/' + (typeof keyIndex == 'number' ? keyIndex : util.escapeFragment(keyIndex));\n\n    if (typeof id == 'string') {\n      id = baseId = normalizeId(baseId ? URI.resolve(baseId, id) : id);\n\n      var refVal = self._refs[id];\n      if (typeof refVal == 'string') refVal = self._refs[refVal];\n      if (refVal && refVal.schema) {\n        if (!equal(sch, refVal.schema))\n          throw new Error('id \"' + id + '\" resolves to more than one schema');\n      } else if (id != normalizeId(fullPath)) {\n        if (id[0] == '#') {\n          if (localRefs[id] && !equal(sch, localRefs[id]))\n            throw new Error('id \"' + id + '\" resolves to more than one schema');\n          localRefs[id] = sch;\n        } else {\n          self._refs[id] = fullPath;\n        }\n      }\n    }\n    baseIds[jsonPtr] = baseId;\n    fullPaths[jsonPtr] = fullPath;\n  });\n\n  return localRefs;\n}\n","'use strict';\n\nvar MissingRefError = require('./error_classes').MissingRef;\n\nmodule.exports = compileAsync;\n\n\n/**\n * Creates validating function for passed schema with asynchronous loading of missing schemas.\n * `loadSchema` option should be a function that accepts schema uri and returns promise that resolves with the schema.\n * @this  Ajv\n * @param {Object}   schema schema object\n * @param {Boolean}  meta optional true to compile meta-schema; this parameter can be skipped\n * @param {Function} callback an optional node-style callback, it is called with 2 parameters: error (or null) and validating function.\n * @return {Promise} promise that resolves with a validating function.\n */\nfunction compileAsync(schema, meta, callback) {\n  /* eslint no-shadow: 0 */\n  /* global Promise */\n  /* jshint validthis: true */\n  var self = this;\n  if (typeof this._opts.loadSchema != 'function')\n    throw new Error('options.loadSchema should be a function');\n\n  if (typeof meta == 'function') {\n    callback = meta;\n    meta = undefined;\n  }\n\n  var p = loadMetaSchemaOf(schema).then(function () {\n    var schemaObj = self._addSchema(schema, undefined, meta);\n    return schemaObj.validate || _compileAsync(schemaObj);\n  });\n\n  if (callback) {\n    p.then(\n      function(v) { callback(null, v); },\n      callback\n    );\n  }\n\n  return p;\n\n\n  function loadMetaSchemaOf(sch) {\n    var $schema = sch.$schema;\n    return $schema && !self.getSchema($schema)\n            ? compileAsync.call(self, { $ref: $schema }, true)\n            : Promise.resolve();\n  }\n\n\n  function _compileAsync(schemaObj) {\n    try { return self._compile(schemaObj); }\n    catch(e) {\n      if (e instanceof MissingRefError) return loadMissingSchema(e);\n      throw e;\n    }\n\n\n    function loadMissingSchema(e) {\n      var ref = e.missingSchema;\n      if (added(ref)) throw new Error('Schema ' + ref + ' is loaded but ' + e.missingRef + ' cannot be resolved');\n\n      var schemaPromise = self._loadingSchemas[ref];\n      if (!schemaPromise) {\n        schemaPromise = self._loadingSchemas[ref] = self._opts.loadSchema(ref);\n        schemaPromise.then(removePromise, removePromise);\n      }\n\n      return schemaPromise.then(function (sch) {\n        if (!added(ref)) {\n          return loadMetaSchemaOf(sch).then(function () {\n            if (!added(ref)) self.addSchema(sch, ref, undefined, meta);\n          });\n        }\n      }).then(function() {\n        return _compileAsync(schemaObj);\n      });\n\n      function removePromise() {\n        delete self._loadingSchemas[ref];\n      }\n\n      function added(ref) {\n        return self._refs[ref] || self._schemas[ref];\n      }\n    }\n  }\n}\n","const JsonSchemaValidator = require('./jsonschema');\r\nconst ProcessGraphError = require('./error');\r\nconst ProcessUtils = require('@openeo/js-commons/src/processUtils');\r\nconst Utils = require('./utils');\r\n\r\n/**\r\n * Base Process class\r\n * \r\n * @class\r\n */\r\nclass BaseProcess {\r\n\r\n\tconstructor(spec) {\r\n\t\t// Make properties easily accessible \r\n\t\tObject.assign(this, spec);\r\n\r\n\t\tif (typeof this.id !== 'string') {\r\n\t\t\tthrow new Error(\"Invalid process specified, no id given.\");\r\n\t\t}\r\n\t\tif (!Array.isArray(this.parameters)) {\r\n\t\t\tthis.parameters = [];\r\n\t\t}\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\treturn Utils.omitFromObject(this, [\"validate\", \"validateArgument\", \"execute\", \"test\"]);\r\n\t}\r\n\r\n\tasync validate(node) {\r\n\t\t// Check for arguments we don't support and throw error\r\n\t\tlet unsupportedArgs = node.getArgumentNames().filter(name => this.parameters.findIndex(p => p.name === name) === -1);\r\n\t\tif (unsupportedArgs.length > 0) {\r\n\t\t\tthrow new ProcessGraphError('ProcessArgumentUnsupported', {\r\n\t\t\t\tprocess: this.id,\r\n\t\t\t\tnamespace: this.namespace || 'n/a',\r\n\t\t\t\targuments: unsupportedArgs\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Validate against JSON Schema\r\n\t\tfor(let key in this.parameters) {\r\n\t\t\tlet param = this.parameters[key];\r\n\r\n\t\t\tif (!node.hasArgument(param.name)) {\r\n\t\t\t\tif (!param.optional) {\r\n\t\t\t\t\tthrow new ProcessGraphError('ProcessArgumentRequired', {\r\n\t\t\t\t\t\tprocess: this.id,\r\n\t\t\t\t\t\tnamespace: this.namespace || 'n/a',\r\n\t\t\t\t\t\targument: param.name\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet arg = node.getParsedArgument(param.name);\r\n\t\t\tlet rawArg = node.getRawArgument(param.name);\r\n\t\t\tawait this.validateArgument(arg, rawArg, node, param);\r\n\t\t}\r\n\t}\r\n\r\n\tasync validateArgument(arg, rawArg, node, param, path = null) {\r\n\t\tif (!path) {\r\n\t\t\tpath = param.name;\r\n\t\t}\r\n\t\tlet argType = Utils.getType(arg);\r\n\t\tlet pg = node.getProcessGraph();\r\n\t\tswitch(argType) {\r\n\t\t\tcase 'parameter':\r\n\t\t\t\t// Validate callback parameters (no value available yet)\r\n\t\t\t\tlet callbackParam = pg.getCallbackParameter(arg.from_parameter);\r\n\t\t\t\tif (callbackParam) {\r\n\t\t\t\t\tif (!JsonSchemaValidator.isSchemaCompatible(param.schema, callbackParam.schema)) {\r\n\t\t\t\t\t\tthrow new ProcessGraphError('ProcessArgumentInvalid', {\r\n\t\t\t\t\t\t\tprocess: this.id,\r\n\t\t\t\t\t\t\tnamespace: this.namespace || 'n/a',\r\n\t\t\t\t\t\t\targument: path,\r\n\t\t\t\t\t\t\treason: \"Schema for parameter '\" + arg.from_parameter + \"' not compatible with reference\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Validate all other parameters (value must be available if allowUndefinedParameterRefs is false)\r\n\t\t\t\tlet value = node.getProcessGraphParameterValue(arg.from_parameter);\r\n\t\t\t\tif (typeof value === 'undefined' && !pg.allowUndefinedParameterRefs) {\r\n\t\t\t\t\tthrow new ProcessGraphError('ProcessGraphParameterMissing', {\r\n\t\t\t\t\t\targument: arg.from_parameter,\r\n\t\t\t\t\t\tnode_id: node.id,\r\n\t\t\t\t\t\tprocess_id: node.process_id,\r\n\t\t\t\t\t\tnamespace: node.namespace || 'n/a'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet parameter = pg.getProcessParameter(arg.from_parameter);\r\n\t\t\t\tif (Utils.isObject(parameter) && parameter.schema) {\r\n\t\t\t\t\tif (typeof value !== 'undefined') {\r\n\t\t\t\t\t\tawait this.validateArgument(value, rawArg, node, parameter, path);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!JsonSchemaValidator.isSchemaCompatible(param.schema, parameter.schema)) {\r\n\t\t\t\t\t\tthrow new ProcessGraphError('ProcessArgumentInvalid', {\r\n\t\t\t\t\t\t\tprocess: this.id,\r\n\t\t\t\t\t\t\tnamespace: this.namespace || 'n/a',\r\n\t\t\t\t\t\t\targument: path,\r\n\t\t\t\t\t\t\treason: \"Schema for parameter '\" + arg.from_parameter + \"' not compatible\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// else: Parameter not available, everything is valid\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'result':\r\n\t\t\t\tlet resultNode = pg.getNode(arg.from_node);\r\n\t\t\t\tlet process = pg.getProcess(resultNode);\r\n\t\t\t\tif (!JsonSchemaValidator.isSchemaCompatible(param.schema, process.returns.schema)) {\r\n\t\t\t\t\tthrow new ProcessGraphError('ProcessArgumentInvalid', {\r\n\t\t\t\t\t\tprocess: this.id,\r\n\t\t\t\t\t\tnamespace: this.namespace || 'n/a',\r\n\t\t\t\t\t\targument: path,\r\n\t\t\t\t\t\treason: \"Schema for result '\" + arg.from_node + \"' not compatible\"\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'array':\r\n\t\t\tcase 'object':\r\n\t\t\t\tlet schemas = ProcessUtils.normalizeJsonSchema(param.schema).filter(schema => ['array', 'object'].includes(schema.type));\r\n\t\t\t\t// Check if it is expected to be a process. If yes, do normal validation. Handles the issue discussed in https://github.com/Open-EO/openeo-js-processgraphs/issues/4\r\n\t\t\t\tlet isProcessGraphSchema = (schemas.length === 1 && schemas[0].subtype === 'process-graph');\r\n\t\t\t\tif (Utils.containsRef(rawArg) && !isProcessGraphSchema) {\r\n\t\t\t\t\t// This tries to at least be compliant to one of the element schemas\r\n\t\t\t\t\t// It's better than validating nothing, but it's still not 100% correct\r\n\t\t\t\t\tfor(var key in arg) {\r\n\t\t\t\t\t\tlet elementSchema = schemas.map(schema =>  ProcessUtils.getElementJsonSchema(schema, key)).filter(schema => Object.keys(schema).length); // jshint ignore:line\r\n\t\t\t\t\t\tif (elementSchema.length > 0) {\r\n\t\t\t\t\t\t\tlet validated = 0;\r\n\t\t\t\t\t\t\tlet lastError = null;\r\n\t\t\t\t\t\t\tfor(let schema of elementSchema) {\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t// ToDo: Check against JSON schema required property\r\n\t\t\t\t\t\t\t\t\tawait this.validateArgument(arg[key], rawArg[key], node, {schema}, path + '/' + key);\r\n\t\t\t\t\t\t\t\t\tvalidated++;\r\n\t\t\t\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\t\t\t\tlastError = error;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (validated === 0 && lastError) {\r\n\t\t\t\t\t\t\t\tthrow lastError;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t// Use default behavior below, so no break; needed\r\n\t\t\t\t} // jshint ignore:line\r\n\t\t\tdefault:\r\n\t\t\t\tlet validator = node.getProcessGraph().getJsonSchemaValidator();\r\n\t\t\t\t// Validate against JSON schema\r\n\t\t\t\tlet errors = await validator.validateValue(arg, param.schema);\r\n\t\t\t\tif (errors.length > 0) {\r\n\t\t\t\t\tthrow new ProcessGraphError('ProcessArgumentInvalid', {\r\n\t\t\t\t\t\tprocess: this.id,\r\n\t\t\t\t\t\tnamespace: this.namespace || 'n/a',\r\n\t\t\t\t\t\targument: path,\r\n\t\t\t\t\t\treason: errors\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/* istanbul ignore next */\r\n\tasync execute(/*node*/) {\r\n\t\tthrow new Error(`execute not implemented yet for process '${this.id}' (namespace: ${this.namespace || 'n/a'})`);\r\n\t}\r\n\r\n\t/* istanbul ignore next */\r\n\ttest() {\r\n\t\t// Run the tests from the examples\r\n\t\tthrow new Error(`test not implemented yet for process '${this.id}' (namespace: ${this.namespace || 'n/a'})`);\r\n\t}\r\n\r\n}\r\n\r\nmodule.exports =  BaseProcess;","'use strict';\nmodule.exports = function generate_required(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  var $vSchema = 'schema' + $lvl;\n  if (!$isData) {\n    if ($schema.length < it.opts.loopRequired && it.schema.properties && Object.keys(it.schema.properties).length) {\n      var $required = [];\n      var arr1 = $schema;\n      if (arr1) {\n        var $property, i1 = -1,\n          l1 = arr1.length - 1;\n        while (i1 < l1) {\n          $property = arr1[i1 += 1];\n          var $propertySch = it.schema.properties[$property];\n          if (!($propertySch && (it.opts.strictKeywords ? (typeof $propertySch == 'object' && Object.keys($propertySch).length > 0) || $propertySch === false : it.util.schemaHasRules($propertySch, it.RULES.all)))) {\n            $required[$required.length] = $property;\n          }\n        }\n      }\n    } else {\n      var $required = $schema;\n    }\n  }\n  if ($isData || $required.length) {\n    var $currentErrorPath = it.errorPath,\n      $loopRequired = $isData || $required.length >= it.opts.loopRequired,\n      $ownProperties = it.opts.ownProperties;\n    if ($breakOnError) {\n      out += ' var missing' + ($lvl) + '; ';\n      if ($loopRequired) {\n        if (!$isData) {\n          out += ' var ' + ($vSchema) + ' = validate.schema' + ($schemaPath) + '; ';\n        }\n        var $i = 'i' + $lvl,\n          $propertyPath = 'schema' + $lvl + '[' + $i + ']',\n          $missingProperty = '\\' + ' + $propertyPath + ' + \\'';\n        if (it.opts._errorDataPathProperty) {\n          it.errorPath = it.util.getPathExpr($currentErrorPath, $propertyPath, it.opts.jsonPointers);\n        }\n        out += ' var ' + ($valid) + ' = true; ';\n        if ($isData) {\n          out += ' if (schema' + ($lvl) + ' === undefined) ' + ($valid) + ' = true; else if (!Array.isArray(schema' + ($lvl) + ')) ' + ($valid) + ' = false; else {';\n        }\n        out += ' for (var ' + ($i) + ' = 0; ' + ($i) + ' < ' + ($vSchema) + '.length; ' + ($i) + '++) { ' + ($valid) + ' = ' + ($data) + '[' + ($vSchema) + '[' + ($i) + ']] !== undefined ';\n        if ($ownProperties) {\n          out += ' &&   Object.prototype.hasOwnProperty.call(' + ($data) + ', ' + ($vSchema) + '[' + ($i) + ']) ';\n        }\n        out += '; if (!' + ($valid) + ') break; } ';\n        if ($isData) {\n          out += '  }  ';\n        }\n        out += '  if (!' + ($valid) + ') {   ';\n        var $$outStack = $$outStack || [];\n        $$outStack.push(out);\n        out = ''; /* istanbul ignore else */\n        if (it.createErrors !== false) {\n          out += ' { keyword: \\'' + ('required') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { missingProperty: \\'' + ($missingProperty) + '\\' } ';\n          if (it.opts.messages !== false) {\n            out += ' , message: \\'';\n            if (it.opts._errorDataPathProperty) {\n              out += 'is a required property';\n            } else {\n              out += 'should have required property \\\\\\'' + ($missingProperty) + '\\\\\\'';\n            }\n            out += '\\' ';\n          }\n          if (it.opts.verbose) {\n            out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n          }\n          out += ' } ';\n        } else {\n          out += ' {} ';\n        }\n        var __err = out;\n        out = $$outStack.pop();\n        if (!it.compositeRule && $breakOnError) {\n          /* istanbul ignore if */\n          if (it.async) {\n            out += ' throw new ValidationError([' + (__err) + ']); ';\n          } else {\n            out += ' validate.errors = [' + (__err) + ']; return false; ';\n          }\n        } else {\n          out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n        }\n        out += ' } else { ';\n      } else {\n        out += ' if ( ';\n        var arr2 = $required;\n        if (arr2) {\n          var $propertyKey, $i = -1,\n            l2 = arr2.length - 1;\n          while ($i < l2) {\n            $propertyKey = arr2[$i += 1];\n            if ($i) {\n              out += ' || ';\n            }\n            var $prop = it.util.getProperty($propertyKey),\n              $useData = $data + $prop;\n            out += ' ( ( ' + ($useData) + ' === undefined ';\n            if ($ownProperties) {\n              out += ' || ! Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($propertyKey)) + '\\') ';\n            }\n            out += ') && (missing' + ($lvl) + ' = ' + (it.util.toQuotedString(it.opts.jsonPointers ? $propertyKey : $prop)) + ') ) ';\n          }\n        }\n        out += ') {  ';\n        var $propertyPath = 'missing' + $lvl,\n          $missingProperty = '\\' + ' + $propertyPath + ' + \\'';\n        if (it.opts._errorDataPathProperty) {\n          it.errorPath = it.opts.jsonPointers ? it.util.getPathExpr($currentErrorPath, $propertyPath, true) : $currentErrorPath + ' + ' + $propertyPath;\n        }\n        var $$outStack = $$outStack || [];\n        $$outStack.push(out);\n        out = ''; /* istanbul ignore else */\n        if (it.createErrors !== false) {\n          out += ' { keyword: \\'' + ('required') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { missingProperty: \\'' + ($missingProperty) + '\\' } ';\n          if (it.opts.messages !== false) {\n            out += ' , message: \\'';\n            if (it.opts._errorDataPathProperty) {\n              out += 'is a required property';\n            } else {\n              out += 'should have required property \\\\\\'' + ($missingProperty) + '\\\\\\'';\n            }\n            out += '\\' ';\n          }\n          if (it.opts.verbose) {\n            out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n          }\n          out += ' } ';\n        } else {\n          out += ' {} ';\n        }\n        var __err = out;\n        out = $$outStack.pop();\n        if (!it.compositeRule && $breakOnError) {\n          /* istanbul ignore if */\n          if (it.async) {\n            out += ' throw new ValidationError([' + (__err) + ']); ';\n          } else {\n            out += ' validate.errors = [' + (__err) + ']; return false; ';\n          }\n        } else {\n          out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n        }\n        out += ' } else { ';\n      }\n    } else {\n      if ($loopRequired) {\n        if (!$isData) {\n          out += ' var ' + ($vSchema) + ' = validate.schema' + ($schemaPath) + '; ';\n        }\n        var $i = 'i' + $lvl,\n          $propertyPath = 'schema' + $lvl + '[' + $i + ']',\n          $missingProperty = '\\' + ' + $propertyPath + ' + \\'';\n        if (it.opts._errorDataPathProperty) {\n          it.errorPath = it.util.getPathExpr($currentErrorPath, $propertyPath, it.opts.jsonPointers);\n        }\n        if ($isData) {\n          out += ' if (' + ($vSchema) + ' && !Array.isArray(' + ($vSchema) + ')) {  var err =   '; /* istanbul ignore else */\n          if (it.createErrors !== false) {\n            out += ' { keyword: \\'' + ('required') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { missingProperty: \\'' + ($missingProperty) + '\\' } ';\n            if (it.opts.messages !== false) {\n              out += ' , message: \\'';\n              if (it.opts._errorDataPathProperty) {\n                out += 'is a required property';\n              } else {\n                out += 'should have required property \\\\\\'' + ($missingProperty) + '\\\\\\'';\n              }\n              out += '\\' ';\n            }\n            if (it.opts.verbose) {\n              out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n            }\n            out += ' } ';\n          } else {\n            out += ' {} ';\n          }\n          out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if (' + ($vSchema) + ' !== undefined) { ';\n        }\n        out += ' for (var ' + ($i) + ' = 0; ' + ($i) + ' < ' + ($vSchema) + '.length; ' + ($i) + '++) { if (' + ($data) + '[' + ($vSchema) + '[' + ($i) + ']] === undefined ';\n        if ($ownProperties) {\n          out += ' || ! Object.prototype.hasOwnProperty.call(' + ($data) + ', ' + ($vSchema) + '[' + ($i) + ']) ';\n        }\n        out += ') {  var err =   '; /* istanbul ignore else */\n        if (it.createErrors !== false) {\n          out += ' { keyword: \\'' + ('required') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { missingProperty: \\'' + ($missingProperty) + '\\' } ';\n          if (it.opts.messages !== false) {\n            out += ' , message: \\'';\n            if (it.opts._errorDataPathProperty) {\n              out += 'is a required property';\n            } else {\n              out += 'should have required property \\\\\\'' + ($missingProperty) + '\\\\\\'';\n            }\n            out += '\\' ';\n          }\n          if (it.opts.verbose) {\n            out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n          }\n          out += ' } ';\n        } else {\n          out += ' {} ';\n        }\n        out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ';\n        if ($isData) {\n          out += '  }  ';\n        }\n      } else {\n        var arr3 = $required;\n        if (arr3) {\n          var $propertyKey, i3 = -1,\n            l3 = arr3.length - 1;\n          while (i3 < l3) {\n            $propertyKey = arr3[i3 += 1];\n            var $prop = it.util.getProperty($propertyKey),\n              $missingProperty = it.util.escapeQuotes($propertyKey),\n              $useData = $data + $prop;\n            if (it.opts._errorDataPathProperty) {\n              it.errorPath = it.util.getPath($currentErrorPath, $propertyKey, it.opts.jsonPointers);\n            }\n            out += ' if ( ' + ($useData) + ' === undefined ';\n            if ($ownProperties) {\n              out += ' || ! Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($propertyKey)) + '\\') ';\n            }\n            out += ') {  var err =   '; /* istanbul ignore else */\n            if (it.createErrors !== false) {\n              out += ' { keyword: \\'' + ('required') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { missingProperty: \\'' + ($missingProperty) + '\\' } ';\n              if (it.opts.messages !== false) {\n                out += ' , message: \\'';\n                if (it.opts._errorDataPathProperty) {\n                  out += 'is a required property';\n                } else {\n                  out += 'should have required property \\\\\\'' + ($missingProperty) + '\\\\\\'';\n                }\n                out += '\\' ';\n              }\n              if (it.opts.verbose) {\n                out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n              }\n              out += ' } ';\n            } else {\n              out += ' {} ';\n            }\n            out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } ';\n          }\n        }\n      }\n    }\n    it.errorPath = $currentErrorPath;\n  } else if ($breakOnError) {\n    out += ' if (true) {';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_dependencies(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $schemaDeps = {},\n    $propertyDeps = {},\n    $ownProperties = it.opts.ownProperties;\n  for ($property in $schema) {\n    if ($property == '__proto__') continue;\n    var $sch = $schema[$property];\n    var $deps = Array.isArray($sch) ? $propertyDeps : $schemaDeps;\n    $deps[$property] = $sch;\n  }\n  out += 'var ' + ($errs) + ' = errors;';\n  var $currentErrorPath = it.errorPath;\n  out += 'var missing' + ($lvl) + ';';\n  for (var $property in $propertyDeps) {\n    $deps = $propertyDeps[$property];\n    if ($deps.length) {\n      out += ' if ( ' + ($data) + (it.util.getProperty($property)) + ' !== undefined ';\n      if ($ownProperties) {\n        out += ' && Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($property)) + '\\') ';\n      }\n      if ($breakOnError) {\n        out += ' && ( ';\n        var arr1 = $deps;\n        if (arr1) {\n          var $propertyKey, $i = -1,\n            l1 = arr1.length - 1;\n          while ($i < l1) {\n            $propertyKey = arr1[$i += 1];\n            if ($i) {\n              out += ' || ';\n            }\n            var $prop = it.util.getProperty($propertyKey),\n              $useData = $data + $prop;\n            out += ' ( ( ' + ($useData) + ' === undefined ';\n            if ($ownProperties) {\n              out += ' || ! Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($propertyKey)) + '\\') ';\n            }\n            out += ') && (missing' + ($lvl) + ' = ' + (it.util.toQuotedString(it.opts.jsonPointers ? $propertyKey : $prop)) + ') ) ';\n          }\n        }\n        out += ')) {  ';\n        var $propertyPath = 'missing' + $lvl,\n          $missingProperty = '\\' + ' + $propertyPath + ' + \\'';\n        if (it.opts._errorDataPathProperty) {\n          it.errorPath = it.opts.jsonPointers ? it.util.getPathExpr($currentErrorPath, $propertyPath, true) : $currentErrorPath + ' + ' + $propertyPath;\n        }\n        var $$outStack = $$outStack || [];\n        $$outStack.push(out);\n        out = ''; /* istanbul ignore else */\n        if (it.createErrors !== false) {\n          out += ' { keyword: \\'' + ('dependencies') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { property: \\'' + (it.util.escapeQuotes($property)) + '\\', missingProperty: \\'' + ($missingProperty) + '\\', depsCount: ' + ($deps.length) + ', deps: \\'' + (it.util.escapeQuotes($deps.length == 1 ? $deps[0] : $deps.join(\", \"))) + '\\' } ';\n          if (it.opts.messages !== false) {\n            out += ' , message: \\'should have ';\n            if ($deps.length == 1) {\n              out += 'property ' + (it.util.escapeQuotes($deps[0]));\n            } else {\n              out += 'properties ' + (it.util.escapeQuotes($deps.join(\", \")));\n            }\n            out += ' when property ' + (it.util.escapeQuotes($property)) + ' is present\\' ';\n          }\n          if (it.opts.verbose) {\n            out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n          }\n          out += ' } ';\n        } else {\n          out += ' {} ';\n        }\n        var __err = out;\n        out = $$outStack.pop();\n        if (!it.compositeRule && $breakOnError) {\n          /* istanbul ignore if */\n          if (it.async) {\n            out += ' throw new ValidationError([' + (__err) + ']); ';\n          } else {\n            out += ' validate.errors = [' + (__err) + ']; return false; ';\n          }\n        } else {\n          out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n        }\n      } else {\n        out += ' ) { ';\n        var arr2 = $deps;\n        if (arr2) {\n          var $propertyKey, i2 = -1,\n            l2 = arr2.length - 1;\n          while (i2 < l2) {\n            $propertyKey = arr2[i2 += 1];\n            var $prop = it.util.getProperty($propertyKey),\n              $missingProperty = it.util.escapeQuotes($propertyKey),\n              $useData = $data + $prop;\n            if (it.opts._errorDataPathProperty) {\n              it.errorPath = it.util.getPath($currentErrorPath, $propertyKey, it.opts.jsonPointers);\n            }\n            out += ' if ( ' + ($useData) + ' === undefined ';\n            if ($ownProperties) {\n              out += ' || ! Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($propertyKey)) + '\\') ';\n            }\n            out += ') {  var err =   '; /* istanbul ignore else */\n            if (it.createErrors !== false) {\n              out += ' { keyword: \\'' + ('dependencies') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { property: \\'' + (it.util.escapeQuotes($property)) + '\\', missingProperty: \\'' + ($missingProperty) + '\\', depsCount: ' + ($deps.length) + ', deps: \\'' + (it.util.escapeQuotes($deps.length == 1 ? $deps[0] : $deps.join(\", \"))) + '\\' } ';\n              if (it.opts.messages !== false) {\n                out += ' , message: \\'should have ';\n                if ($deps.length == 1) {\n                  out += 'property ' + (it.util.escapeQuotes($deps[0]));\n                } else {\n                  out += 'properties ' + (it.util.escapeQuotes($deps.join(\", \")));\n                }\n                out += ' when property ' + (it.util.escapeQuotes($property)) + ' is present\\' ';\n              }\n              if (it.opts.verbose) {\n                out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n              }\n              out += ' } ';\n            } else {\n              out += ' {} ';\n            }\n            out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } ';\n          }\n        }\n      }\n      out += ' }   ';\n      if ($breakOnError) {\n        $closingBraces += '}';\n        out += ' else { ';\n      }\n    }\n  }\n  it.errorPath = $currentErrorPath;\n  var $currentBaseId = $it.baseId;\n  for (var $property in $schemaDeps) {\n    var $sch = $schemaDeps[$property];\n    if ((it.opts.strictKeywords ? (typeof $sch == 'object' && Object.keys($sch).length > 0) || $sch === false : it.util.schemaHasRules($sch, it.RULES.all))) {\n      out += ' ' + ($nextValid) + ' = true; if ( ' + ($data) + (it.util.getProperty($property)) + ' !== undefined ';\n      if ($ownProperties) {\n        out += ' && Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($property)) + '\\') ';\n      }\n      out += ') { ';\n      $it.schema = $sch;\n      $it.schemaPath = $schemaPath + it.util.getProperty($property);\n      $it.errSchemaPath = $errSchemaPath + '/' + it.util.escapeFragment($property);\n      out += '  ' + (it.validate($it)) + ' ';\n      $it.baseId = $currentBaseId;\n      out += ' }  ';\n      if ($breakOnError) {\n        out += ' if (' + ($nextValid) + ') { ';\n        $closingBraces += '}';\n      }\n    }\n  }\n  if ($breakOnError) {\n    out += '   ' + ($closingBraces) + ' if (' + ($errs) + ' == errors) {';\n  }\n  return out;\n}\n","'use strict';\n\nvar util = require('./util');\n\nmodule.exports = SchemaObject;\n\nfunction SchemaObject(obj) {\n  util.copy(obj, this);\n}\n","'use strict';\nmodule.exports = function generate_properties(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $key = 'key' + $lvl,\n    $idx = 'idx' + $lvl,\n    $dataNxt = $it.dataLevel = it.dataLevel + 1,\n    $nextData = 'data' + $dataNxt,\n    $dataProperties = 'dataProperties' + $lvl;\n  var $schemaKeys = Object.keys($schema || {}).filter(notProto),\n    $pProperties = it.schema.patternProperties || {},\n    $pPropertyKeys = Object.keys($pProperties).filter(notProto),\n    $aProperties = it.schema.additionalProperties,\n    $someProperties = $schemaKeys.length || $pPropertyKeys.length,\n    $noAdditional = $aProperties === false,\n    $additionalIsSchema = typeof $aProperties == 'object' && Object.keys($aProperties).length,\n    $removeAdditional = it.opts.removeAdditional,\n    $checkAdditional = $noAdditional || $additionalIsSchema || $removeAdditional,\n    $ownProperties = it.opts.ownProperties,\n    $currentBaseId = it.baseId;\n  var $required = it.schema.required;\n  if ($required && !(it.opts.$data && $required.$data) && $required.length < it.opts.loopRequired) {\n    var $requiredHash = it.util.toHash($required);\n  }\n\n  function notProto(p) {\n    return p !== '__proto__';\n  }\n  out += 'var ' + ($errs) + ' = errors;var ' + ($nextValid) + ' = true;';\n  if ($ownProperties) {\n    out += ' var ' + ($dataProperties) + ' = undefined;';\n  }\n  if ($checkAdditional) {\n    if ($ownProperties) {\n      out += ' ' + ($dataProperties) + ' = ' + ($dataProperties) + ' || Object.keys(' + ($data) + '); for (var ' + ($idx) + '=0; ' + ($idx) + '<' + ($dataProperties) + '.length; ' + ($idx) + '++) { var ' + ($key) + ' = ' + ($dataProperties) + '[' + ($idx) + ']; ';\n    } else {\n      out += ' for (var ' + ($key) + ' in ' + ($data) + ') { ';\n    }\n    if ($someProperties) {\n      out += ' var isAdditional' + ($lvl) + ' = !(false ';\n      if ($schemaKeys.length) {\n        if ($schemaKeys.length > 8) {\n          out += ' || validate.schema' + ($schemaPath) + '.hasOwnProperty(' + ($key) + ') ';\n        } else {\n          var arr1 = $schemaKeys;\n          if (arr1) {\n            var $propertyKey, i1 = -1,\n              l1 = arr1.length - 1;\n            while (i1 < l1) {\n              $propertyKey = arr1[i1 += 1];\n              out += ' || ' + ($key) + ' == ' + (it.util.toQuotedString($propertyKey)) + ' ';\n            }\n          }\n        }\n      }\n      if ($pPropertyKeys.length) {\n        var arr2 = $pPropertyKeys;\n        if (arr2) {\n          var $pProperty, $i = -1,\n            l2 = arr2.length - 1;\n          while ($i < l2) {\n            $pProperty = arr2[$i += 1];\n            out += ' || ' + (it.usePattern($pProperty)) + '.test(' + ($key) + ') ';\n          }\n        }\n      }\n      out += ' ); if (isAdditional' + ($lvl) + ') { ';\n    }\n    if ($removeAdditional == 'all') {\n      out += ' delete ' + ($data) + '[' + ($key) + ']; ';\n    } else {\n      var $currentErrorPath = it.errorPath;\n      var $additionalProperty = '\\' + ' + $key + ' + \\'';\n      if (it.opts._errorDataPathProperty) {\n        it.errorPath = it.util.getPathExpr(it.errorPath, $key, it.opts.jsonPointers);\n      }\n      if ($noAdditional) {\n        if ($removeAdditional) {\n          out += ' delete ' + ($data) + '[' + ($key) + ']; ';\n        } else {\n          out += ' ' + ($nextValid) + ' = false; ';\n          var $currErrSchemaPath = $errSchemaPath;\n          $errSchemaPath = it.errSchemaPath + '/additionalProperties';\n          var $$outStack = $$outStack || [];\n          $$outStack.push(out);\n          out = ''; /* istanbul ignore else */\n          if (it.createErrors !== false) {\n            out += ' { keyword: \\'' + ('additionalProperties') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { additionalProperty: \\'' + ($additionalProperty) + '\\' } ';\n            if (it.opts.messages !== false) {\n              out += ' , message: \\'';\n              if (it.opts._errorDataPathProperty) {\n                out += 'is an invalid additional property';\n              } else {\n                out += 'should NOT have additional properties';\n              }\n              out += '\\' ';\n            }\n            if (it.opts.verbose) {\n              out += ' , schema: false , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n            }\n            out += ' } ';\n          } else {\n            out += ' {} ';\n          }\n          var __err = out;\n          out = $$outStack.pop();\n          if (!it.compositeRule && $breakOnError) {\n            /* istanbul ignore if */\n            if (it.async) {\n              out += ' throw new ValidationError([' + (__err) + ']); ';\n            } else {\n              out += ' validate.errors = [' + (__err) + ']; return false; ';\n            }\n          } else {\n            out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n          }\n          $errSchemaPath = $currErrSchemaPath;\n          if ($breakOnError) {\n            out += ' break; ';\n          }\n        }\n      } else if ($additionalIsSchema) {\n        if ($removeAdditional == 'failing') {\n          out += ' var ' + ($errs) + ' = errors;  ';\n          var $wasComposite = it.compositeRule;\n          it.compositeRule = $it.compositeRule = true;\n          $it.schema = $aProperties;\n          $it.schemaPath = it.schemaPath + '.additionalProperties';\n          $it.errSchemaPath = it.errSchemaPath + '/additionalProperties';\n          $it.errorPath = it.opts._errorDataPathProperty ? it.errorPath : it.util.getPathExpr(it.errorPath, $key, it.opts.jsonPointers);\n          var $passData = $data + '[' + $key + ']';\n          $it.dataPathArr[$dataNxt] = $key;\n          var $code = it.validate($it);\n          $it.baseId = $currentBaseId;\n          if (it.util.varOccurences($code, $nextData) < 2) {\n            out += ' ' + (it.util.varReplace($code, $nextData, $passData)) + ' ';\n          } else {\n            out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ' + ($code) + ' ';\n          }\n          out += ' if (!' + ($nextValid) + ') { errors = ' + ($errs) + '; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete ' + ($data) + '[' + ($key) + ']; }  ';\n          it.compositeRule = $it.compositeRule = $wasComposite;\n        } else {\n          $it.schema = $aProperties;\n          $it.schemaPath = it.schemaPath + '.additionalProperties';\n          $it.errSchemaPath = it.errSchemaPath + '/additionalProperties';\n          $it.errorPath = it.opts._errorDataPathProperty ? it.errorPath : it.util.getPathExpr(it.errorPath, $key, it.opts.jsonPointers);\n          var $passData = $data + '[' + $key + ']';\n          $it.dataPathArr[$dataNxt] = $key;\n          var $code = it.validate($it);\n          $it.baseId = $currentBaseId;\n          if (it.util.varOccurences($code, $nextData) < 2) {\n            out += ' ' + (it.util.varReplace($code, $nextData, $passData)) + ' ';\n          } else {\n            out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ' + ($code) + ' ';\n          }\n          if ($breakOnError) {\n            out += ' if (!' + ($nextValid) + ') break; ';\n          }\n        }\n      }\n      it.errorPath = $currentErrorPath;\n    }\n    if ($someProperties) {\n      out += ' } ';\n    }\n    out += ' }  ';\n    if ($breakOnError) {\n      out += ' if (' + ($nextValid) + ') { ';\n      $closingBraces += '}';\n    }\n  }\n  var $useDefaults = it.opts.useDefaults && !it.compositeRule;\n  if ($schemaKeys.length) {\n    var arr3 = $schemaKeys;\n    if (arr3) {\n      var $propertyKey, i3 = -1,\n        l3 = arr3.length - 1;\n      while (i3 < l3) {\n        $propertyKey = arr3[i3 += 1];\n        var $sch = $schema[$propertyKey];\n        if ((it.opts.strictKeywords ? (typeof $sch == 'object' && Object.keys($sch).length > 0) || $sch === false : it.util.schemaHasRules($sch, it.RULES.all))) {\n          var $prop = it.util.getProperty($propertyKey),\n            $passData = $data + $prop,\n            $hasDefault = $useDefaults && $sch.default !== undefined;\n          $it.schema = $sch;\n          $it.schemaPath = $schemaPath + $prop;\n          $it.errSchemaPath = $errSchemaPath + '/' + it.util.escapeFragment($propertyKey);\n          $it.errorPath = it.util.getPath(it.errorPath, $propertyKey, it.opts.jsonPointers);\n          $it.dataPathArr[$dataNxt] = it.util.toQuotedString($propertyKey);\n          var $code = it.validate($it);\n          $it.baseId = $currentBaseId;\n          if (it.util.varOccurences($code, $nextData) < 2) {\n            $code = it.util.varReplace($code, $nextData, $passData);\n            var $useData = $passData;\n          } else {\n            var $useData = $nextData;\n            out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ';\n          }\n          if ($hasDefault) {\n            out += ' ' + ($code) + ' ';\n          } else {\n            if ($requiredHash && $requiredHash[$propertyKey]) {\n              out += ' if ( ' + ($useData) + ' === undefined ';\n              if ($ownProperties) {\n                out += ' || ! Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($propertyKey)) + '\\') ';\n              }\n              out += ') { ' + ($nextValid) + ' = false; ';\n              var $currentErrorPath = it.errorPath,\n                $currErrSchemaPath = $errSchemaPath,\n                $missingProperty = it.util.escapeQuotes($propertyKey);\n              if (it.opts._errorDataPathProperty) {\n                it.errorPath = it.util.getPath($currentErrorPath, $propertyKey, it.opts.jsonPointers);\n              }\n              $errSchemaPath = it.errSchemaPath + '/required';\n              var $$outStack = $$outStack || [];\n              $$outStack.push(out);\n              out = ''; /* istanbul ignore else */\n              if (it.createErrors !== false) {\n                out += ' { keyword: \\'' + ('required') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { missingProperty: \\'' + ($missingProperty) + '\\' } ';\n                if (it.opts.messages !== false) {\n                  out += ' , message: \\'';\n                  if (it.opts._errorDataPathProperty) {\n                    out += 'is a required property';\n                  } else {\n                    out += 'should have required property \\\\\\'' + ($missingProperty) + '\\\\\\'';\n                  }\n                  out += '\\' ';\n                }\n                if (it.opts.verbose) {\n                  out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n                }\n                out += ' } ';\n              } else {\n                out += ' {} ';\n              }\n              var __err = out;\n              out = $$outStack.pop();\n              if (!it.compositeRule && $breakOnError) {\n                /* istanbul ignore if */\n                if (it.async) {\n                  out += ' throw new ValidationError([' + (__err) + ']); ';\n                } else {\n                  out += ' validate.errors = [' + (__err) + ']; return false; ';\n                }\n              } else {\n                out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n              }\n              $errSchemaPath = $currErrSchemaPath;\n              it.errorPath = $currentErrorPath;\n              out += ' } else { ';\n            } else {\n              if ($breakOnError) {\n                out += ' if ( ' + ($useData) + ' === undefined ';\n                if ($ownProperties) {\n                  out += ' || ! Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($propertyKey)) + '\\') ';\n                }\n                out += ') { ' + ($nextValid) + ' = true; } else { ';\n              } else {\n                out += ' if (' + ($useData) + ' !== undefined ';\n                if ($ownProperties) {\n                  out += ' &&   Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($propertyKey)) + '\\') ';\n                }\n                out += ' ) { ';\n              }\n            }\n            out += ' ' + ($code) + ' } ';\n          }\n        }\n        if ($breakOnError) {\n          out += ' if (' + ($nextValid) + ') { ';\n          $closingBraces += '}';\n        }\n      }\n    }\n  }\n  if ($pPropertyKeys.length) {\n    var arr4 = $pPropertyKeys;\n    if (arr4) {\n      var $pProperty, i4 = -1,\n        l4 = arr4.length - 1;\n      while (i4 < l4) {\n        $pProperty = arr4[i4 += 1];\n        var $sch = $pProperties[$pProperty];\n        if ((it.opts.strictKeywords ? (typeof $sch == 'object' && Object.keys($sch).length > 0) || $sch === false : it.util.schemaHasRules($sch, it.RULES.all))) {\n          $it.schema = $sch;\n          $it.schemaPath = it.schemaPath + '.patternProperties' + it.util.getProperty($pProperty);\n          $it.errSchemaPath = it.errSchemaPath + '/patternProperties/' + it.util.escapeFragment($pProperty);\n          if ($ownProperties) {\n            out += ' ' + ($dataProperties) + ' = ' + ($dataProperties) + ' || Object.keys(' + ($data) + '); for (var ' + ($idx) + '=0; ' + ($idx) + '<' + ($dataProperties) + '.length; ' + ($idx) + '++) { var ' + ($key) + ' = ' + ($dataProperties) + '[' + ($idx) + ']; ';\n          } else {\n            out += ' for (var ' + ($key) + ' in ' + ($data) + ') { ';\n          }\n          out += ' if (' + (it.usePattern($pProperty)) + '.test(' + ($key) + ')) { ';\n          $it.errorPath = it.util.getPathExpr(it.errorPath, $key, it.opts.jsonPointers);\n          var $passData = $data + '[' + $key + ']';\n          $it.dataPathArr[$dataNxt] = $key;\n          var $code = it.validate($it);\n          $it.baseId = $currentBaseId;\n          if (it.util.varOccurences($code, $nextData) < 2) {\n            out += ' ' + (it.util.varReplace($code, $nextData, $passData)) + ' ';\n          } else {\n            out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ' + ($code) + ' ';\n          }\n          if ($breakOnError) {\n            out += ' if (!' + ($nextValid) + ') break; ';\n          }\n          out += ' } ';\n          if ($breakOnError) {\n            out += ' else ' + ($nextValid) + ' = true; ';\n          }\n          out += ' }  ';\n          if ($breakOnError) {\n            out += ' if (' + ($nextValid) + ') { ';\n            $closingBraces += '}';\n          }\n        }\n      }\n    }\n  }\n  if ($breakOnError) {\n    out += ' ' + ($closingBraces) + ' if (' + ($errs) + ' == errors) {';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate__limit(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $errorKeyword;\n  var $data = 'data' + ($dataLvl || '');\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  var $isMax = $keyword == 'maximum',\n    $exclusiveKeyword = $isMax ? 'exclusiveMaximum' : 'exclusiveMinimum',\n    $schemaExcl = it.schema[$exclusiveKeyword],\n    $isDataExcl = it.opts.$data && $schemaExcl && $schemaExcl.$data,\n    $op = $isMax ? '<' : '>',\n    $notOp = $isMax ? '>' : '<',\n    $errorKeyword = undefined;\n  if (!($isData || typeof $schema == 'number' || $schema === undefined)) {\n    throw new Error($keyword + ' must be number');\n  }\n  if (!($isDataExcl || $schemaExcl === undefined || typeof $schemaExcl == 'number' || typeof $schemaExcl == 'boolean')) {\n    throw new Error($exclusiveKeyword + ' must be number or boolean');\n  }\n  if ($isDataExcl) {\n    var $schemaValueExcl = it.util.getData($schemaExcl.$data, $dataLvl, it.dataPathArr),\n      $exclusive = 'exclusive' + $lvl,\n      $exclType = 'exclType' + $lvl,\n      $exclIsNumber = 'exclIsNumber' + $lvl,\n      $opExpr = 'op' + $lvl,\n      $opStr = '\\' + ' + $opExpr + ' + \\'';\n    out += ' var schemaExcl' + ($lvl) + ' = ' + ($schemaValueExcl) + '; ';\n    $schemaValueExcl = 'schemaExcl' + $lvl;\n    out += ' var ' + ($exclusive) + '; var ' + ($exclType) + ' = typeof ' + ($schemaValueExcl) + '; if (' + ($exclType) + ' != \\'boolean\\' && ' + ($exclType) + ' != \\'undefined\\' && ' + ($exclType) + ' != \\'number\\') { ';\n    var $errorKeyword = $exclusiveKeyword;\n    var $$outStack = $$outStack || [];\n    $$outStack.push(out);\n    out = ''; /* istanbul ignore else */\n    if (it.createErrors !== false) {\n      out += ' { keyword: \\'' + ($errorKeyword || '_exclusiveLimit') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: {} ';\n      if (it.opts.messages !== false) {\n        out += ' , message: \\'' + ($exclusiveKeyword) + ' should be boolean\\' ';\n      }\n      if (it.opts.verbose) {\n        out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n      }\n      out += ' } ';\n    } else {\n      out += ' {} ';\n    }\n    var __err = out;\n    out = $$outStack.pop();\n    if (!it.compositeRule && $breakOnError) {\n      /* istanbul ignore if */\n      if (it.async) {\n        out += ' throw new ValidationError([' + (__err) + ']); ';\n      } else {\n        out += ' validate.errors = [' + (__err) + ']; return false; ';\n      }\n    } else {\n      out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n    }\n    out += ' } else if ( ';\n    if ($isData) {\n      out += ' (' + ($schemaValue) + ' !== undefined && typeof ' + ($schemaValue) + ' != \\'number\\') || ';\n    }\n    out += ' ' + ($exclType) + ' == \\'number\\' ? ( (' + ($exclusive) + ' = ' + ($schemaValue) + ' === undefined || ' + ($schemaValueExcl) + ' ' + ($op) + '= ' + ($schemaValue) + ') ? ' + ($data) + ' ' + ($notOp) + '= ' + ($schemaValueExcl) + ' : ' + ($data) + ' ' + ($notOp) + ' ' + ($schemaValue) + ' ) : ( (' + ($exclusive) + ' = ' + ($schemaValueExcl) + ' === true) ? ' + ($data) + ' ' + ($notOp) + '= ' + ($schemaValue) + ' : ' + ($data) + ' ' + ($notOp) + ' ' + ($schemaValue) + ' ) || ' + ($data) + ' !== ' + ($data) + ') { var op' + ($lvl) + ' = ' + ($exclusive) + ' ? \\'' + ($op) + '\\' : \\'' + ($op) + '=\\'; ';\n    if ($schema === undefined) {\n      $errorKeyword = $exclusiveKeyword;\n      $errSchemaPath = it.errSchemaPath + '/' + $exclusiveKeyword;\n      $schemaValue = $schemaValueExcl;\n      $isData = $isDataExcl;\n    }\n  } else {\n    var $exclIsNumber = typeof $schemaExcl == 'number',\n      $opStr = $op;\n    if ($exclIsNumber && $isData) {\n      var $opExpr = '\\'' + $opStr + '\\'';\n      out += ' if ( ';\n      if ($isData) {\n        out += ' (' + ($schemaValue) + ' !== undefined && typeof ' + ($schemaValue) + ' != \\'number\\') || ';\n      }\n      out += ' ( ' + ($schemaValue) + ' === undefined || ' + ($schemaExcl) + ' ' + ($op) + '= ' + ($schemaValue) + ' ? ' + ($data) + ' ' + ($notOp) + '= ' + ($schemaExcl) + ' : ' + ($data) + ' ' + ($notOp) + ' ' + ($schemaValue) + ' ) || ' + ($data) + ' !== ' + ($data) + ') { ';\n    } else {\n      if ($exclIsNumber && $schema === undefined) {\n        $exclusive = true;\n        $errorKeyword = $exclusiveKeyword;\n        $errSchemaPath = it.errSchemaPath + '/' + $exclusiveKeyword;\n        $schemaValue = $schemaExcl;\n        $notOp += '=';\n      } else {\n        if ($exclIsNumber) $schemaValue = Math[$isMax ? 'min' : 'max']($schemaExcl, $schema);\n        if ($schemaExcl === ($exclIsNumber ? $schemaValue : true)) {\n          $exclusive = true;\n          $errorKeyword = $exclusiveKeyword;\n          $errSchemaPath = it.errSchemaPath + '/' + $exclusiveKeyword;\n          $notOp += '=';\n        } else {\n          $exclusive = false;\n          $opStr += '=';\n        }\n      }\n      var $opExpr = '\\'' + $opStr + '\\'';\n      out += ' if ( ';\n      if ($isData) {\n        out += ' (' + ($schemaValue) + ' !== undefined && typeof ' + ($schemaValue) + ' != \\'number\\') || ';\n      }\n      out += ' ' + ($data) + ' ' + ($notOp) + ' ' + ($schemaValue) + ' || ' + ($data) + ' !== ' + ($data) + ') { ';\n    }\n  }\n  $errorKeyword = $errorKeyword || $keyword;\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ($errorKeyword || '_limit') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { comparison: ' + ($opExpr) + ', limit: ' + ($schemaValue) + ', exclusive: ' + ($exclusive) + ' } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should be ' + ($opStr) + ' ';\n      if ($isData) {\n        out += '\\' + ' + ($schemaValue);\n      } else {\n        out += '' + ($schemaValue) + '\\'';\n      }\n    }\n    if (it.opts.verbose) {\n      out += ' , schema:  ';\n      if ($isData) {\n        out += 'validate.schema' + ($schemaPath);\n      } else {\n        out += '' + ($schema);\n      }\n      out += '         , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += ' } ';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict';\n\nvar ruleModules = require('../dotjs')\n  , toHash = require('./util').toHash;\n\nmodule.exports = function rules() {\n  var RULES = [\n    { type: 'number',\n      rules: [ { 'maximum': ['exclusiveMaximum'] },\n               { 'minimum': ['exclusiveMinimum'] }, 'multipleOf', 'format'] },\n    { type: 'string',\n      rules: [ 'maxLength', 'minLength', 'pattern', 'format' ] },\n    { type: 'array',\n      rules: [ 'maxItems', 'minItems', 'items', 'contains', 'uniqueItems' ] },\n    { type: 'object',\n      rules: [ 'maxProperties', 'minProperties', 'required', 'dependencies', 'propertyNames',\n               { 'properties': ['additionalProperties', 'patternProperties'] } ] },\n    { rules: [ '$ref', 'const', 'enum', 'not', 'anyOf', 'oneOf', 'allOf', 'if' ] }\n  ];\n\n  var ALL = [ 'type', '$comment' ];\n  var KEYWORDS = [\n    '$schema', '$id', 'id', '$data', '$async', 'title',\n    'description', 'default', 'definitions',\n    'examples', 'readOnly', 'writeOnly',\n    'contentMediaType', 'contentEncoding',\n    'additionalItems', 'then', 'else'\n  ];\n  var TYPES = [ 'number', 'integer', 'string', 'array', 'object', 'boolean', 'null' ];\n  RULES.all = toHash(ALL);\n  RULES.types = toHash(TYPES);\n\n  RULES.forEach(function (group) {\n    group.rules = group.rules.map(function (keyword) {\n      var implKeywords;\n      if (typeof keyword == 'object') {\n        var key = Object.keys(keyword)[0];\n        implKeywords = keyword[key];\n        keyword = key;\n        implKeywords.forEach(function (k) {\n          ALL.push(k);\n          RULES.all[k] = true;\n        });\n      }\n      ALL.push(keyword);\n      var rule = RULES.all[keyword] = {\n        keyword: keyword,\n        code: ruleModules[keyword],\n        implements: implKeywords\n      };\n      return rule;\n    });\n\n    RULES.all.$comment = {\n      keyword: '$comment',\n      code: ruleModules.$comment\n    };\n\n    if (group.type) RULES.types[group.type] = group;\n  });\n\n  RULES.keywords = toHash(ALL.concat(KEYWORDS));\n  RULES.custom = {};\n\n  return RULES;\n};\n","'use strict';\nmodule.exports = function generate_uniqueItems(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  if (($schema || $isData) && it.opts.uniqueItems !== false) {\n    if ($isData) {\n      out += ' var ' + ($valid) + '; if (' + ($schemaValue) + ' === false || ' + ($schemaValue) + ' === undefined) ' + ($valid) + ' = true; else if (typeof ' + ($schemaValue) + ' != \\'boolean\\') ' + ($valid) + ' = false; else { ';\n    }\n    out += ' var i = ' + ($data) + '.length , ' + ($valid) + ' = true , j; if (i > 1) { ';\n    var $itemType = it.schema.items && it.schema.items.type,\n      $typeIsArray = Array.isArray($itemType);\n    if (!$itemType || $itemType == 'object' || $itemType == 'array' || ($typeIsArray && ($itemType.indexOf('object') >= 0 || $itemType.indexOf('array') >= 0))) {\n      out += ' outer: for (;i--;) { for (j = i; j--;) { if (equal(' + ($data) + '[i], ' + ($data) + '[j])) { ' + ($valid) + ' = false; break outer; } } } ';\n    } else {\n      out += ' var itemIndices = {}, item; for (;i--;) { var item = ' + ($data) + '[i]; ';\n      var $method = 'checkDataType' + ($typeIsArray ? 's' : '');\n      out += ' if (' + (it.util[$method]($itemType, 'item', it.opts.strictNumbers, true)) + ') continue; ';\n      if ($typeIsArray) {\n        out += ' if (typeof item == \\'string\\') item = \\'\"\\' + item; ';\n      }\n      out += ' if (typeof itemIndices[item] == \\'number\\') { ' + ($valid) + ' = false; j = itemIndices[item]; break; } itemIndices[item] = i; } ';\n    }\n    out += ' } ';\n    if ($isData) {\n      out += '  }  ';\n    }\n    out += ' if (!' + ($valid) + ') {   ';\n    var $$outStack = $$outStack || [];\n    $$outStack.push(out);\n    out = ''; /* istanbul ignore else */\n    if (it.createErrors !== false) {\n      out += ' { keyword: \\'' + ('uniqueItems') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { i: i, j: j } ';\n      if (it.opts.messages !== false) {\n        out += ' , message: \\'should NOT have duplicate items (items ## \\' + j + \\' and \\' + i + \\' are identical)\\' ';\n      }\n      if (it.opts.verbose) {\n        out += ' , schema:  ';\n        if ($isData) {\n          out += 'validate.schema' + ($schemaPath);\n        } else {\n          out += '' + ($schema);\n        }\n        out += '         , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n      }\n      out += ' } ';\n    } else {\n      out += ' {} ';\n    }\n    var __err = out;\n    out = $$outStack.pop();\n    if (!it.compositeRule && $breakOnError) {\n      /* istanbul ignore if */\n      if (it.async) {\n        out += ' throw new ValidationError([' + (__err) + ']); ';\n      } else {\n        out += ' validate.errors = [' + (__err) + ']; return false; ';\n      }\n    } else {\n      out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n    }\n    out += ' } ';\n    if ($breakOnError) {\n      out += ' else { ';\n    }\n  } else {\n    if ($breakOnError) {\n      out += ' if (true) { ';\n    }\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_validate(it, $keyword, $ruleType) {\n  var out = '';\n  var $async = it.schema.$async === true,\n    $refKeywords = it.util.schemaHasRulesExcept(it.schema, it.RULES.all, '$ref'),\n    $id = it.self._getId(it.schema);\n  if (it.opts.strictKeywords) {\n    var $unknownKwd = it.util.schemaUnknownRules(it.schema, it.RULES.keywords);\n    if ($unknownKwd) {\n      var $keywordsMsg = 'unknown keyword: ' + $unknownKwd;\n      if (it.opts.strictKeywords === 'log') it.logger.warn($keywordsMsg);\n      else throw new Error($keywordsMsg);\n    }\n  }\n  if (it.isTop) {\n    out += ' var validate = ';\n    if ($async) {\n      it.async = true;\n      out += 'async ';\n    }\n    out += 'function(data, dataPath, parentData, parentDataProperty, rootData) { \\'use strict\\'; ';\n    if ($id && (it.opts.sourceCode || it.opts.processCode)) {\n      out += ' ' + ('/\\*# sourceURL=' + $id + ' */') + ' ';\n    }\n  }\n  if (typeof it.schema == 'boolean' || !($refKeywords || it.schema.$ref)) {\n    var $keyword = 'false schema';\n    var $lvl = it.level;\n    var $dataLvl = it.dataLevel;\n    var $schema = it.schema[$keyword];\n    var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n    var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n    var $breakOnError = !it.opts.allErrors;\n    var $errorKeyword;\n    var $data = 'data' + ($dataLvl || '');\n    var $valid = 'valid' + $lvl;\n    if (it.schema === false) {\n      if (it.isTop) {\n        $breakOnError = true;\n      } else {\n        out += ' var ' + ($valid) + ' = false; ';\n      }\n      var $$outStack = $$outStack || [];\n      $$outStack.push(out);\n      out = ''; /* istanbul ignore else */\n      if (it.createErrors !== false) {\n        out += ' { keyword: \\'' + ($errorKeyword || 'false schema') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: {} ';\n        if (it.opts.messages !== false) {\n          out += ' , message: \\'boolean schema is false\\' ';\n        }\n        if (it.opts.verbose) {\n          out += ' , schema: false , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n        }\n        out += ' } ';\n      } else {\n        out += ' {} ';\n      }\n      var __err = out;\n      out = $$outStack.pop();\n      if (!it.compositeRule && $breakOnError) {\n        /* istanbul ignore if */\n        if (it.async) {\n          out += ' throw new ValidationError([' + (__err) + ']); ';\n        } else {\n          out += ' validate.errors = [' + (__err) + ']; return false; ';\n        }\n      } else {\n        out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n      }\n    } else {\n      if (it.isTop) {\n        if ($async) {\n          out += ' return data; ';\n        } else {\n          out += ' validate.errors = null; return true; ';\n        }\n      } else {\n        out += ' var ' + ($valid) + ' = true; ';\n      }\n    }\n    if (it.isTop) {\n      out += ' }; return validate; ';\n    }\n    return out;\n  }\n  if (it.isTop) {\n    var $top = it.isTop,\n      $lvl = it.level = 0,\n      $dataLvl = it.dataLevel = 0,\n      $data = 'data';\n    it.rootId = it.resolve.fullPath(it.self._getId(it.root.schema));\n    it.baseId = it.baseId || it.rootId;\n    delete it.isTop;\n    it.dataPathArr = [\"\"];\n    if (it.schema.default !== undefined && it.opts.useDefaults && it.opts.strictDefaults) {\n      var $defaultMsg = 'default is ignored in the schema root';\n      if (it.opts.strictDefaults === 'log') it.logger.warn($defaultMsg);\n      else throw new Error($defaultMsg);\n    }\n    out += ' var vErrors = null; ';\n    out += ' var errors = 0;     ';\n    out += ' if (rootData === undefined) rootData = data; ';\n  } else {\n    var $lvl = it.level,\n      $dataLvl = it.dataLevel,\n      $data = 'data' + ($dataLvl || '');\n    if ($id) it.baseId = it.resolve.url(it.baseId, $id);\n    if ($async && !it.async) throw new Error('async schema in sync schema');\n    out += ' var errs_' + ($lvl) + ' = errors;';\n  }\n  var $valid = 'valid' + $lvl,\n    $breakOnError = !it.opts.allErrors,\n    $closingBraces1 = '',\n    $closingBraces2 = '';\n  var $errorKeyword;\n  var $typeSchema = it.schema.type,\n    $typeIsArray = Array.isArray($typeSchema);\n  if ($typeSchema && it.opts.nullable && it.schema.nullable === true) {\n    if ($typeIsArray) {\n      if ($typeSchema.indexOf('null') == -1) $typeSchema = $typeSchema.concat('null');\n    } else if ($typeSchema != 'null') {\n      $typeSchema = [$typeSchema, 'null'];\n      $typeIsArray = true;\n    }\n  }\n  if ($typeIsArray && $typeSchema.length == 1) {\n    $typeSchema = $typeSchema[0];\n    $typeIsArray = false;\n  }\n  if (it.schema.$ref && $refKeywords) {\n    if (it.opts.extendRefs == 'fail') {\n      throw new Error('$ref: validation keywords used in schema at path \"' + it.errSchemaPath + '\" (see option extendRefs)');\n    } else if (it.opts.extendRefs !== true) {\n      $refKeywords = false;\n      it.logger.warn('$ref: keywords ignored in schema at path \"' + it.errSchemaPath + '\"');\n    }\n  }\n  if (it.schema.$comment && it.opts.$comment) {\n    out += ' ' + (it.RULES.all.$comment.code(it, '$comment'));\n  }\n  if ($typeSchema) {\n    if (it.opts.coerceTypes) {\n      var $coerceToTypes = it.util.coerceToTypes(it.opts.coerceTypes, $typeSchema);\n    }\n    var $rulesGroup = it.RULES.types[$typeSchema];\n    if ($coerceToTypes || $typeIsArray || $rulesGroup === true || ($rulesGroup && !$shouldUseGroup($rulesGroup))) {\n      var $schemaPath = it.schemaPath + '.type',\n        $errSchemaPath = it.errSchemaPath + '/type';\n      var $schemaPath = it.schemaPath + '.type',\n        $errSchemaPath = it.errSchemaPath + '/type',\n        $method = $typeIsArray ? 'checkDataTypes' : 'checkDataType';\n      out += ' if (' + (it.util[$method]($typeSchema, $data, it.opts.strictNumbers, true)) + ') { ';\n      if ($coerceToTypes) {\n        var $dataType = 'dataType' + $lvl,\n          $coerced = 'coerced' + $lvl;\n        out += ' var ' + ($dataType) + ' = typeof ' + ($data) + '; var ' + ($coerced) + ' = undefined; ';\n        if (it.opts.coerceTypes == 'array') {\n          out += ' if (' + ($dataType) + ' == \\'object\\' && Array.isArray(' + ($data) + ') && ' + ($data) + '.length == 1) { ' + ($data) + ' = ' + ($data) + '[0]; ' + ($dataType) + ' = typeof ' + ($data) + '; if (' + (it.util.checkDataType(it.schema.type, $data, it.opts.strictNumbers)) + ') ' + ($coerced) + ' = ' + ($data) + '; } ';\n        }\n        out += ' if (' + ($coerced) + ' !== undefined) ; ';\n        var arr1 = $coerceToTypes;\n        if (arr1) {\n          var $type, $i = -1,\n            l1 = arr1.length - 1;\n          while ($i < l1) {\n            $type = arr1[$i += 1];\n            if ($type == 'string') {\n              out += ' else if (' + ($dataType) + ' == \\'number\\' || ' + ($dataType) + ' == \\'boolean\\') ' + ($coerced) + ' = \\'\\' + ' + ($data) + '; else if (' + ($data) + ' === null) ' + ($coerced) + ' = \\'\\'; ';\n            } else if ($type == 'number' || $type == 'integer') {\n              out += ' else if (' + ($dataType) + ' == \\'boolean\\' || ' + ($data) + ' === null || (' + ($dataType) + ' == \\'string\\' && ' + ($data) + ' && ' + ($data) + ' == +' + ($data) + ' ';\n              if ($type == 'integer') {\n                out += ' && !(' + ($data) + ' % 1)';\n              }\n              out += ')) ' + ($coerced) + ' = +' + ($data) + '; ';\n            } else if ($type == 'boolean') {\n              out += ' else if (' + ($data) + ' === \\'false\\' || ' + ($data) + ' === 0 || ' + ($data) + ' === null) ' + ($coerced) + ' = false; else if (' + ($data) + ' === \\'true\\' || ' + ($data) + ' === 1) ' + ($coerced) + ' = true; ';\n            } else if ($type == 'null') {\n              out += ' else if (' + ($data) + ' === \\'\\' || ' + ($data) + ' === 0 || ' + ($data) + ' === false) ' + ($coerced) + ' = null; ';\n            } else if (it.opts.coerceTypes == 'array' && $type == 'array') {\n              out += ' else if (' + ($dataType) + ' == \\'string\\' || ' + ($dataType) + ' == \\'number\\' || ' + ($dataType) + ' == \\'boolean\\' || ' + ($data) + ' == null) ' + ($coerced) + ' = [' + ($data) + ']; ';\n            }\n          }\n        }\n        out += ' else {   ';\n        var $$outStack = $$outStack || [];\n        $$outStack.push(out);\n        out = ''; /* istanbul ignore else */\n        if (it.createErrors !== false) {\n          out += ' { keyword: \\'' + ($errorKeyword || 'type') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { type: \\'';\n          if ($typeIsArray) {\n            out += '' + ($typeSchema.join(\",\"));\n          } else {\n            out += '' + ($typeSchema);\n          }\n          out += '\\' } ';\n          if (it.opts.messages !== false) {\n            out += ' , message: \\'should be ';\n            if ($typeIsArray) {\n              out += '' + ($typeSchema.join(\",\"));\n            } else {\n              out += '' + ($typeSchema);\n            }\n            out += '\\' ';\n          }\n          if (it.opts.verbose) {\n            out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n          }\n          out += ' } ';\n        } else {\n          out += ' {} ';\n        }\n        var __err = out;\n        out = $$outStack.pop();\n        if (!it.compositeRule && $breakOnError) {\n          /* istanbul ignore if */\n          if (it.async) {\n            out += ' throw new ValidationError([' + (__err) + ']); ';\n          } else {\n            out += ' validate.errors = [' + (__err) + ']; return false; ';\n          }\n        } else {\n          out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n        }\n        out += ' } if (' + ($coerced) + ' !== undefined) {  ';\n        var $parentData = $dataLvl ? 'data' + (($dataLvl - 1) || '') : 'parentData',\n          $parentDataProperty = $dataLvl ? it.dataPathArr[$dataLvl] : 'parentDataProperty';\n        out += ' ' + ($data) + ' = ' + ($coerced) + '; ';\n        if (!$dataLvl) {\n          out += 'if (' + ($parentData) + ' !== undefined)';\n        }\n        out += ' ' + ($parentData) + '[' + ($parentDataProperty) + '] = ' + ($coerced) + '; } ';\n      } else {\n        var $$outStack = $$outStack || [];\n        $$outStack.push(out);\n        out = ''; /* istanbul ignore else */\n        if (it.createErrors !== false) {\n          out += ' { keyword: \\'' + ($errorKeyword || 'type') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { type: \\'';\n          if ($typeIsArray) {\n            out += '' + ($typeSchema.join(\",\"));\n          } else {\n            out += '' + ($typeSchema);\n          }\n          out += '\\' } ';\n          if (it.opts.messages !== false) {\n            out += ' , message: \\'should be ';\n            if ($typeIsArray) {\n              out += '' + ($typeSchema.join(\",\"));\n            } else {\n              out += '' + ($typeSchema);\n            }\n            out += '\\' ';\n          }\n          if (it.opts.verbose) {\n            out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n          }\n          out += ' } ';\n        } else {\n          out += ' {} ';\n        }\n        var __err = out;\n        out = $$outStack.pop();\n        if (!it.compositeRule && $breakOnError) {\n          /* istanbul ignore if */\n          if (it.async) {\n            out += ' throw new ValidationError([' + (__err) + ']); ';\n          } else {\n            out += ' validate.errors = [' + (__err) + ']; return false; ';\n          }\n        } else {\n          out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n        }\n      }\n      out += ' } ';\n    }\n  }\n  if (it.schema.$ref && !$refKeywords) {\n    out += ' ' + (it.RULES.all.$ref.code(it, '$ref')) + ' ';\n    if ($breakOnError) {\n      out += ' } if (errors === ';\n      if ($top) {\n        out += '0';\n      } else {\n        out += 'errs_' + ($lvl);\n      }\n      out += ') { ';\n      $closingBraces2 += '}';\n    }\n  } else {\n    var arr2 = it.RULES;\n    if (arr2) {\n      var $rulesGroup, i2 = -1,\n        l2 = arr2.length - 1;\n      while (i2 < l2) {\n        $rulesGroup = arr2[i2 += 1];\n        if ($shouldUseGroup($rulesGroup)) {\n          if ($rulesGroup.type) {\n            out += ' if (' + (it.util.checkDataType($rulesGroup.type, $data, it.opts.strictNumbers)) + ') { ';\n          }\n          if (it.opts.useDefaults) {\n            if ($rulesGroup.type == 'object' && it.schema.properties) {\n              var $schema = it.schema.properties,\n                $schemaKeys = Object.keys($schema);\n              var arr3 = $schemaKeys;\n              if (arr3) {\n                var $propertyKey, i3 = -1,\n                  l3 = arr3.length - 1;\n                while (i3 < l3) {\n                  $propertyKey = arr3[i3 += 1];\n                  var $sch = $schema[$propertyKey];\n                  if ($sch.default !== undefined) {\n                    var $passData = $data + it.util.getProperty($propertyKey);\n                    if (it.compositeRule) {\n                      if (it.opts.strictDefaults) {\n                        var $defaultMsg = 'default is ignored for: ' + $passData;\n                        if (it.opts.strictDefaults === 'log') it.logger.warn($defaultMsg);\n                        else throw new Error($defaultMsg);\n                      }\n                    } else {\n                      out += ' if (' + ($passData) + ' === undefined ';\n                      if (it.opts.useDefaults == 'empty') {\n                        out += ' || ' + ($passData) + ' === null || ' + ($passData) + ' === \\'\\' ';\n                      }\n                      out += ' ) ' + ($passData) + ' = ';\n                      if (it.opts.useDefaults == 'shared') {\n                        out += ' ' + (it.useDefault($sch.default)) + ' ';\n                      } else {\n                        out += ' ' + (JSON.stringify($sch.default)) + ' ';\n                      }\n                      out += '; ';\n                    }\n                  }\n                }\n              }\n            } else if ($rulesGroup.type == 'array' && Array.isArray(it.schema.items)) {\n              var arr4 = it.schema.items;\n              if (arr4) {\n                var $sch, $i = -1,\n                  l4 = arr4.length - 1;\n                while ($i < l4) {\n                  $sch = arr4[$i += 1];\n                  if ($sch.default !== undefined) {\n                    var $passData = $data + '[' + $i + ']';\n                    if (it.compositeRule) {\n                      if (it.opts.strictDefaults) {\n                        var $defaultMsg = 'default is ignored for: ' + $passData;\n                        if (it.opts.strictDefaults === 'log') it.logger.warn($defaultMsg);\n                        else throw new Error($defaultMsg);\n                      }\n                    } else {\n                      out += ' if (' + ($passData) + ' === undefined ';\n                      if (it.opts.useDefaults == 'empty') {\n                        out += ' || ' + ($passData) + ' === null || ' + ($passData) + ' === \\'\\' ';\n                      }\n                      out += ' ) ' + ($passData) + ' = ';\n                      if (it.opts.useDefaults == 'shared') {\n                        out += ' ' + (it.useDefault($sch.default)) + ' ';\n                      } else {\n                        out += ' ' + (JSON.stringify($sch.default)) + ' ';\n                      }\n                      out += '; ';\n                    }\n                  }\n                }\n              }\n            }\n          }\n          var arr5 = $rulesGroup.rules;\n          if (arr5) {\n            var $rule, i5 = -1,\n              l5 = arr5.length - 1;\n            while (i5 < l5) {\n              $rule = arr5[i5 += 1];\n              if ($shouldUseRule($rule)) {\n                var $code = $rule.code(it, $rule.keyword, $rulesGroup.type);\n                if ($code) {\n                  out += ' ' + ($code) + ' ';\n                  if ($breakOnError) {\n                    $closingBraces1 += '}';\n                  }\n                }\n              }\n            }\n          }\n          if ($breakOnError) {\n            out += ' ' + ($closingBraces1) + ' ';\n            $closingBraces1 = '';\n          }\n          if ($rulesGroup.type) {\n            out += ' } ';\n            if ($typeSchema && $typeSchema === $rulesGroup.type && !$coerceToTypes) {\n              out += ' else { ';\n              var $schemaPath = it.schemaPath + '.type',\n                $errSchemaPath = it.errSchemaPath + '/type';\n              var $$outStack = $$outStack || [];\n              $$outStack.push(out);\n              out = ''; /* istanbul ignore else */\n              if (it.createErrors !== false) {\n                out += ' { keyword: \\'' + ($errorKeyword || 'type') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { type: \\'';\n                if ($typeIsArray) {\n                  out += '' + ($typeSchema.join(\",\"));\n                } else {\n                  out += '' + ($typeSchema);\n                }\n                out += '\\' } ';\n                if (it.opts.messages !== false) {\n                  out += ' , message: \\'should be ';\n                  if ($typeIsArray) {\n                    out += '' + ($typeSchema.join(\",\"));\n                  } else {\n                    out += '' + ($typeSchema);\n                  }\n                  out += '\\' ';\n                }\n                if (it.opts.verbose) {\n                  out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n                }\n                out += ' } ';\n              } else {\n                out += ' {} ';\n              }\n              var __err = out;\n              out = $$outStack.pop();\n              if (!it.compositeRule && $breakOnError) {\n                /* istanbul ignore if */\n                if (it.async) {\n                  out += ' throw new ValidationError([' + (__err) + ']); ';\n                } else {\n                  out += ' validate.errors = [' + (__err) + ']; return false; ';\n                }\n              } else {\n                out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n              }\n              out += ' } ';\n            }\n          }\n          if ($breakOnError) {\n            out += ' if (errors === ';\n            if ($top) {\n              out += '0';\n            } else {\n              out += 'errs_' + ($lvl);\n            }\n            out += ') { ';\n            $closingBraces2 += '}';\n          }\n        }\n      }\n    }\n  }\n  if ($breakOnError) {\n    out += ' ' + ($closingBraces2) + ' ';\n  }\n  if ($top) {\n    if ($async) {\n      out += ' if (errors === 0) return data;           ';\n      out += ' else throw new ValidationError(vErrors); ';\n    } else {\n      out += ' validate.errors = vErrors; ';\n      out += ' return errors === 0;       ';\n    }\n    out += ' }; return validate;';\n  } else {\n    out += ' var ' + ($valid) + ' = errors === errs_' + ($lvl) + ';';\n  }\n\n  function $shouldUseGroup($rulesGroup) {\n    var rules = $rulesGroup.rules;\n    for (var i = 0; i < rules.length; i++)\n      if ($shouldUseRule(rules[i])) return true;\n  }\n\n  function $shouldUseRule($rule) {\n    return it.schema[$rule.keyword] !== undefined || ($rule.implements && $ruleImplementsSomeKeyword($rule));\n  }\n\n  function $ruleImplementsSomeKeyword($rule) {\n    var impl = $rule.implements;\n    for (var i = 0; i < impl.length; i++)\n      if (it.schema[impl[i]] !== undefined) return true;\n  }\n  return out;\n}\n","'use strict'\n\nconst lineToPolygon = require('./lineToPolygon')\nconst polygonPolygon = require('./polygon-polygon')\nconst linePolygon = require('./line-polygon')\nconst lineToLine = require('./lineToLine')\n\n/**\n * line-line collision\n * from http://stackoverflow.com/questions/563198/how-do-you-detect-where-two-line-segments-intersect\n * @param {number} x1 first point in line 1\n * @param {number} y1 first point in line 1\n * @param {number} x2 second point in line 1\n * @param {number} y2 second point in line 1\n * @param {number} x3 first point in line 2\n * @param {number} y3 first point in line 2\n * @param {number} x4 second point in line 2\n * @param {number} y4 second point in line 2\n * @param {number} [thickness1] of line 1 (the line is centered in its thickness--see demo)\n * @param {number} [thickness2] of line 2 (the line is centered in its thickness--see demo)\n * @return {boolean}\n */\nmodule.exports = function lineLine(x1, y1, x2, y2, x3, y3, x4, y4, thickness1, thickness2)\n{\n    if (thickness1 || thickness2)\n    {\n        return lineLineThickness(x1, y1, x2, y2, x3, y3, x4, y4, thickness1, thickness2)\n    }\n    else\n    {\n        return lineToLine(x1, y1, x2, y2, x3, y3, x4, y4)\n    }\n}\n\nfunction lineLineThickness(x1, y1, x2, y2, x3, y3, x4, y4, thickness1, thickness2)\n{\n    if (thickness1 && thickness2)\n    {\n        return polygonPolygon(lineToPolygon(x1, y1, x2, y2, thickness1), lineToPolygon(x3, y3, x4, y4, thickness2))\n    }\n    else if (thickness1)\n    {\n        return linePolygon(x3, y3, x4, y4, lineToPolygon(x1, y1, x2, y2, thickness1))\n    }\n    else if (thickness2)\n    {\n        return linePolygon(x1, y1, x2, y2, lineToPolygon(x3, y3, x4, y4, thickness1))\n    }\n}","'use strict';\nmodule.exports = function generate__limitItems(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $errorKeyword;\n  var $data = 'data' + ($dataLvl || '');\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  if (!($isData || typeof $schema == 'number')) {\n    throw new Error($keyword + ' must be number');\n  }\n  var $op = $keyword == 'maxItems' ? '>' : '<';\n  out += 'if ( ';\n  if ($isData) {\n    out += ' (' + ($schemaValue) + ' !== undefined && typeof ' + ($schemaValue) + ' != \\'number\\') || ';\n  }\n  out += ' ' + ($data) + '.length ' + ($op) + ' ' + ($schemaValue) + ') { ';\n  var $errorKeyword = $keyword;\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ($errorKeyword || '_limitItems') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { limit: ' + ($schemaValue) + ' } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should NOT have ';\n      if ($keyword == 'maxItems') {\n        out += 'more';\n      } else {\n        out += 'fewer';\n      }\n      out += ' than ';\n      if ($isData) {\n        out += '\\' + ' + ($schemaValue) + ' + \\'';\n      } else {\n        out += '' + ($schema);\n      }\n      out += ' items\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema:  ';\n      if ($isData) {\n        out += 'validate.schema' + ($schemaPath);\n      } else {\n        out += '' + ($schema);\n      }\n      out += '         , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += '} ';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_if(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $thenSch = it.schema['then'],\n    $elseSch = it.schema['else'],\n    $thenPresent = $thenSch !== undefined && (it.opts.strictKeywords ? (typeof $thenSch == 'object' && Object.keys($thenSch).length > 0) || $thenSch === false : it.util.schemaHasRules($thenSch, it.RULES.all)),\n    $elsePresent = $elseSch !== undefined && (it.opts.strictKeywords ? (typeof $elseSch == 'object' && Object.keys($elseSch).length > 0) || $elseSch === false : it.util.schemaHasRules($elseSch, it.RULES.all)),\n    $currentBaseId = $it.baseId;\n  if ($thenPresent || $elsePresent) {\n    var $ifClause;\n    $it.createErrors = false;\n    $it.schema = $schema;\n    $it.schemaPath = $schemaPath;\n    $it.errSchemaPath = $errSchemaPath;\n    out += ' var ' + ($errs) + ' = errors; var ' + ($valid) + ' = true;  ';\n    var $wasComposite = it.compositeRule;\n    it.compositeRule = $it.compositeRule = true;\n    out += '  ' + (it.validate($it)) + ' ';\n    $it.baseId = $currentBaseId;\n    $it.createErrors = true;\n    out += '  errors = ' + ($errs) + '; if (vErrors !== null) { if (' + ($errs) + ') vErrors.length = ' + ($errs) + '; else vErrors = null; }  ';\n    it.compositeRule = $it.compositeRule = $wasComposite;\n    if ($thenPresent) {\n      out += ' if (' + ($nextValid) + ') {  ';\n      $it.schema = it.schema['then'];\n      $it.schemaPath = it.schemaPath + '.then';\n      $it.errSchemaPath = it.errSchemaPath + '/then';\n      out += '  ' + (it.validate($it)) + ' ';\n      $it.baseId = $currentBaseId;\n      out += ' ' + ($valid) + ' = ' + ($nextValid) + '; ';\n      if ($thenPresent && $elsePresent) {\n        $ifClause = 'ifClause' + $lvl;\n        out += ' var ' + ($ifClause) + ' = \\'then\\'; ';\n      } else {\n        $ifClause = '\\'then\\'';\n      }\n      out += ' } ';\n      if ($elsePresent) {\n        out += ' else { ';\n      }\n    } else {\n      out += ' if (!' + ($nextValid) + ') { ';\n    }\n    if ($elsePresent) {\n      $it.schema = it.schema['else'];\n      $it.schemaPath = it.schemaPath + '.else';\n      $it.errSchemaPath = it.errSchemaPath + '/else';\n      out += '  ' + (it.validate($it)) + ' ';\n      $it.baseId = $currentBaseId;\n      out += ' ' + ($valid) + ' = ' + ($nextValid) + '; ';\n      if ($thenPresent && $elsePresent) {\n        $ifClause = 'ifClause' + $lvl;\n        out += ' var ' + ($ifClause) + ' = \\'else\\'; ';\n      } else {\n        $ifClause = '\\'else\\'';\n      }\n      out += ' } ';\n    }\n    out += ' if (!' + ($valid) + ') {   var err =   '; /* istanbul ignore else */\n    if (it.createErrors !== false) {\n      out += ' { keyword: \\'' + ('if') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { failingKeyword: ' + ($ifClause) + ' } ';\n      if (it.opts.messages !== false) {\n        out += ' , message: \\'should match \"\\' + ' + ($ifClause) + ' + \\'\" schema\\' ';\n      }\n      if (it.opts.verbose) {\n        out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n      }\n      out += ' } ';\n    } else {\n      out += ' {} ';\n    }\n    out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n    if (!it.compositeRule && $breakOnError) {\n      /* istanbul ignore if */\n      if (it.async) {\n        out += ' throw new ValidationError(vErrors); ';\n      } else {\n        out += ' validate.errors = vErrors; return false; ';\n      }\n    }\n    out += ' }   ';\n    if ($breakOnError) {\n      out += ' else { ';\n    }\n  } else {\n    if ($breakOnError) {\n      out += ' if (true) { ';\n    }\n  }\n  return out;\n}\n","const CommonProcessRegistry = require('@openeo/js-commons/src/processRegistry');\r\n\r\n/**\r\n * Central registry for processes.\r\n * \r\n * Implementation has been moved to @openeo/js-commons.\r\n * This wrapper here is only available for backward compatibility.\r\n * \r\n * @todo Remove in 2.0.0.\r\n * @augments CommonProcessRegistry\r\n * @class\r\n * @deprecated\r\n */\r\nclass ProcessRegistry extends CommonProcessRegistry {\r\n\r\n}\r\n\r\nmodule.exports = ProcessRegistry;","export * from \"-!../../../../mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../vue-loader/lib/loaders/stylePostLoader.js!../../../../postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!./BlockParameter.vue?vue&type=style&index=0&id=70b6715c&prod&lang=scss&\"","'use strict';\nmodule.exports = function generate_enum(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  var $i = 'i' + $lvl,\n    $vSchema = 'schema' + $lvl;\n  if (!$isData) {\n    out += ' var ' + ($vSchema) + ' = validate.schema' + ($schemaPath) + ';';\n  }\n  out += 'var ' + ($valid) + ';';\n  if ($isData) {\n    out += ' if (schema' + ($lvl) + ' === undefined) ' + ($valid) + ' = true; else if (!Array.isArray(schema' + ($lvl) + ')) ' + ($valid) + ' = false; else {';\n  }\n  out += '' + ($valid) + ' = false;for (var ' + ($i) + '=0; ' + ($i) + '<' + ($vSchema) + '.length; ' + ($i) + '++) if (equal(' + ($data) + ', ' + ($vSchema) + '[' + ($i) + '])) { ' + ($valid) + ' = true; break; }';\n  if ($isData) {\n    out += '  }  ';\n  }\n  out += ' if (!' + ($valid) + ') {   ';\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ('enum') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { allowedValues: schema' + ($lvl) + ' } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should be equal to one of the allowed values\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += ' }';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_allOf(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $currentBaseId = $it.baseId,\n    $allSchemasEmpty = true;\n  var arr1 = $schema;\n  if (arr1) {\n    var $sch, $i = -1,\n      l1 = arr1.length - 1;\n    while ($i < l1) {\n      $sch = arr1[$i += 1];\n      if ((it.opts.strictKeywords ? (typeof $sch == 'object' && Object.keys($sch).length > 0) || $sch === false : it.util.schemaHasRules($sch, it.RULES.all))) {\n        $allSchemasEmpty = false;\n        $it.schema = $sch;\n        $it.schemaPath = $schemaPath + '[' + $i + ']';\n        $it.errSchemaPath = $errSchemaPath + '/' + $i;\n        out += '  ' + (it.validate($it)) + ' ';\n        $it.baseId = $currentBaseId;\n        if ($breakOnError) {\n          out += ' if (' + ($nextValid) + ') { ';\n          $closingBraces += '}';\n        }\n      }\n    }\n  }\n  if ($breakOnError) {\n    if ($allSchemasEmpty) {\n      out += ' if (true) { ';\n    } else {\n      out += ' ' + ($closingBraces.slice(0, -1)) + ' ';\n    }\n  }\n  return out;\n}\n","'use strict';\n\n\nvar Cache = module.exports = function Cache() {\n  this._cache = {};\n};\n\n\nCache.prototype.put = function Cache_put(key, value) {\n  this._cache[key] = value;\n};\n\n\nCache.prototype.get = function Cache_get(key) {\n  return this._cache[key];\n};\n\n\nCache.prototype.del = function Cache_del(key) {\n  delete this._cache[key];\n};\n\n\nCache.prototype.clear = function Cache_clear() {\n  this._cache = {};\n};\n","'use strict'\n\n/**\n * box-point collision\n * @param {number} x1 top-left corner of box\n * @param {number} y1 top-left corner of box\n * @param {number} w1 width of box\n * @param {number} h1 height of box\n * @param {number} x2 of point\n * @param {number} y2 of point\n * @return {boolean}\n */\nmodule.exports = function boxPoint(x1, y1, w1, h1, x2, y2)\n{\n    return x2 >= x1 && x2 <= x1 + w1 && y2 >= y1 && y2 <= y1 + h1\n}\n","'use strict';\n\nmodule.exports = function (data, opts) {\n    if (!opts) opts = {};\n    if (typeof opts === 'function') opts = { cmp: opts };\n    var cycles = (typeof opts.cycles === 'boolean') ? opts.cycles : false;\n\n    var cmp = opts.cmp && (function (f) {\n        return function (node) {\n            return function (a, b) {\n                var aobj = { key: a, value: node[a] };\n                var bobj = { key: b, value: node[b] };\n                return f(aobj, bobj);\n            };\n        };\n    })(opts.cmp);\n\n    var seen = [];\n    return (function stringify (node) {\n        if (node && node.toJSON && typeof node.toJSON === 'function') {\n            node = node.toJSON();\n        }\n\n        if (node === undefined) return;\n        if (typeof node == 'number') return isFinite(node) ? '' + node : 'null';\n        if (typeof node !== 'object') return JSON.stringify(node);\n\n        var i, out;\n        if (Array.isArray(node)) {\n            out = '[';\n            for (i = 0; i < node.length; i++) {\n                if (i) out += ',';\n                out += stringify(node[i]) || 'null';\n            }\n            return out + ']';\n        }\n\n        if (node === null) return 'null';\n\n        if (seen.indexOf(node) !== -1) {\n            if (cycles) return JSON.stringify('__cycle__');\n            throw new TypeError('Converting circular structure to JSON');\n        }\n\n        var seenIndex = seen.push(node) - 1;\n        var keys = Object.keys(node).sort(cmp && cmp(node));\n        out = '';\n        for (i = 0; i < keys.length; i++) {\n            var key = keys[i];\n            var value = stringify(node[key]);\n\n            if (!value) continue;\n            if (out) out += ',';\n            out += JSON.stringify(key) + ':' + value;\n        }\n        seen.splice(seenIndex, 1);\n        return '{' + out + '}';\n    })(data);\n};\n","const Ajv = require('ajv');\r\nconst Utils = require('./utils');\r\nconst ProcessUtils = require('@openeo/js-commons/src/processUtils.js');\r\nconst keywords = require('./keywords');\r\n\r\nvar geoJsonSchema = require(\"../assets/GeoJSON.json\");\r\nvar subtypeSchemas = require(\"../assets/subtype-schemas.json\");\r\n\r\n/**\r\n * JSON Schema Validator.\r\n * \r\n * @class\r\n */\r\nclass JsonSchemaValidator {\r\n\r\n\tconstructor() {\r\n\t\tthis.ajv = new Ajv({\r\n\t\t\tschemaId: 'auto',\r\n\t\t\tformat: 'full',\r\n\t\t\taddUsedSchema: false\r\n\t\t});\r\n\t\t// Add subtype + GeoJSON schemas\r\n\t\tthis.ajv.addSchema(geoJsonSchema);\r\n\t\t// Add openEO specific keywords\r\n\t\tthis.ajv.addKeyword('parameters', Object.assign(keywords.parameters, {\r\n\t\t\tvalid: true,\r\n\t\t\terrors: true\r\n\t\t}));\r\n\t\tthis.ajv.addKeyword('returns', Object.assign(keywords.returns, {\r\n\t\t\tvalid: true,\r\n\t\t\terrors: true\r\n\t\t}));\r\n\t\tthis.ajv.addKeyword('subtype', Object.assign(keywords.subtype, {\r\n\t\t\tvalidate: async (subtype, data, schema) => await this.validateSubtype(subtype, data, schema),\r\n\t\t\tasync: true,\r\n\t\t\terrors: true\r\n\t\t}));\r\n\r\n\t\tthis.collections = null;\r\n\t\tthis.epsgCodes = null;\r\n\t\tthis.fileFormats = {\r\n\t\t\tinput: null,\r\n\t\t\toutput: null\r\n\t\t};\r\n\t\tthis.processRegistry = null;\r\n\t\tthis.udfRuntimes = null;\r\n\t}\r\n\r\n\tgetFunctionName(subtype) {\r\n\t\t// compute the function name (camelCase), e.g. for `band-name` it will be `validateBandName`\r\n\t\treturn \"validate\" + subtype.replace(/(^|\\-)(\\w)/g, (a, b, char) => char.toUpperCase());\r\n\t}\r\n\r\n\tmakeSchema(schema, $async = false) {\r\n\t\tschema = Utils.deepClone(schema);\r\n\r\n\t\t// Make array of schemas to a anyOf schema\r\n\t\tif (Array.isArray(schema)) {\r\n\t\t\tschema = {\r\n\t\t\t\tanyOf: schema\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// Set applicable JSON Schema draft version if not already set\r\n\t\tif (typeof schema.$schema === 'undefined') {\r\n\t\t\tschema.$schema = \"http://json-schema.org/draft-07/schema#\";\r\n\t\t}\r\n\r\n\t\t// Set async execution\r\n\t\tif ($async) {\r\n\t\t\tschema.$async = true;\r\n\t\t\tif (Utils.isObject(schema.definitions)) {\r\n\t\t\t\tfor(let key in schema.definitions) {\r\n\t\t\t\t\tschema.definitions[key].$async = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn schema;\r\n\t}\r\n\r\n\tasync validateValue(value, schema) {\r\n\t\tschema = this.makeSchema(schema, true);\r\n\r\n\t\ttry {\r\n\t\t\tawait this.ajv.validate(schema, value);\r\n\t\t\treturn [];\r\n\t\t} catch (e) {\r\n\t\t\tif (Array.isArray(e.errors)) {\r\n\t\t\t\treturn e.errors.map(e => e.message);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthrow e;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tasync validateSubtype(subtype, data, schema) {\r\n\t\tif (typeof subtypeSchemas.definitions[subtype] !== 'undefined') {\r\n\t\t\tschema = this.makeSchema(subtypeSchemas, true);\r\n\t\t\t// Make the schema for this subtype the default schema to be checked\r\n\t\t\tschema = Object.assign({}, subtypeSchemas.definitions[subtype], schema);\r\n\t\t\tif (subtype === 'process-graph') {\r\n\t\t\t\t// Special case: all validation will be done in validateProcessGraph()\r\n\t\t\t\tdelete schema.required;\r\n\t\t\t\tdelete schema.properties;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tschema = this.makeSchema(schema, true);\r\n\t\t}\r\n\r\n\t\t// Remove subtype to avoid recursion\r\n\t\tdelete schema.subtype;\r\n\r\n\t\tlet validated = await this.ajv.validate(schema, data);\r\n\t\tlet funcName = this.getFunctionName(subtype);\r\n\t\tif (validated && typeof this[funcName] === 'function') {\r\n\t\t\treturn await this[funcName](data);\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn validated;\r\n\t\t}\r\n\t}\r\n\r\n\tsetUdfRuntimes(udfRuntimes) {\r\n\t\tif (!Utils.isObject(udfRuntimes)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.udfRuntimes = udfRuntimes;\r\n\t}\r\n\r\n\tsetCollections(collections) {\r\n\t\tif (!Array.isArray(collections)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.collections = [];\r\n\t\tfor(let c of collections) {\r\n\t\t\tif (Utils.isObject(c) && typeof c.id === 'string') {\r\n\t\t\t\tthis.collections.push(c.id);\r\n\t\t\t}\r\n\t\t\telse if (typeof c === 'string') {\r\n\t\t\t\tthis.collections.push(c);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Expects API compatible file formats (see GET /file_formats).\r\n\tsetFileFormats(fileFormats) {\r\n\t\tif (!Utils.isObject(fileFormats)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor(let io of ['input', 'output']) {\r\n\t\t\tthis.fileFormats[io] = {};\r\n\t\t\tif (!Utils.isObject(fileFormats[io])) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tfor (let key in fileFormats[io]) {\r\n\t\t\t\tthis.fileFormats[io][key.toUpperCase()] = fileFormats[io][key];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tsetEpsgCodes(epsgCodes) {\r\n\t\tif (Array.isArray(epsgCodes)) {\r\n\t\t\tthis.epsgCodes = epsgCodes.map(v => parseInt(v, 10));\r\n\t\t}\r\n\t}\r\n\r\n\tasync validateCollectionId(data) {\r\n\t\tif (Array.isArray(this.collections) && !this.collections.find(c => c === data)) {\r\n\t\t\tthrow new Ajv.ValidationError([{\r\n\t\t\t\tmessage: \"Collection with id '\" + data + \"' doesn't exist.\"\r\n\t\t\t}]);\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tasync validateUdfRuntime(data) {\r\n\t\tif (Utils.isObject(this.udfRuntimes) && !(data in this.udfRuntimes)) {\r\n\t\t\tthrow new Ajv.ValidationError([{\r\n\t\t\t\tmessage: \"UDF runtime '\" + data + \"' is not supported.\"\r\n\t\t\t}]);\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tasync validateEpsgCode(data) {\r\n\t\tif (Array.isArray(this.epsgCodes)) {\r\n\t\t\tif (this.epsgCodes.includes(data)) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Rough check for valid numbers as we don't want to maintain a full epsg code list in this repo.\r\n\t\telse if (data >= 2000) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tthrow new Ajv.ValidationError([{\r\n\t\t\tmessage: \"Invalid EPSG code '\" + data + \"' specified.\"\r\n\t\t}]);\r\n\t}\r\n\t\r\n\tasync validateInputFormat(data) {\r\n\t\tif (Utils.isObject(this.fileFormats.input) && !(data.toUpperCase() in this.fileFormats.input)) {\r\n\t\t\tthrow new Ajv.ValidationError([{\r\n\t\t\t\tmessage: \"Input format  '\" + data + \"' not supported.\"\r\n\t\t\t}]);\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\t\r\n\tasync validateOutputFormat(data) {\r\n\t\tif (Utils.isObject(this.fileFormats.output) && !(data.toUpperCase() in this.fileFormats.output)) {\r\n\t\t\tthrow new Ajv.ValidationError([{\r\n\t\t\t\tmessage: \"Output format  '\" + data + \"' not supported.\"\r\n\t\t\t}]);\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tasync validateProjDefinition(data) {\r\n\t\t// To be overridden by end-user application, just doing a very basic check here.\r\n\t\tif (!data.toLowerCase().includes(\"+proj\")) {\r\n\t\t\tthrow new Ajv.ValidationError([{\r\n\t\t\t\tmessage: \"Invalid PROJ string specified (doesn't contain '+proj').\"\r\n\t\t\t}]);\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tasync validateWkt2Definition(data) {\r\n\t\t// To be overridden by end-user application, just doing a very basic check here based on code ported over from proj4js\r\n\t\tvar codeWords = [\r\n\t\t\t'BOUNDCRS',\r\n\t\t\t'COMPOUNDCRS',\r\n\t\t\t'ENGCRS', 'ENGINEERINGCRS',\r\n\t\t\t'GEODCRS', 'GEODETICCRS',\r\n\t\t\t'GEOGCRS', 'GEOGRAPHICCRS',\r\n\t\t\t'PARAMETRICCRS',\r\n\t\t\t'PROJCRS', 'PROJECTEDCRS',\r\n\t\t\t'TIMECRS',\r\n\t\t\t'VERTCRS', 'VERTICALCRS'\r\n\t\t];\r\n\t\tdata = data.toUpperCase();\r\n\t\tif (!codeWords.some(word => data.indexOf(word) !== -1)) {\r\n\t\t\tthrow new Ajv.ValidationError([{\r\n\t\t\t\tmessage: \"Invalid WKT2 string specified.\"\r\n\t\t\t}]);\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tasync validateTemporalInterval(data) {\r\n\t\tif (data[0] === null && data[1] === null) {\r\n\t\t\tthrow new Ajv.ValidationError([{\r\n\t\t\t\tmessage: \"Temporal interval must not be open on both ends.\"\r\n\t\t\t}]);\r\n\t\t}\r\n\t\telse if (data[0] !== null && data[1] !== null) {\r\n\t\t\tlet date1 = new Date(data[0]);\r\n\t\t\tlet date2 = new Date(data[1]);\r\n\t\t\tif (date2.getTime() < date1.getTime()) {\r\n\t\t\t\tthrow new Ajv.ValidationError([{\r\n\t\t\t\t\tmessage: \"The second timestamp can't be before the first timestamp.\"\r\n\t\t\t\t}]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\t\r\n\tasync validateTemporalIntervals(data) {\r\n\t\tfor(let interval of data) {\r\n\t\t\t// throws if invalid\r\n\t\t\tawait this.validateTemporalInterval(interval);\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tsetProcessGraphParser(processGraph) {\r\n\t\tthis.processGraph = processGraph;\r\n\t}\r\n\r\n\tasync validateProcessGraph(data) {\r\n\t\ttry {\r\n\t\t\tconst ProcessGraph = require('./processgraph');\r\n\t\t\tvar parser;\r\n\t\t\tif (data instanceof ProcessGraph) {\r\n\t\t\t\tparser = data;\r\n\t\t\t}\r\n\t\t\telse if (this.processGraph) {\r\n\t\t\t\tparser = this.processGraph.createProcessGraphInstance(data);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tparser = new ProcessGraph(data, null, this);\r\n\t\t\t}\r\n\t\t\tawait parser.validate();\r\n\t\t\treturn true;\r\n\t\t} catch (error) {\r\n\t\t\tthrow new Ajv.ValidationError([{\r\n\t\t\t\tmessage: error.message\r\n\t\t\t}]);\r\n\t\t}\r\n\t}\r\n\r\n\t// Checks whether the valueSchema is compatible to the paramSchema.\r\n\t// So would a value compatible with valueSchema be accepted by paramSchema?\r\n\t// allowValueAsElements: If true, it checks whether the valueSchema would be allowed as part of an array or object. For example number could be allowed as part of an array of numbers.\r\n\tstatic isSchemaCompatible(paramSchema, valueSchema, strict = false, allowValueAsElements = false) {\r\n\t\tvar paramSchemas = ProcessUtils.normalizeJsonSchema(paramSchema, true);\r\n\t\tvar valueSchemas = ProcessUtils.normalizeJsonSchema(valueSchema, true);\r\n\r\n\t\tvar compatible = paramSchemas.findIndex(ps => {\r\n\t\t\tfor(var i in valueSchemas) {\r\n\t\t\t\tvar vs = valueSchemas[i];\r\n\t\t\t\tif (typeof ps.type !== 'string' || (!strict && typeof vs.type !== 'string')) { // \"any\" type is always compatible\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\telse if (ps.type === vs.type || (allowValueAsElements && (ps.type === 'array' || ps.type === 'object')) || (ps.type === 'number' && vs.type === 'integer') || (!strict && ps.type === 'integer' && vs.type === 'number')) {\r\n\t\t\t\t\tif (ps.type === 'array' && Utils.isObject(ps.items) && Utils.isObject(vs.items))  {\r\n\t\t\t\t\t\tif (allowValueAsElements && JsonSchemaValidator.isSchemaCompatible(ps.items, vs, strict)) {\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (JsonSchemaValidator.isSchemaCompatible(ps.items, vs.items, strict)) {\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (ps.type === 'object' && Utils.isObject(ps.properties) && Utils.isObject(vs.properties)) {\r\n\t\t\t\t\t\t// ToDo: Check properties, required properties etc.\r\n\t\t\t\t\t\t// If allowValueAsElements is true, all types are allowed to be part of the object.\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Check subtypes\r\n\t\t\t\t\telse if (!strict && (typeof ps.subtype !== 'string' || typeof vs.subtype !== 'string')) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (typeof ps.subtype !== 'string') { // types without subtype always accepts the same type with a subtype\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (ps.subtype === vs.subtype) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\t\treturn compatible !== -1;\r\n\t}\r\n\r\n}\r\n\r\nmodule.exports = JsonSchemaValidator;","'use strict';\n\n\nmodule.exports = {\n  copy: copy,\n  checkDataType: checkDataType,\n  checkDataTypes: checkDataTypes,\n  coerceToTypes: coerceToTypes,\n  toHash: toHash,\n  getProperty: getProperty,\n  escapeQuotes: escapeQuotes,\n  equal: require('fast-deep-equal'),\n  ucs2length: require('./ucs2length'),\n  varOccurences: varOccurences,\n  varReplace: varReplace,\n  schemaHasRules: schemaHasRules,\n  schemaHasRulesExcept: schemaHasRulesExcept,\n  schemaUnknownRules: schemaUnknownRules,\n  toQuotedString: toQuotedString,\n  getPathExpr: getPathExpr,\n  getPath: getPath,\n  getData: getData,\n  unescapeFragment: unescapeFragment,\n  unescapeJsonPointer: unescapeJsonPointer,\n  escapeFragment: escapeFragment,\n  escapeJsonPointer: escapeJsonPointer\n};\n\n\nfunction copy(o, to) {\n  to = to || {};\n  for (var key in o) to[key] = o[key];\n  return to;\n}\n\n\nfunction checkDataType(dataType, data, strictNumbers, negate) {\n  var EQUAL = negate ? ' !== ' : ' === '\n    , AND = negate ? ' || ' : ' && '\n    , OK = negate ? '!' : ''\n    , NOT = negate ? '' : '!';\n  switch (dataType) {\n    case 'null': return data + EQUAL + 'null';\n    case 'array': return OK + 'Array.isArray(' + data + ')';\n    case 'object': return '(' + OK + data + AND +\n                          'typeof ' + data + EQUAL + '\"object\"' + AND +\n                          NOT + 'Array.isArray(' + data + '))';\n    case 'integer': return '(typeof ' + data + EQUAL + '\"number\"' + AND +\n                           NOT + '(' + data + ' % 1)' +\n                           AND + data + EQUAL + data +\n                           (strictNumbers ? (AND + OK + 'isFinite(' + data + ')') : '') + ')';\n    case 'number': return '(typeof ' + data + EQUAL + '\"' + dataType + '\"' +\n                          (strictNumbers ? (AND + OK + 'isFinite(' + data + ')') : '') + ')';\n    default: return 'typeof ' + data + EQUAL + '\"' + dataType + '\"';\n  }\n}\n\n\nfunction checkDataTypes(dataTypes, data, strictNumbers) {\n  switch (dataTypes.length) {\n    case 1: return checkDataType(dataTypes[0], data, strictNumbers, true);\n    default:\n      var code = '';\n      var types = toHash(dataTypes);\n      if (types.array && types.object) {\n        code = types.null ? '(': '(!' + data + ' || ';\n        code += 'typeof ' + data + ' !== \"object\")';\n        delete types.null;\n        delete types.array;\n        delete types.object;\n      }\n      if (types.number) delete types.integer;\n      for (var t in types)\n        code += (code ? ' && ' : '' ) + checkDataType(t, data, strictNumbers, true);\n\n      return code;\n  }\n}\n\n\nvar COERCE_TO_TYPES = toHash([ 'string', 'number', 'integer', 'boolean', 'null' ]);\nfunction coerceToTypes(optionCoerceTypes, dataTypes) {\n  if (Array.isArray(dataTypes)) {\n    var types = [];\n    for (var i=0; i<dataTypes.length; i++) {\n      var t = dataTypes[i];\n      if (COERCE_TO_TYPES[t]) types[types.length] = t;\n      else if (optionCoerceTypes === 'array' && t === 'array') types[types.length] = t;\n    }\n    if (types.length) return types;\n  } else if (COERCE_TO_TYPES[dataTypes]) {\n    return [dataTypes];\n  } else if (optionCoerceTypes === 'array' && dataTypes === 'array') {\n    return ['array'];\n  }\n}\n\n\nfunction toHash(arr) {\n  var hash = {};\n  for (var i=0; i<arr.length; i++) hash[arr[i]] = true;\n  return hash;\n}\n\n\nvar IDENTIFIER = /^[a-z$_][a-z$_0-9]*$/i;\nvar SINGLE_QUOTE = /'|\\\\/g;\nfunction getProperty(key) {\n  return typeof key == 'number'\n          ? '[' + key + ']'\n          : IDENTIFIER.test(key)\n            ? '.' + key\n            : \"['\" + escapeQuotes(key) + \"']\";\n}\n\n\nfunction escapeQuotes(str) {\n  return str.replace(SINGLE_QUOTE, '\\\\$&')\n            .replace(/\\n/g, '\\\\n')\n            .replace(/\\r/g, '\\\\r')\n            .replace(/\\f/g, '\\\\f')\n            .replace(/\\t/g, '\\\\t');\n}\n\n\nfunction varOccurences(str, dataVar) {\n  dataVar += '[^0-9]';\n  var matches = str.match(new RegExp(dataVar, 'g'));\n  return matches ? matches.length : 0;\n}\n\n\nfunction varReplace(str, dataVar, expr) {\n  dataVar += '([^0-9])';\n  expr = expr.replace(/\\$/g, '$$$$');\n  return str.replace(new RegExp(dataVar, 'g'), expr + '$1');\n}\n\n\nfunction schemaHasRules(schema, rules) {\n  if (typeof schema == 'boolean') return !schema;\n  for (var key in schema) if (rules[key]) return true;\n}\n\n\nfunction schemaHasRulesExcept(schema, rules, exceptKeyword) {\n  if (typeof schema == 'boolean') return !schema && exceptKeyword != 'not';\n  for (var key in schema) if (key != exceptKeyword && rules[key]) return true;\n}\n\n\nfunction schemaUnknownRules(schema, rules) {\n  if (typeof schema == 'boolean') return;\n  for (var key in schema) if (!rules[key]) return key;\n}\n\n\nfunction toQuotedString(str) {\n  return '\\'' + escapeQuotes(str) + '\\'';\n}\n\n\nfunction getPathExpr(currentPath, expr, jsonPointers, isNumber) {\n  var path = jsonPointers // false by default\n              ? '\\'/\\' + ' + expr + (isNumber ? '' : '.replace(/~/g, \\'~0\\').replace(/\\\\//g, \\'~1\\')')\n              : (isNumber ? '\\'[\\' + ' + expr + ' + \\']\\'' : '\\'[\\\\\\'\\' + ' + expr + ' + \\'\\\\\\']\\'');\n  return joinPaths(currentPath, path);\n}\n\n\nfunction getPath(currentPath, prop, jsonPointers) {\n  var path = jsonPointers // false by default\n              ? toQuotedString('/' + escapeJsonPointer(prop))\n              : toQuotedString(getProperty(prop));\n  return joinPaths(currentPath, path);\n}\n\n\nvar JSON_POINTER = /^\\/(?:[^~]|~0|~1)*$/;\nvar RELATIVE_JSON_POINTER = /^([0-9]+)(#|\\/(?:[^~]|~0|~1)*)?$/;\nfunction getData($data, lvl, paths) {\n  var up, jsonPointer, data, matches;\n  if ($data === '') return 'rootData';\n  if ($data[0] == '/') {\n    if (!JSON_POINTER.test($data)) throw new Error('Invalid JSON-pointer: ' + $data);\n    jsonPointer = $data;\n    data = 'rootData';\n  } else {\n    matches = $data.match(RELATIVE_JSON_POINTER);\n    if (!matches) throw new Error('Invalid JSON-pointer: ' + $data);\n    up = +matches[1];\n    jsonPointer = matches[2];\n    if (jsonPointer == '#') {\n      if (up >= lvl) throw new Error('Cannot access property/index ' + up + ' levels up, current level is ' + lvl);\n      return paths[lvl - up];\n    }\n\n    if (up > lvl) throw new Error('Cannot access data ' + up + ' levels up, current level is ' + lvl);\n    data = 'data' + ((lvl - up) || '');\n    if (!jsonPointer) return data;\n  }\n\n  var expr = data;\n  var segments = jsonPointer.split('/');\n  for (var i=0; i<segments.length; i++) {\n    var segment = segments[i];\n    if (segment) {\n      data += getProperty(unescapeJsonPointer(segment));\n      expr += ' && ' + data;\n    }\n  }\n  return expr;\n}\n\n\nfunction joinPaths (a, b) {\n  if (a == '\"\"') return b;\n  return (a + ' + ' + b).replace(/([^\\\\])' \\+ '/g, '$1');\n}\n\n\nfunction unescapeFragment(str) {\n  return unescapeJsonPointer(decodeURIComponent(str));\n}\n\n\nfunction escapeFragment(str) {\n  return encodeURIComponent(escapeJsonPointer(str));\n}\n\n\nfunction escapeJsonPointer(str) {\n  return str.replace(/~/g, '~0').replace(/\\//g, '~1');\n}\n\n\nfunction unescapeJsonPointer(str) {\n  return str.replace(/~1/g, '/').replace(/~0/g, '~');\n}\n","'use strict';\n\nvar IDENTIFIER = /^[a-z_$][a-z0-9_$-]*$/i;\nvar customRuleCode = require('./dotjs/custom');\nvar definitionSchema = require('./definition_schema');\n\nmodule.exports = {\n  add: addKeyword,\n  get: getKeyword,\n  remove: removeKeyword,\n  validate: validateKeyword\n};\n\n\n/**\n * Define custom keyword\n * @this  Ajv\n * @param {String} keyword custom keyword, should be unique (including different from all standard, custom and macro keywords).\n * @param {Object} definition keyword definition object with properties `type` (type(s) which the keyword applies to), `validate` or `compile`.\n * @return {Ajv} this for method chaining\n */\nfunction addKeyword(keyword, definition) {\n  /* jshint validthis: true */\n  /* eslint no-shadow: 0 */\n  var RULES = this.RULES;\n  if (RULES.keywords[keyword])\n    throw new Error('Keyword ' + keyword + ' is already defined');\n\n  if (!IDENTIFIER.test(keyword))\n    throw new Error('Keyword ' + keyword + ' is not a valid identifier');\n\n  if (definition) {\n    this.validateKeyword(definition, true);\n\n    var dataType = definition.type;\n    if (Array.isArray(dataType)) {\n      for (var i=0; i<dataType.length; i++)\n        _addRule(keyword, dataType[i], definition);\n    } else {\n      _addRule(keyword, dataType, definition);\n    }\n\n    var metaSchema = definition.metaSchema;\n    if (metaSchema) {\n      if (definition.$data && this._opts.$data) {\n        metaSchema = {\n          anyOf: [\n            metaSchema,\n            { '$ref': 'https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#' }\n          ]\n        };\n      }\n      definition.validateSchema = this.compile(metaSchema, true);\n    }\n  }\n\n  RULES.keywords[keyword] = RULES.all[keyword] = true;\n\n\n  function _addRule(keyword, dataType, definition) {\n    var ruleGroup;\n    for (var i=0; i<RULES.length; i++) {\n      var rg = RULES[i];\n      if (rg.type == dataType) {\n        ruleGroup = rg;\n        break;\n      }\n    }\n\n    if (!ruleGroup) {\n      ruleGroup = { type: dataType, rules: [] };\n      RULES.push(ruleGroup);\n    }\n\n    var rule = {\n      keyword: keyword,\n      definition: definition,\n      custom: true,\n      code: customRuleCode,\n      implements: definition.implements\n    };\n    ruleGroup.rules.push(rule);\n    RULES.custom[keyword] = rule;\n  }\n\n  return this;\n}\n\n\n/**\n * Get keyword\n * @this  Ajv\n * @param {String} keyword pre-defined or custom keyword.\n * @return {Object|Boolean} custom keyword definition, `true` if it is a predefined keyword, `false` otherwise.\n */\nfunction getKeyword(keyword) {\n  /* jshint validthis: true */\n  var rule = this.RULES.custom[keyword];\n  return rule ? rule.definition : this.RULES.keywords[keyword] || false;\n}\n\n\n/**\n * Remove keyword\n * @this  Ajv\n * @param {String} keyword pre-defined or custom keyword.\n * @return {Ajv} this for method chaining\n */\nfunction removeKeyword(keyword) {\n  /* jshint validthis: true */\n  var RULES = this.RULES;\n  delete RULES.keywords[keyword];\n  delete RULES.all[keyword];\n  delete RULES.custom[keyword];\n  for (var i=0; i<RULES.length; i++) {\n    var rules = RULES[i].rules;\n    for (var j=0; j<rules.length; j++) {\n      if (rules[j].keyword == keyword) {\n        rules.splice(j, 1);\n        break;\n      }\n    }\n  }\n  return this;\n}\n\n\n/**\n * Validate keyword definition\n * @this  Ajv\n * @param {Object} definition keyword definition object.\n * @param {Boolean} throwError true to throw exception if definition is invalid\n * @return {boolean} validation result\n */\nfunction validateKeyword(definition, throwError) {\n  validateKeyword.errors = null;\n  var v = this._validateKeyword = this._validateKeyword\n                                  || this.compile(definitionSchema, true);\n\n  if (v(definition)) return true;\n  validateKeyword.errors = v.errors;\n  if (throwError)\n    throw new Error('custom keyword definition is invalid: '  + this.errorsText(v.errors));\n  else\n    return false;\n}\n"],"sourceRoot":""}